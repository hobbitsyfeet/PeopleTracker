<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Peopletracker: room_estimation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="person.png"/></td>
  <td id="projectalign">
   <div id="projectname">Peopletracker<span id="projectnumber">&#160;2.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('a00206.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="a00203.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">room_estimation</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5fe35e96c37a5189461dc200d9860d4b" id="r_a5fe35e96c37a5189461dc200d9860d4b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a5fe35e96c37a5189461dc200d9860d4b">__init__</a> (self, image=None, camera_matrix=JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_MTX, distortion_matrix=JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_DIST, rvecs=JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_RVEC)</td></tr>
<tr class="separator:a5fe35e96c37a5189461dc200d9860d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da847c11e206bbccbe29ec5e042462a" id="r_a5da847c11e206bbccbe29ec5e042462a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a5da847c11e206bbccbe29ec5e042462a">set_image</a> (self, image)</td></tr>
<tr class="separator:a5da847c11e206bbccbe29ec5e042462a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61a9f1d7c10c86838c5928c76bb2ca59" id="r_a61a9f1d7c10c86838c5928c76bb2ca59"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a61a9f1d7c10c86838c5928c76bb2ca59">display_room</a> (self, image=None, axis=True, box=True, show_3d_plot=True, with_points=False)</td></tr>
<tr class="separator:a61a9f1d7c10c86838c5928c76bb2ca59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a833c6efe94bd835b3ab82191c47f04fe" id="r_a833c6efe94bd835b3ab82191c47f04fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a833c6efe94bd835b3ab82191c47f04fe">set_axis</a> (self, x, y, z)</td></tr>
<tr class="separator:a833c6efe94bd835b3ab82191c47f04fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa65bf2973032f8d2e0e33872634b06" id="r_acfa65bf2973032f8d2e0e33872634b06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#acfa65bf2973032f8d2e0e33872634b06">set_corners</a> (self, p1=None, p2=None, p3=None, p4=None)</td></tr>
<tr class="separator:acfa65bf2973032f8d2e0e33872634b06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af380d3a1fe6a68080691e578d25937b1" id="r_af380d3a1fe6a68080691e578d25937b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#af380d3a1fe6a68080691e578d25937b1">img_copy</a> (self)</td></tr>
<tr class="separator:af380d3a1fe6a68080691e578d25937b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5abc31dfc859a8bd979479f51da933" id="r_a5b5abc31dfc859a8bd979479f51da933"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a5b5abc31dfc859a8bd979479f51da933">define_sides</a> (self, sides, lengths)</td></tr>
<tr class="separator:a5b5abc31dfc859a8bd979479f51da933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84fbd0580af51d4905aeeb1b71889390" id="r_a84fbd0580af51d4905aeeb1b71889390"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a84fbd0580af51d4905aeeb1b71889390">define_room</a> (self, width=None, length=None, height=None, offset=[0, 0, 0, 0], corners=None, room_points=None, refine_corners=False, image=None, stitch_videos=None, calibration=None, extend=None)</td></tr>
<tr class="separator:a84fbd0580af51d4905aeeb1b71889390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0188ed983122bc7494460062c8ca22b" id="r_ab0188ed983122bc7494460062c8ca22b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ab0188ed983122bc7494460062c8ca22b">clear_corners</a> (self)</td></tr>
<tr class="separator:ab0188ed983122bc7494460062c8ca22b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc866ee6a78b68a77485eb1eb0f00ba" id="r_a1cc866ee6a78b68a77485eb1eb0f00ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a1cc866ee6a78b68a77485eb1eb0f00ba">get_room_corners</a> (self, num_points=4)</td></tr>
<tr class="separator:a1cc866ee6a78b68a77485eb1eb0f00ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e02ad6d52be2fc94cd6f1663ecac18d" id="r_a5e02ad6d52be2fc94cd6f1663ecac18d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a5e02ad6d52be2fc94cd6f1663ecac18d">edit_room_corner</a> (self, index, new_pixel)</td></tr>
<tr class="separator:a5e02ad6d52be2fc94cd6f1663ecac18d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2c8ef2eee13d8eb75d88c0559626fac" id="r_ae2c8ef2eee13d8eb75d88c0559626fac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ae2c8ef2eee13d8eb75d88c0559626fac">connect_points</a> (self, points)</td></tr>
<tr class="separator:ae2c8ef2eee13d8eb75d88c0559626fac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7975986cd4d5ecccaadb6a9a0a521e1e" id="r_a7975986cd4d5ecccaadb6a9a0a521e1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a7975986cd4d5ecccaadb6a9a0a521e1e">get_corners</a> (self, event, x, y, flags, param)</td></tr>
<tr class="separator:a7975986cd4d5ecccaadb6a9a0a521e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f01474eaee314a7013feeaa49685bb9" id="r_a5f01474eaee314a7013feeaa49685bb9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a5f01474eaee314a7013feeaa49685bb9">get_corner_with_definition</a> (self, event, x, y, flags, param)</td></tr>
<tr class="separator:a5f01474eaee314a7013feeaa49685bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bcf809e2d6ba963c04b331f5c53a3a8" id="r_a7bcf809e2d6ba963c04b331f5c53a3a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a7bcf809e2d6ba963c04b331f5c53a3a8">get_cube_side</a> (self, cube, side)</td></tr>
<tr class="separator:a7bcf809e2d6ba963c04b331f5c53a3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5c0b06be5dbf308587eac88c486612" id="r_a9d5c0b06be5dbf308587eac88c486612"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a9d5c0b06be5dbf308587eac88c486612">crop_plain</a> (self, points, plain_width, plain_length, image=None)</td></tr>
<tr class="separator:a9d5c0b06be5dbf308587eac88c486612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a671eb2401939cdbb1c91570e58d4f7c3" id="r_a671eb2401939cdbb1c91570e58d4f7c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a671eb2401939cdbb1c91570e58d4f7c3">project_points</a> (self, points=[])</td></tr>
<tr class="separator:a671eb2401939cdbb1c91570e58d4f7c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8bb923e853aeed05b8e25def792f5e4" id="r_ab8bb923e853aeed05b8e25def792f5e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ab8bb923e853aeed05b8e25def792f5e4">plot_points</a> (event, x, y, flags, params)</td></tr>
<tr class="separator:ab8bb923e853aeed05b8e25def792f5e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8277f150767e58ce0824de54928fb184" id="r_a8277f150767e58ce0824de54928fb184"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a8277f150767e58ce0824de54928fb184">get_3d_to_2d</a> (self, point, show=True)</td></tr>
<tr class="separator:a8277f150767e58ce0824de54928fb184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e10ca5ff3f0e459f47e6ccaf82adeb" id="r_a52e10ca5ff3f0e459f47e6ccaf82adeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a52e10ca5ff3f0e459f47e6ccaf82adeb">get_3d_point</a> (self, pixel, height=1500, camera_matrix=None, rotation_matrix=None, tvec=None, show_point=True)</td></tr>
<tr class="separator:a52e10ca5ff3f0e459f47e6ccaf82adeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd30d2c67d090d15947b3abde53e876f" id="r_acd30d2c67d090d15947b3abde53e876f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#acd30d2c67d090d15947b3abde53e876f">display_3D_Plot</a> (points, shown)</td></tr>
<tr class="separator:acd30d2c67d090d15947b3abde53e876f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b52f7921f3d60a3a6b7d2dc641aa44c" id="r_a6b52f7921f3d60a3a6b7d2dc641aa44c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a6b52f7921f3d60a3a6b7d2dc641aa44c">draw_axis</a> (self)</td></tr>
<tr class="separator:a6b52f7921f3d60a3a6b7d2dc641aa44c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4827bfb173a05c4794fb8b29ec8055" id="r_aef4827bfb173a05c4794fb8b29ec8055"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#aef4827bfb173a05c4794fb8b29ec8055">draw_cuboid</a> (self, image=None, distortion=None, rvec=None, tvec=None)</td></tr>
<tr class="separator:aef4827bfb173a05c4794fb8b29ec8055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07baa9eba436c81cea0c49e0d5b5099f" id="r_a07baa9eba436c81cea0c49e0d5b5099f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a07baa9eba436c81cea0c49e0d5b5099f">draw_box</a> (img, corners, imgpts)</td></tr>
<tr class="separator:a07baa9eba436c81cea0c49e0d5b5099f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9efcb6eeef35186ade72c0bbc5c531fe" id="r_a9efcb6eeef35186ade72c0bbc5c531fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a9efcb6eeef35186ade72c0bbc5c531fe">draw_point</a> (self, img, front_pt, back_pt)</td></tr>
<tr class="separator:a9efcb6eeef35186ade72c0bbc5c531fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a557b4ac632e812552cc251f7b57b6a6e" id="r_a557b4ac632e812552cc251f7b57b6a6e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a557b4ac632e812552cc251f7b57b6a6e">estimate_plane</a> (img, corners, points, calibration_matrix, distortion_matrix)</td></tr>
<tr class="separator:a557b4ac632e812552cc251f7b57b6a6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a48d83bb7e61c5a28680a2de16c11c" id="r_a77a48d83bb7e61c5a28680a2de16c11c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a77a48d83bb7e61c5a28680a2de16c11c">draw_vector</a> (self, event, x, y, flags, params)</td></tr>
<tr class="separator:a77a48d83bb7e61c5a28680a2de16c11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68abc4d3a13c1374dfa93018a57b84be" id="r_a68abc4d3a13c1374dfa93018a57b84be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a68abc4d3a13c1374dfa93018a57b84be">get_room_3d</a> (self, limits, height, step, save_filename=None)</td></tr>
<tr class="separator:a68abc4d3a13c1374dfa93018a57b84be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf8ba8f0370d5371ba8c5a28e3e3d587" id="r_acf8ba8f0370d5371ba8c5a28e3e3d587"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#acf8ba8f0370d5371ba8c5a28e3e3d587">save_room_3d</a> (self, path, filename, mapped)</td></tr>
<tr class="separator:acf8ba8f0370d5371ba8c5a28e3e3d587"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66e446204a8676a532acab744601f10" id="r_ae66e446204a8676a532acab744601f10"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ae66e446204a8676a532acab744601f10">load_room_3d</a> (self, filename)</td></tr>
<tr class="separator:ae66e446204a8676a532acab744601f10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62767547824d2f147fc10c5b38f2c725" id="r_a62767547824d2f147fc10c5b38f2c725"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a62767547824d2f147fc10c5b38f2c725">get_room_points</a> (self, width, length, height=0)</td></tr>
<tr class="separator:a62767547824d2f147fc10c5b38f2c725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae29c16a83d737f9e9f2b584ae560ad85" id="r_ae29c16a83d737f9e9f2b584ae560ad85"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ae29c16a83d737f9e9f2b584ae560ad85">get_n_room_points</a> (self, n_locations=None, height=0)</td></tr>
<tr class="separator:ae29c16a83d737f9e9f2b584ae560ad85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a921523998615aa3555a3cb0ca2b36965" id="r_a921523998615aa3555a3cb0ca2b36965"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a921523998615aa3555a3cb0ca2b36965">assign_non_square_corners</a> (self, num_points=inf)</td></tr>
<tr class="separator:a921523998615aa3555a3cb0ca2b36965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f82d1ff05b9a54401f4749899cfedb5" id="r_a9f82d1ff05b9a54401f4749899cfedb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a9f82d1ff05b9a54401f4749899cfedb5">find_3d_limits</a> (self, height=1000)</td></tr>
<tr class="separator:a9f82d1ff05b9a54401f4749899cfedb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4446e4e6d7e24976a0eb63a6d7970209" id="r_a4446e4e6d7e24976a0eb63a6d7970209"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a4446e4e6d7e24976a0eb63a6d7970209">project_point</a> (self, event, x, y, flags, params)</td></tr>
<tr class="separator:a4446e4e6d7e24976a0eb63a6d7970209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8113e0511b9bcb908b6a9aee98cee69b" id="r_a8113e0511b9bcb908b6a9aee98cee69b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a8113e0511b9bcb908b6a9aee98cee69b">get_depth</a> (self, event, x, y, p1, p2)</td></tr>
<tr class="separator:a8113e0511b9bcb908b6a9aee98cee69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b5b618d6f1cc697a5191f0617a9200a" id="r_a3b5b618d6f1cc697a5191f0617a9200a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a3b5b618d6f1cc697a5191f0617a9200a">estimate</a> (self)</td></tr>
<tr class="separator:a3b5b618d6f1cc697a5191f0617a9200a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0246e47740851d72979f6d5cdc76bf18" id="r_a0246e47740851d72979f6d5cdc76bf18"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a0246e47740851d72979f6d5cdc76bf18">get_pixel_location</a> (self, pixel)</td></tr>
<tr class="separator:a0246e47740851d72979f6d5cdc76bf18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ddc57e65b6b90133dae37504451b764" id="r_a9ddc57e65b6b90133dae37504451b764"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a9ddc57e65b6b90133dae37504451b764">poly_fit_wall</a> (self, samples, pixels_past_extent=100, horizontal_extent=None, degree=2)</td></tr>
<tr class="separator:a9ddc57e65b6b90133dae37504451b764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54166ae0c7b7f8e5aadcc81eda56ce58" id="r_a54166ae0c7b7f8e5aadcc81eda56ce58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a54166ae0c7b7f8e5aadcc81eda56ce58">find_intersection</a> (self, line_equation1, line_equation2)</td></tr>
<tr class="separator:a54166ae0c7b7f8e5aadcc81eda56ce58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54ccab8062e8ce67319dcd81d75b6d4a" id="r_a54ccab8062e8ce67319dcd81d75b6d4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a54ccab8062e8ce67319dcd81d75b6d4a">make_interpolater</a> (left_min, left_max, right_min, right_max)</td></tr>
<tr class="separator:a54ccab8062e8ce67319dcd81d75b6d4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeac4cbae89aef891cee148cbbbc6232" id="r_abeac4cbae89aef891cee148cbbbc6232"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#abeac4cbae89aef891cee148cbbbc6232">superimpose_checker</a> (self, size=21)</td></tr>
<tr class="separator:abeac4cbae89aef891cee148cbbbc6232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4a382139afef48e3b930752120b4c35" id="r_ae4a382139afef48e3b930752120b4c35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ae4a382139afef48e3b930752120b4c35">define_perspective_grid</a> (self, division=10, extend=500)</td></tr>
<tr class="separator:ae4a382139afef48e3b930752120b4c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69d43ebb2e1d46a4e6313f41860c4fb" id="r_af69d43ebb2e1d46a4e6313f41860c4fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#af69d43ebb2e1d46a4e6313f41860c4fb">find_wall_intersection</a> (self, number_of_walls=2, samples_per_wall=4, extent=10000, intersection_pairs=[], degree=1)</td></tr>
<tr class="separator:af69d43ebb2e1d46a4e6313f41860c4fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c5233bfe740d0250450332850fcad71" id="r_a7c5233bfe740d0250450332850fcad71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a7c5233bfe740d0250450332850fcad71">get_checkerboard_shape</a> (self, checkerboard_images)</td></tr>
<tr class="separator:a7c5233bfe740d0250450332850fcad71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0686ad347e6e14189cd0035e2ea7bd54" id="r_a0686ad347e6e14189cd0035e2ea7bd54"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a0686ad347e6e14189cd0035e2ea7bd54">fisheye_calibrate</a> (self, checkerboard_images, checkerboard_grid=None, out=None)</td></tr>
<tr class="separator:a0686ad347e6e14189cd0035e2ea7bd54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a770916344506672f541f976b5048555f" id="r_a770916344506672f541f976b5048555f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a770916344506672f541f976b5048555f">checkerboard_calibrate</a> (self, checkerboard_images, checkerboard_grid=None, out=None)</td></tr>
<tr class="separator:a770916344506672f541f976b5048555f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36b88c1816fb4bd3fef0f9967aa3527" id="r_ae36b88c1816fb4bd3fef0f9967aa3527"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ae36b88c1816fb4bd3fef0f9967aa3527">save_calibration</a> (self, file, mtx, distortion, rvecs, tvecs, error_list, resolution)</td></tr>
<tr class="separator:ae36b88c1816fb4bd3fef0f9967aa3527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14966b15146b30927e515a9b3c64328d" id="r_a14966b15146b30927e515a9b3c64328d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a14966b15146b30927e515a9b3c64328d">load_calibration</a> (self, file)</td></tr>
<tr class="separator:a14966b15146b30927e515a9b3c64328d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a048722841bc8d71bae4a1e4a9eb9db00" id="r_a048722841bc8d71bae4a1e4a9eb9db00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a048722841bc8d71bae4a1e4a9eb9db00">collect_frames</a> (self, video_source, start_frame=1, skip=15, total_frames=None)</td></tr>
<tr class="separator:a048722841bc8d71bae4a1e4a9eb9db00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f4b9a9b0ee17c82d3731e05dba3109" id="r_ad5f4b9a9b0ee17c82d3731e05dba3109"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ad5f4b9a9b0ee17c82d3731e05dba3109">get_calibration_ratio</a> (self, video_resolution, calibration_resolution)</td></tr>
<tr class="separator:ad5f4b9a9b0ee17c82d3731e05dba3109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd979a29c40c64a598514d7d165bb4a9" id="r_abd979a29c40c64a598514d7d165bb4a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#abd979a29c40c64a598514d7d165bb4a9">undistort_room</a> (self, image=None, points_data=None, camera_matrix=None, distortion=None, show=False, fisheye=False, calibration_resolution=None)</td></tr>
<tr class="separator:abd979a29c40c64a598514d7d165bb4a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66fa5cbb4e0e7ce0bfa08b4b5e14482f" id="r_a66fa5cbb4e0e7ce0bfa08b4b5e14482f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a66fa5cbb4e0e7ce0bfa08b4b5e14482f">undistort_tracker_data</a> (self, data, image=None, camera_matrix=None, distortion=None)</td></tr>
<tr class="separator:a66fa5cbb4e0e7ce0bfa08b4b5e14482f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444510358faa06884318d1ebe94846ff" id="r_a444510358faa06884318d1ebe94846ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a444510358faa06884318d1ebe94846ff">load_tracker</a> (self, csv_file)</td></tr>
<tr class="separator:a444510358faa06884318d1ebe94846ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab870abde92556016846a09d5feb9e03c" id="r_ab870abde92556016846a09d5feb9e03c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ab870abde92556016846a09d5feb9e03c">correct_tracker_points</a> (self, df)</td></tr>
<tr class="separator:ab870abde92556016846a09d5feb9e03c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd7f71bd75e917a01563ad8dce62565" id="r_a0bd7f71bd75e917a01563ad8dce62565"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a0bd7f71bd75e917a01563ad8dce62565">update_tracker_3D</a> (self, index, df, mapped_min, mapped_max)</td></tr>
<tr class="separator:a0bd7f71bd75e917a01563ad8dce62565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab099905032ea6fd2a2e17e2414e58872" id="r_ab099905032ea6fd2a2e17e2414e58872"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ab099905032ea6fd2a2e17e2414e58872">show_tracker_3D</a> (self, df, mapped_min, mapped_max)</td></tr>
<tr class="separator:ab099905032ea6fd2a2e17e2414e58872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a327e18a9cf669bab61d714980d73b0" id="r_a0a327e18a9cf669bab61d714980d73b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a0a327e18a9cf669bab61d714980d73b0">show_tracker_2D</a> (self, df, image, data_columns=['Pixel_Loc_x', 'Pixel_Loc_y'], window=&quot;Tracker2D&quot;, colour=(255, 255, 0))</td></tr>
<tr class="separator:a0a327e18a9cf669bab61d714980d73b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e21d867efbc8b743664f8b6f41d1b8e" id="r_a2e21d867efbc8b743664f8b6f41d1b8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a2e21d867efbc8b743664f8b6f41d1b8e">extend_image_to_corners</a> (self, image, corners)</td></tr>
<tr class="separator:a2e21d867efbc8b743664f8b6f41d1b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab76a3fa2901de336d5a1a3e1b707604" id="r_aab76a3fa2901de336d5a1a3e1b707604"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#aab76a3fa2901de336d5a1a3e1b707604">get_room_dimensions</a> (self, room_points)</td></tr>
<tr class="separator:aab76a3fa2901de336d5a1a3e1b707604"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1eaebbb5317d01c6bbd133cf98a4d30" id="r_ad1eaebbb5317d01c6bbd133cf98a4d30"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ad1eaebbb5317d01c6bbd133cf98a4d30">evaluate_calibration</a> (self)</td></tr>
<tr class="separator:ad1eaebbb5317d01c6bbd133cf98a4d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6c06bc8bbf8a0f9f7237a97ff9487e" id="r_a6c6c06bc8bbf8a0f9f7237a97ff9487e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a6c6c06bc8bbf8a0f9f7237a97ff9487e">visualize_distortion</a> (self, camera_matrix, distiortion, image=None)</td></tr>
<tr class="separator:a6c6c06bc8bbf8a0f9f7237a97ff9487e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a5df656a4b4d07c05b290f8197c316f" id="r_a2a5df656a4b4d07c05b290f8197c316f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a2a5df656a4b4d07c05b290f8197c316f">save_room</a> (self, filename)</td></tr>
<tr class="separator:a2a5df656a4b4d07c05b290f8197c316f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fea1337eef39488e7f6b170151cf628" id="r_a7fea1337eef39488e7f6b170151cf628"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a7fea1337eef39488e7f6b170151cf628">load_room</a> (self, filename)</td></tr>
<tr class="separator:a7fea1337eef39488e7f6b170151cf628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b7fb08f24516ed753d38cd1eccd73f6" id="r_a3b7fb08f24516ed753d38cd1eccd73f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a3b7fb08f24516ed753d38cd1eccd73f6">load_and_undistort_calibration</a> (self, video_path, <a class="el" href="a00206.html#a6c6c06bc8bbf8a0f9f7237a97ff9487e">visualize_distortion</a>=False, points_data=None)</td></tr>
<tr class="separator:a3b7fb08f24516ed753d38cd1eccd73f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe2f98b84513775c3106191f2845ed3" id="r_adbe2f98b84513775c3106191f2845ed3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#adbe2f98b84513775c3106191f2845ed3">stitch_rooms</a> (self, video_list, undistort=True, key_index=None, show=False)</td></tr>
<tr class="separator:adbe2f98b84513775c3106191f2845ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75031a34aadd8c7847c479a17524e00e" id="r_a75031a34aadd8c7847c479a17524e00e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a75031a34aadd8c7847c479a17524e00e">stitch_trackers</a> (self, video_list, homography_list, use_csv=True, offsets=[0, 0, 0, 0])</td></tr>
<tr class="separator:a75031a34aadd8c7847c479a17524e00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab20e46a19ec3f0b9c7fd04d2264ba8a1" id="r_ab20e46a19ec3f0b9c7fd04d2264ba8a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#ab20e46a19ec3f0b9c7fd04d2264ba8a1">draw_grid</a> (self, grid_shape=(20, 20), color=(255, 255, 255), thickness=2)</td></tr>
<tr class="separator:ab20e46a19ec3f0b9c7fd04d2264ba8a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c3906082600df696b318ba028d67911" id="r_a6c3906082600df696b318ba028d67911"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00206.html#a6c3906082600df696b318ba028d67911">get_files_from_folder</a> (self, folder, extension=&quot;MP4&quot;)</td></tr>
<tr class="separator:a6c3906082600df696b318ba028d67911"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:af1a464766317ca2878de63df2ec7c041" id="r_af1a464766317ca2878de63df2ec7c041"><td class="memItemLeft" align="right" valign="top"><a id="af1a464766317ca2878de63df2ec7c041" name="af1a464766317ca2878de63df2ec7c041"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>window_name</b></td></tr>
<tr class="separator:af1a464766317ca2878de63df2ec7c041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42cb5f5737262947250c709931232c69" id="r_a42cb5f5737262947250c709931232c69"><td class="memItemLeft" align="right" valign="top"><a id="a42cb5f5737262947250c709931232c69" name="a42cb5f5737262947250c709931232c69"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>image</b></td></tr>
<tr class="separator:a42cb5f5737262947250c709931232c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0b8708ab613a74394c90970fd0abd21" id="r_ad0b8708ab613a74394c90970fd0abd21"><td class="memItemLeft" align="right" valign="top"><a id="ad0b8708ab613a74394c90970fd0abd21" name="ad0b8708ab613a74394c90970fd0abd21"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>show_img</b></td></tr>
<tr class="separator:ad0b8708ab613a74394c90970fd0abd21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9d23a302c24f0ec934688542ce94817" id="r_af9d23a302c24f0ec934688542ce94817"><td class="memItemLeft" align="right" valign="top"><a id="af9d23a302c24f0ec934688542ce94817" name="af9d23a302c24f0ec934688542ce94817"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>corners</b></td></tr>
<tr class="separator:af9d23a302c24f0ec934688542ce94817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d200e8176a8ed50871d138d8ac5d61d" id="r_a2d200e8176a8ed50871d138d8ac5d61d"><td class="memItemLeft" align="right" valign="top"><a id="a2d200e8176a8ed50871d138d8ac5d61d" name="a2d200e8176a8ed50871d138d8ac5d61d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>room_points</b></td></tr>
<tr class="separator:a2d200e8176a8ed50871d138d8ac5d61d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c3efb71d455de72ae4236dbcdae0acc" id="r_a4c3efb71d455de72ae4236dbcdae0acc"><td class="memItemLeft" align="right" valign="top"><a id="a4c3efb71d455de72ae4236dbcdae0acc" name="a4c3efb71d455de72ae4236dbcdae0acc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>real_locations</b></td></tr>
<tr class="separator:a4c3efb71d455de72ae4236dbcdae0acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0c10237443ae47f40315a47f947ccfc" id="r_ad0c10237443ae47f40315a47f947ccfc"><td class="memItemLeft" align="right" valign="top"><a id="ad0c10237443ae47f40315a47f947ccfc" name="ad0c10237443ae47f40315a47f947ccfc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>camera_matrix</b></td></tr>
<tr class="separator:ad0c10237443ae47f40315a47f947ccfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8080a08b5711d0ac4df50eed1234b40f" id="r_a8080a08b5711d0ac4df50eed1234b40f"><td class="memItemLeft" align="right" valign="top"><a id="a8080a08b5711d0ac4df50eed1234b40f" name="a8080a08b5711d0ac4df50eed1234b40f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>distioriton_matrix</b></td></tr>
<tr class="separator:a8080a08b5711d0ac4df50eed1234b40f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b0915b42b797dac08c9ca96a548212" id="r_a37b0915b42b797dac08c9ca96a548212"><td class="memItemLeft" align="right" valign="top"><a id="a37b0915b42b797dac08c9ca96a548212" name="a37b0915b42b797dac08c9ca96a548212"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>calibration_errors</b></td></tr>
<tr class="separator:a37b0915b42b797dac08c9ca96a548212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae23222e1130f873ce9799eec51f7ae6" id="r_aae23222e1130f873ce9799eec51f7ae6"><td class="memItemLeft" align="right" valign="top"><a id="aae23222e1130f873ce9799eec51f7ae6" name="aae23222e1130f873ce9799eec51f7ae6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>calibration_resolution</b></td></tr>
<tr class="separator:aae23222e1130f873ce9799eec51f7ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acadb5519abbf736dc420142a91e7f0b5" id="r_acadb5519abbf736dc420142a91e7f0b5"><td class="memItemLeft" align="right" valign="top"><a id="acadb5519abbf736dc420142a91e7f0b5" name="acadb5519abbf736dc420142a91e7f0b5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>rotation_vector</b></td></tr>
<tr class="separator:acadb5519abbf736dc420142a91e7f0b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a770476f7dd2d2628d33edf11f6498479" id="r_a770476f7dd2d2628d33edf11f6498479"><td class="memItemLeft" align="right" valign="top"><a id="a770476f7dd2d2628d33edf11f6498479" name="a770476f7dd2d2628d33edf11f6498479"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>translation_vector</b></td></tr>
<tr class="separator:a770476f7dd2d2628d33edf11f6498479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff94c8cfdec3db9def9b56fb1d0681a4" id="r_aff94c8cfdec3db9def9b56fb1d0681a4"><td class="memItemLeft" align="right" valign="top"><a id="aff94c8cfdec3db9def9b56fb1d0681a4" name="aff94c8cfdec3db9def9b56fb1d0681a4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>room_width</b></td></tr>
<tr class="separator:aff94c8cfdec3db9def9b56fb1d0681a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58cff685b88c5112830f468a43b50b3a" id="r_a58cff685b88c5112830f468a43b50b3a"><td class="memItemLeft" align="right" valign="top"><a id="a58cff685b88c5112830f468a43b50b3a" name="a58cff685b88c5112830f468a43b50b3a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>room_length</b></td></tr>
<tr class="separator:a58cff685b88c5112830f468a43b50b3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac526d1e7e8928a97a3275d1c0bb4fb1e" id="r_ac526d1e7e8928a97a3275d1c0bb4fb1e"><td class="memItemLeft" align="right" valign="top"><a id="ac526d1e7e8928a97a3275d1c0bb4fb1e" name="ac526d1e7e8928a97a3275d1c0bb4fb1e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>room_height</b></td></tr>
<tr class="separator:ac526d1e7e8928a97a3275d1c0bb4fb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9feef5270e0e54f103868362df0cd27a" id="r_a9feef5270e0e54f103868362df0cd27a"><td class="memItemLeft" align="right" valign="top"><a id="a9feef5270e0e54f103868362df0cd27a" name="a9feef5270e0e54f103868362df0cd27a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>sample_rate</b></td></tr>
<tr class="separator:a9feef5270e0e54f103868362df0cd27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a792f6008e56b261c4df28ceaf113d908" id="r_a792f6008e56b261c4df28ceaf113d908"><td class="memItemLeft" align="right" valign="top"><a id="a792f6008e56b261c4df28ceaf113d908" name="a792f6008e56b261c4df28ceaf113d908"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>mapped_dictionary</b></td></tr>
<tr class="separator:a792f6008e56b261c4df28ceaf113d908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9862ac00cbd1fbcdd68a24d65bac005" id="r_aa9862ac00cbd1fbcdd68a24d65bac005"><td class="memItemLeft" align="right" valign="top"><a id="aa9862ac00cbd1fbcdd68a24d65bac005" name="aa9862ac00cbd1fbcdd68a24d65bac005"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>mapped</b></td></tr>
<tr class="separator:aa9862ac00cbd1fbcdd68a24d65bac005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da155f5c1ba42a71b8fcc1e4d517476" id="r_a2da155f5c1ba42a71b8fcc1e4d517476"><td class="memItemLeft" align="right" valign="top"><a id="a2da155f5c1ba42a71b8fcc1e4d517476" name="a2da155f5c1ba42a71b8fcc1e4d517476"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>points_data</b></td></tr>
<tr class="separator:a2da155f5c1ba42a71b8fcc1e4d517476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97ea70af4f4f5aa1943bc30f1bbdef81" id="r_a97ea70af4f4f5aa1943bc30f1bbdef81"><td class="memItemLeft" align="right" valign="top"><a id="a97ea70af4f4f5aa1943bc30f1bbdef81" name="a97ea70af4f4f5aa1943bc30f1bbdef81"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>vector_depth</b></td></tr>
<tr class="separator:a97ea70af4f4f5aa1943bc30f1bbdef81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc088009d44c521706aa98d6387ee21" id="r_accc088009d44c521706aa98d6387ee21"><td class="memItemLeft" align="right" valign="top"><a id="accc088009d44c521706aa98d6387ee21" name="accc088009d44c521706aa98d6387ee21"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>axis</b></td></tr>
<tr class="separator:accc088009d44c521706aa98d6387ee21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64aa603bc3c6c1587e7c6542452481ac" id="r_a64aa603bc3c6c1587e7c6542452481ac"><td class="memItemLeft" align="right" valign="top"><a id="a64aa603bc3c6c1587e7c6542452481ac" name="a64aa603bc3c6c1587e7c6542452481ac"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>fig</b></td></tr>
<tr class="separator:a64aa603bc3c6c1587e7c6542452481ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a269da524371d8ddf28357afd20e378ef" id="r_a269da524371d8ddf28357afd20e378ef"><td class="memItemLeft" align="right" valign="top"><a id="a269da524371d8ddf28357afd20e378ef" name="a269da524371d8ddf28357afd20e378ef"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>stitch_homographies</b></td></tr>
<tr class="separator:a269da524371d8ddf28357afd20e378ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af375124b5ef04d3b8bb534e9da5a59d0" id="r_af375124b5ef04d3b8bb534e9da5a59d0"><td class="memItemLeft" align="right" valign="top"><a id="af375124b5ef04d3b8bb534e9da5a59d0" name="af375124b5ef04d3b8bb534e9da5a59d0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>show_3D_plot</b></td></tr>
<tr class="separator:af375124b5ef04d3b8bb534e9da5a59d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65225117e6365e16eec0b0fd2e1353e5" id="r_a65225117e6365e16eec0b0fd2e1353e5"><td class="memItemLeft" align="right" valign="top"><a id="a65225117e6365e16eec0b0fd2e1353e5" name="a65225117e6365e16eec0b0fd2e1353e5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_corners</b></td></tr>
<tr class="separator:a65225117e6365e16eec0b0fd2e1353e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa675eb2fcec5b95d9d21c670da7f30" id="r_a8fa675eb2fcec5b95d9d21c670da7f30"><td class="memItemLeft" align="right" valign="top"><a id="a8fa675eb2fcec5b95d9d21c670da7f30" name="a8fa675eb2fcec5b95d9d21c670da7f30"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ax</b></td></tr>
<tr class="separator:a8fa675eb2fcec5b95d9d21c670da7f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dedc2f4868ac1e98c70aa8a14a446ce" id="r_a6dedc2f4868ac1e98c70aa8a14a446ce"><td class="memItemLeft" align="right" valign="top"><a id="a6dedc2f4868ac1e98c70aa8a14a446ce" name="a6dedc2f4868ac1e98c70aa8a14a446ce"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>front_plt</b></td></tr>
<tr class="separator:a6dedc2f4868ac1e98c70aa8a14a446ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6f90e673f1651f1546af9a598f18f2" id="r_a1e6f90e673f1651f1546af9a598f18f2"><td class="memItemLeft" align="right" valign="top"><a id="a1e6f90e673f1651f1546af9a598f18f2" name="a1e6f90e673f1651f1546af9a598f18f2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>back_plt</b></td></tr>
<tr class="separator:a1e6f90e673f1651f1546af9a598f18f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d42d479602ba7103d40854d696ef438" id="r_a6d42d479602ba7103d40854d696ef438"><td class="memItemLeft" align="right" valign="top"><a id="a6d42d479602ba7103d40854d696ef438" name="a6d42d479602ba7103d40854d696ef438"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>float_plt</b></td></tr>
<tr class="separator:a6d42d479602ba7103d40854d696ef438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad390bb5a59ecbedcd954e93c4112b95f" id="r_ad390bb5a59ecbedcd954e93c4112b95f"><td class="memItemLeft" align="right" valign="top"><a id="ad390bb5a59ecbedcd954e93c4112b95f" name="ad390bb5a59ecbedcd954e93c4112b95f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>line_plt</b></td></tr>
<tr class="separator:ad390bb5a59ecbedcd954e93c4112b95f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a944741645bb51634cd0cd79b0f5c880c" id="r_a944741645bb51634cd0cd79b0f5c880c"><td class="memItemLeft" align="right" valign="top"><a id="a944741645bb51634cd0cd79b0f5c880c" name="a944741645bb51634cd0cd79b0f5c880c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>points_plt</b></td></tr>
<tr class="separator:a944741645bb51634cd0cd79b0f5c880c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23f49f701d2d2d1826da95278d96746f" id="r_a23f49f701d2d2d1826da95278d96746f"><td class="memItemLeft" align="right" valign="top"><a id="a23f49f701d2d2d1826da95278d96746f" name="a23f49f701d2d2d1826da95278d96746f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>quiver</b></td></tr>
<tr class="separator:a23f49f701d2d2d1826da95278d96746f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437585bedd20447eb4ffe1ffa7770bcd" id="r_a437585bedd20447eb4ffe1ffa7770bcd"><td class="memItemLeft" align="right" valign="top"><a id="a437585bedd20447eb4ffe1ffa7770bcd" name="a437585bedd20447eb4ffe1ffa7770bcd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_corner_with_definition</b></td></tr>
<tr class="separator:a437585bedd20447eb4ffe1ffa7770bcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96dbb5c8baf443a0b757d117330d89b6" id="r_a96dbb5c8baf443a0b757d117330d89b6"><td class="memItemLeft" align="right" valign="top"><a id="a96dbb5c8baf443a0b757d117330d89b6" name="a96dbb5c8baf443a0b757d117330d89b6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_depth</b></td></tr>
<tr class="separator:a96dbb5c8baf443a0b757d117330d89b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a315556486e7e941c41eb072c7bd93b2e" id="r_a315556486e7e941c41eb072c7bd93b2e"><td class="memItemLeft" align="right" valign="top"><a id="a315556486e7e941c41eb072c7bd93b2e" name="a315556486e7e941c41eb072c7bd93b2e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>error_list</b></td></tr>
<tr class="separator:a315556486e7e941c41eb072c7bd93b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087ba3f393340dc3e98e2f4b0717bf90" id="r_a087ba3f393340dc3e98e2f4b0717bf90"><td class="memItemLeft" align="right" valign="top"><a id="a087ba3f393340dc3e98e2f4b0717bf90" name="a087ba3f393340dc3e98e2f4b0717bf90"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>invert_y</b></td></tr>
<tr class="separator:a087ba3f393340dc3e98e2f4b0717bf90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5fe35e96c37a5189461dc200d9860d4b" name="a5fe35e96c37a5189461dc200d9860d4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fe35e96c37a5189461dc200d9860d4b">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>camera_matrix</em> = <code>JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_MTX</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distortion_matrix</em> = <code>JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_DIST</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rvecs</em> = <code>JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_RVEC</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  148</span>    <span class="keyword">def </span>__init__(self, image=None, camera_matrix=JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_MTX, distortion_matrix=JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_DIST, rvecs=JUSTIN_HERO4_SILVER_720_MEDIUM_FOV_RVEC):</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>        </div>
<div class="line"><span class="lineno">  151</span>        self.window_name = <span class="stringliteral">&quot;Room Estimation&quot;</span></div>
<div class="line"><span class="lineno">  152</span>        cv2.namedWindow(<span class="stringliteral">&quot;Room Estimation&quot;</span>)</div>
<div class="line"><span class="lineno">  153</span>        self.image = image</div>
<div class="line"><span class="lineno">  154</span>        self.show_img = self.img_copy()</div>
<div class="line"><span class="lineno">  155</span>        self.corners = []</div>
<div class="line"><span class="lineno">  156</span>        self.room_points = [] <span class="comment"># The formatted real_locations that is used in processing data</span></div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>        self.real_locations = [] <span class="comment"># Raw input of points in 3D [(0,0,0), (1000,0 ,0), (1000, 2000, 0), (0, 2000,0)]</span></div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>        self.camera_matrix = camera_matrix</div>
<div class="line"><span class="lineno">  161</span>        self.distioriton_matrix = distortion_matrix</div>
<div class="line"><span class="lineno">  162</span>        self.calibration_errors = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>        self.calibration_resolution = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>        self.rotation_vector = rvecs</div>
<div class="line"><span class="lineno">  167</span>        self.translation_vector = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>        <span class="comment"># Size are in millimeters</span></div>
<div class="line"><span class="lineno">  170</span>        self.room_width = 3000  <span class="comment"># X</span></div>
<div class="line"><span class="lineno">  171</span>        self.room_length = 3000 <span class="comment"># Depth (Z)</span></div>
<div class="line"><span class="lineno">  172</span>        self.room_height = 3000 <span class="comment"># Y</span></div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>        self.sample_rate = 5   <span class="comment"># estimates position every 1cm</span></div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>        self.mapped_dictionary = {}</div>
<div class="line"><span class="lineno">  177</span>        self.mapped = {}</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>        self.points_data = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>        self.vector_depth = 0</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>        self.axis = self.set_axis(3000,1000,3000)</div>
<div class="line"><span class="lineno">  184</span>        self.fig = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  185</span>        self.stitch_homographies = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>        <span class="comment"># img = self.draw_axis()</span></div>
<div class="line"><span class="lineno">  188</span>        <span class="comment"># cv2.waitKey(1)</span></div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>        <span class="comment"># self.mapped_dictionary = self.map_2d_to_3d((self.room_width, self.room_length, self.room_height))</span></div>
<div class="line"><span class="lineno">  191</span>        </div>
<div class="line"><span class="lineno">  192</span>        self.show_3D_plot = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  193</span>        <span class="comment"># while True:</span></div>
<div class="line"><span class="lineno">  194</span>        <span class="comment">#     cv2.imshow(self.window_name, self.show_img)</span></div>
<div class="line"><span class="lineno">  195</span>        <span class="comment">#     cv2.waitKey(1)</span></div>
<div class="line"><span class="lineno">  196</span>        <span class="comment"># self.corner_points = []</span></div>
<div class="line"><span class="lineno">  197</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a921523998615aa3555a3cb0ca2b36965" name="a921523998615aa3555a3cb0ca2b36965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a921523998615aa3555a3cb0ca2b36965">&#9670;&#160;</a></span>assign_non_square_corners()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">assign_non_square_corners </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_points</em> = <code>inf</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Assigns points around the room with any number of known coordinates.

Assign point
Set width and length of known coordinate.
Origin should be 0,0
Sets the dimentions of the room to the largest dimensions
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1109</span>    <span class="keyword">def </span>assign_non_square_corners(self, num_points=inf):</div>
<div class="line"><span class="lineno"> 1110</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1111</span><span class="stringliteral">        Assigns points around the room with any number of known coordinates.</span></div>
<div class="line"><span class="lineno"> 1112</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1113</span><span class="stringliteral">        Assign point</span></div>
<div class="line"><span class="lineno"> 1114</span><span class="stringliteral">        Set width and length of known coordinate.</span></div>
<div class="line"><span class="lineno"> 1115</span><span class="stringliteral">        Origin should be 0,0</span></div>
<div class="line"><span class="lineno"> 1116</span><span class="stringliteral">        Sets the dimentions of the room to the largest dimensions</span></div>
<div class="line"><span class="lineno"> 1117</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1118</span> </div>
<div class="line"><span class="lineno"> 1119</span>        print(<span class="stringliteral">&quot;Assigning corners...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1120</span>        <span class="comment">#Initializes feedback to a function</span></div>
<div class="line"><span class="lineno"> 1121</span>        cv2.setMouseCallback(<span class="stringliteral">&quot;Room Estimation&quot;</span>, self.get_corners)</div>
<div class="line"><span class="lineno"> 1122</span>        <span class="keywordflow">while</span> len(self.corners) &lt; num_points:</div>
<div class="line"><span class="lineno"> 1123</span>            </div>
<div class="line"><span class="lineno"> 1124</span>            <span class="comment"># if len(self.corners) &gt;= 4:</span></div>
<div class="line"><span class="lineno"> 1125</span>            <span class="comment">#     print(&quot;SHOWING ROOM&quot;)</span></div>
<div class="line"><span class="lineno"> 1126</span>            <span class="comment">#     self.show_img, cube, target_cube = self.draw_cuboid()</span></div>
<div class="line"><span class="lineno"> 1127</span>            <span class="comment"># print(len(self.corners))</span></div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>            <span class="comment"># display the image and wait for a keypress</span></div>
<div class="line"><span class="lineno"> 1130</span>            cv2.setMouseCallback(<span class="stringliteral">&quot;Room Estimation&quot;</span>, self.get_corner_with_definition)</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>            cv2.imshow(<span class="stringliteral">&quot;Room Estimation&quot;</span>, self.show_img)</div>
<div class="line"><span class="lineno"> 1135</span>            key = cv2.waitKey(1) &amp; 0xFF</div>
<div class="line"><span class="lineno"> 1136</span>            self.connect_points(self.corners)</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span> </div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&quot;c&quot;</span>):</div>
<div class="line"><span class="lineno"> 1141</span>                <span class="keywordflow">if</span> len(self.corners) &lt; 4:</div>
<div class="line"><span class="lineno"> 1142</span>                    print(<span class="stringliteral">&quot;You need at least 4 points&quot;</span>)</div>
<div class="line"><span class="lineno"> 1143</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1144</span>                    <span class="comment"># break</span></div>
<div class="line"><span class="lineno"> 1145</span>                    self.corners = np.reshape(np.asfarray(self.corners), (len(self.corners),2,1))</div>
<div class="line"><span class="lineno"> 1146</span>                    self.room_points = self.get_n_room_points()</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>                    <span class="comment"># set measurments to maximum sizes</span></div>
<div class="line"><span class="lineno"> 1149</span>                    self.room_width = 0</div>
<div class="line"><span class="lineno"> 1150</span>                    self.room_length = 0</div>
<div class="line"><span class="lineno"> 1151</span>                    <span class="keywordflow">for</span> point <span class="keywordflow">in</span> self.room_points:</div>
<div class="line"><span class="lineno"> 1152</span>                        width = int(point[0][0])</div>
<div class="line"><span class="lineno"> 1153</span>                        length = int(point[1][0])</div>
<div class="line"><span class="lineno"> 1154</span>                        <span class="keywordflow">if</span> width &gt; self.room_width:</div>
<div class="line"><span class="lineno"> 1155</span>                            self.room_width = width</div>
<div class="line"><span class="lineno"> 1156</span>                        <span class="keywordflow">if</span> length &gt; self.room_length:</div>
<div class="line"><span class="lineno"> 1157</span>                            self.room_length = length</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>                    <span class="keywordflow">return</span> self.room_points, self.corners</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>        self.connect_points(self.corners)</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>        <span class="comment"># set measurments to maximum sizes </span></div>
<div class="line"><span class="lineno"> 1164</span>        <span class="keywordflow">for</span> point <span class="keywordflow">in</span> self.room_points:</div>
<div class="line"><span class="lineno"> 1165</span>            width = int(point[0][0])</div>
<div class="line"><span class="lineno"> 1166</span>            length = int(point[1][0])</div>
<div class="line"><span class="lineno"> 1167</span>            <span class="keywordflow">if</span> width &gt; self.room_width:</div>
<div class="line"><span class="lineno"> 1168</span>                self.room_width = width</div>
<div class="line"><span class="lineno"> 1169</span>            <span class="keywordflow">if</span> length &gt; self.room_length:</div>
<div class="line"><span class="lineno"> 1170</span>                self.room_length = length</div>
<div class="line"><span class="lineno"> 1171</span>        </div>
<div class="line"><span class="lineno"> 1172</span>        <span class="comment"># Set measurments to numpy arrays</span></div>
<div class="line"><span class="lineno"> 1173</span>        self.corners = np.reshape(np.asfarray(self.corners), (len(self.corners),2,1))</div>
<div class="line"><span class="lineno"> 1174</span>        self.room_points = self.get_n_room_points()</div>
<div class="line"><span class="lineno"> 1175</span>        <span class="comment"># cv2.setMouseCallback(&quot;Room Estimation&quot;, self.draw_vector)</span></div>
<div class="line"><span class="lineno"> 1176</span>        <span class="keywordflow">return</span> self.room_points, self.corners</div>
<div class="line"><span class="lineno"> 1177</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.camera_matrix, room_estimation.connect_points(), room_estimation.corners, room_estimation.distioriton_matrix, room_estimation.get_corner_with_definition(), room_estimation.get_corner_with_definition, room_estimation.get_corners, room_estimation.get_corners(), <a class="el" href="a00206.html#ae29c16a83d737f9e9f2b584ae560ad85">room_estimation.get_n_room_points()</a>, room_estimation.room_length, room_estimation.room_points, room_estimation.room_width, room_estimation.rotation_vector, room_estimation.show_img, and room_estimation.translation_vector.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a921523998615aa3555a3cb0ca2b36965_cgraph.png" border="0" usemap="#aa00206_a921523998615aa3555a3cb0ca2b36965_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a770916344506672f541f976b5048555f" name="a770916344506672f541f976b5048555f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a770916344506672f541f976b5048555f">&#9670;&#160;</a></span>checkerboard_calibrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">checkerboard_calibrate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>checkerboard_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>checkerboard_grid</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1781</span>    <span class="keyword">def </span>checkerboard_calibrate(self, checkerboard_images, checkerboard_grid=None, out=None):</div>
<div class="line"><span class="lineno"> 1782</span>        <span class="comment"># Will look at what this means after</span></div>
<div class="line"><span class="lineno"> 1783</span>        criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 30, 0.001)</div>
<div class="line"><span class="lineno"> 1784</span>        <span class="comment"># calibration_flags = cv2.fisheye.CALIB_RECOMPUTE_EXTRINSIC+cv2.fisheye.CALIB_CHECK_COND+cv2.fisheye.CALIB_FIX_SKEW</span></div>
<div class="line"><span class="lineno"> 1785</span>        <span class="comment"># calibration_flags = cv2.fisheye.CALIB_RECOMPUTE_EXTRINSIC + cv2.fisheye.CALIB_CHECK_COND + cv2.fisheye.CALIB_FIX_SKEW + cv2.</span></div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>        calibration_flags = cv2.CALIB_RATIONAL_MODEL + cv2.CALIB_FIX_PRINCIPAL_POINT</div>
<div class="line"><span class="lineno"> 1788</span> </div>
<div class="line"><span class="lineno"> 1789</span>        <span class="comment"># Creating vector to store vectors of 3D points for each checkerboard image</span></div>
<div class="line"><span class="lineno"> 1790</span>        objpoints = []</div>
<div class="line"><span class="lineno"> 1791</span>        <span class="comment"># Creating vector to store vectors of 2D points for each checkerboard image</span></div>
<div class="line"><span class="lineno"> 1792</span>        imgpoints = [] </div>
<div class="line"><span class="lineno"> 1793</span> </div>
<div class="line"><span class="lineno"> 1794</span>        imgshape = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1795</span>    </div>
<div class="line"><span class="lineno"> 1796</span>        checkerboard_grid = self.get_checkerboard_shape(checkerboard_images)</div>
<div class="line"><span class="lineno"> 1797</span>        height, width = checkerboard_images[0].shape[:2]</div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span>        <span class="keywordflow">for</span> image <span class="keywordflow">in</span> checkerboard_images:</div>
<div class="line"><span class="lineno"> 1800</span> </div>
<div class="line"><span class="lineno"> 1801</span>            image = cv2.cvtColor(image,cv2.COLOR_BGR2GRAY)</div>
<div class="line"><span class="lineno"> 1802</span> </div>
<div class="line"><span class="lineno"> 1803</span>            cv2.imshow(<span class="stringliteral">&#39;img&#39;</span>,image)</div>
<div class="line"><span class="lineno"> 1804</span>            cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1805</span>            imgshape = image.shape</div>
<div class="line"><span class="lineno"> 1806</span>            retval, corners = cv2.findChessboardCorners(image, checkerboard_grid)</div>
<div class="line"><span class="lineno"> 1807</span>            <span class="comment"># cv2.cornerSubPix(checkerboard_image, corners)</span></div>
<div class="line"><span class="lineno"> 1808</span> </div>
<div class="line"><span class="lineno"> 1809</span>            <span class="comment"># retval, cameraMatrix, distCoeffs, rvecs, tvecs = cv2.calibrateCamera(objectPoints, imagePoints, imageSize)</span></div>
<div class="line"><span class="lineno"> 1810</span>            objp = np.zeros((1, checkerboard_grid[0] * checkerboard_grid[1], 3), np.float32)</div>
<div class="line"><span class="lineno"> 1811</span>            objp[0,:,:2] = np.mgrid[0:checkerboard_grid[0], 0:checkerboard_grid[1]].T.reshape(-1, 2)</div>
<div class="line"><span class="lineno"> 1812</span>            prev_img_shape = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1813</span>     </div>
<div class="line"><span class="lineno"> 1814</span> </div>
<div class="line"><span class="lineno"> 1815</span> </div>
<div class="line"><span class="lineno"> 1816</span>            <span class="keywordflow">if</span> retval == <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno"> 1817</span>                objpoints.append(objp)</div>
<div class="line"><span class="lineno"> 1818</span>                <span class="comment"># refining pixel coordinates for given 2d points.</span></div>
<div class="line"><span class="lineno"> 1819</span>                corners2 = cv2.cornerSubPix(image, corners, (11,11),(-1,-1), criteria)  </div>
<div class="line"><span class="lineno"> 1820</span>                imgpoints.append(corners2)</div>
<div class="line"><span class="lineno"> 1821</span>                <span class="comment"># Draw and display the corners</span></div>
<div class="line"><span class="lineno"> 1822</span> </div>
<div class="line"><span class="lineno"> 1823</span>                image = cv2.drawChessboardCorners(image, checkerboard_grid, corners2, retval)</div>
<div class="line"><span class="lineno"> 1824</span>                cv2.imshow(<span class="stringliteral">&quot;Calibration&quot;</span>, image)</div>
<div class="line"><span class="lineno"> 1825</span>                cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1826</span>        cv2.destroyAllWindows()</div>
<div class="line"><span class="lineno"> 1827</span> </div>
<div class="line"><span class="lineno"> 1828</span> </div>
<div class="line"><span class="lineno"> 1829</span> </div>
<div class="line"><span class="lineno"> 1830</span>        <span class="comment"># cv2.calibrateCameraExtended()</span></div>
<div class="line"><span class="lineno"> 1831</span>        print(<span class="stringliteral">&quot;Calibrating... &quot;</span>, len(objpoints), <span class="stringliteral">&quot; images&quot;</span>)</div>
<div class="line"><span class="lineno"> 1832</span>        ret, mtx, dist, rvecs, tvecs = cv2.calibrateCamera(objpoints, imgpoints, imgshape[::-1], <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, flags=calibration_flags, criteria=criteria)</div>
<div class="line"><span class="lineno"> 1833</span>        </div>
<div class="line"><span class="lineno"> 1834</span>        mean_error = 0</div>
<div class="line"><span class="lineno"> 1835</span>        total_error = 0</div>
<div class="line"><span class="lineno"> 1836</span>        error_list = []</div>
<div class="line"><span class="lineno"> 1837</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(objpoints)):</div>
<div class="line"><span class="lineno"> 1838</span>            imgpoints2, _ = cv2.projectPoints(objpoints[i], rvecs[i], tvecs[i], mtx, dist)</div>
<div class="line"><span class="lineno"> 1839</span>            error = cv2.norm(imgpoints[i],imgpoints2, cv2.NORM_L2)/len(imgpoints2)</div>
<div class="line"><span class="lineno"> 1840</span>            total_error += error</div>
<div class="line"><span class="lineno"> 1841</span>            error_list.append(error)</div>
<div class="line"><span class="lineno"> 1842</span>        mean_error = total_error/len(objpoints)</div>
<div class="line"><span class="lineno"> 1843</span> </div>
<div class="line"><span class="lineno"> 1844</span>        print(mean_error)</div>
<div class="line"><span class="lineno"> 1845</span>        self.camera_matrix = mtx</div>
<div class="line"><span class="lineno"> 1846</span>        self.distioriton_matrix = dist</div>
<div class="line"><span class="lineno"> 1847</span>        self.rotation_vector = rvecs</div>
<div class="line"><span class="lineno"> 1848</span>        self.translation_vector = tvecs</div>
<div class="line"><span class="lineno"> 1849</span>        self.error_list = error_list</div>
<div class="line"><span class="lineno"> 1850</span>        self.calibration_resolution = (width, height)</div>
<div class="line"><span class="lineno"> 1851</span>        self.save_calibration(out, mtx, dist, rvecs, tvecs, error_list, self.calibration_resolution)</div>
<div class="line"><span class="lineno"> 1852</span>        print(<span class="stringliteral">&quot;Camera:&quot;</span> ,mtx, <span class="stringliteral">&quot;Distoriton:&quot;</span>, dist)</div>
<div class="line"><span class="lineno"> 1853</span>        <span class="keywordflow">return</span> mtx, dist, rvecs, tvecs, mean_error</div>
<div class="line"><span class="lineno"> 1854</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0188ed983122bc7494460062c8ca22b" name="ab0188ed983122bc7494460062c8ca22b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0188ed983122bc7494460062c8ca22b">&#9670;&#160;</a></span>clear_corners()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">clear_corners </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  462</span>    <span class="keyword">def </span>clear_corners(self):</div>
<div class="line"><span class="lineno">  463</span>        print(<span class="stringliteral">&quot;Clearing Corners!&quot;</span>)</div>
<div class="line"><span class="lineno">  464</span>        self.corners = []</div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">return</span> self.corners</div>
<div class="line"><span class="lineno">  466</span>    </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#ae4a382139afef48e3b930752120b4c35">room_estimation.define_perspective_grid()</a>, <a class="el" href="a00206.html#a2e21d867efbc8b743664f8b6f41d1b8e">room_estimation.extend_image_to_corners()</a>, <a class="el" href="a00206.html#af69d43ebb2e1d46a4e6313f41860c4fb">room_estimation.find_wall_intersection()</a>, <a class="el" href="a00206.html#a1cc866ee6a78b68a77485eb1eb0f00ba">room_estimation.get_room_corners()</a>, and <a class="el" href="a00206.html#abeac4cbae89aef891cee148cbbbc6232">room_estimation.superimpose_checker()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_ab0188ed983122bc7494460062c8ca22b_icgraph.png" border="0" usemap="#aa00206_ab0188ed983122bc7494460062c8ca22b_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a048722841bc8d71bae4a1e4a9eb9db00" name="a048722841bc8d71bae4a1e4a9eb9db00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a048722841bc8d71bae4a1e4a9eb9db00">&#9670;&#160;</a></span>collect_frames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">collect_frames </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>video_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>start_frame</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>skip</em> = <code>15</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>total_frames</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Collects the images for stitching
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1893</span>    <span class="keyword">def </span>collect_frames(self, video_source, start_frame=1, skip=15, total_frames=None):</div>
<div class="line"><span class="lineno"> 1894</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1895</span><span class="stringliteral">        Collects the images for stitching</span></div>
<div class="line"><span class="lineno"> 1896</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1897</span>        print(video_source)</div>
<div class="line"><span class="lineno"> 1898</span>        cap = cv2.VideoCapture(video_source)</div>
<div class="line"><span class="lineno"> 1899</span>        </div>
<div class="line"><span class="lineno"> 1900</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> cap.isOpened():</div>
<div class="line"><span class="lineno"> 1901</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unable to open video source&quot;</span>, video_source)</div>
<div class="line"><span class="lineno"> 1902</span>        print(<span class="stringliteral">&quot;Collecting Frames...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1903</span>        <span class="keywordflow">if</span> total_frames == <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1904</span>            total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))</div>
<div class="line"><span class="lineno"> 1905</span>        <span class="comment">#setup cv2 capture from video</span></div>
<div class="line"><span class="lineno"> 1906</span>        cap = cv2.VideoCapture(video_source)</div>
<div class="line"><span class="lineno"> 1907</span>        frames = []</div>
<div class="line"><span class="lineno"> 1908</span>        <span class="comment">#set the starting frame</span></div>
<div class="line"><span class="lineno"> 1909</span>        cap.set(cv2.CAP_PROP_POS_FRAMES, start_frame)</div>
<div class="line"><span class="lineno"> 1910</span>        <span class="comment"># print(&quot;Starting at frame: &quot; + str(cap.get(cv2.CAP_PROP_POS_FRAMES)))</span></div>
<div class="line"><span class="lineno"> 1911</span> </div>
<div class="line"><span class="lineno"> 1912</span>        last = 0</div>
<div class="line"><span class="lineno"> 1913</span>        <span class="keywordflow">while</span> (cap.get(cv2.CAP_PROP_POS_FRAMES)+ skip-1) &lt; total_frames:</div>
<div class="line"><span class="lineno"> 1914</span>            print(cap.get(cv2.CAP_PROP_POS_FRAMES), <span class="stringliteral">&quot;/&quot;</span>, total_frames)</div>
<div class="line"><span class="lineno"> 1915</span>            last = cap.get(cv2.CAP_PROP_POS_FRAMES)</div>
<div class="line"><span class="lineno"> 1916</span>            <span class="comment"># print(frames)</span></div>
<div class="line"><span class="lineno"> 1917</span>            <span class="comment">#read the image from that skipped frame</span></div>
<div class="line"><span class="lineno"> 1918</span>            ret, frame = cap.read()</div>
<div class="line"><span class="lineno"> 1919</span> </div>
<div class="line"><span class="lineno"> 1920</span>            cap.set(cv2.CAP_PROP_POS_FRAMES, cap.get(cv2.CAP_PROP_POS_FRAMES) + skip-1)</div>
<div class="line"><span class="lineno"> 1921</span> </div>
<div class="line"><span class="lineno"> 1922</span>            <span class="keywordflow">if</span> last == cap.get(cv2.CAP_PROP_POS_FRAMES):</div>
<div class="line"><span class="lineno"> 1923</span>                <span class="comment"># print(&quot;NEXT&quot;)</span></div>
<div class="line"><span class="lineno"> 1924</span>                next=10</div>
<div class="line"><span class="lineno"> 1925</span>                last = cap.get(cv2.CAP_PROP_POS_FRAMES)</div>
<div class="line"><span class="lineno"> 1926</span>                <span class="keywordflow">while</span> last == cap.get(cv2.CAP_PROP_POS_FRAMES):</div>
<div class="line"><span class="lineno"> 1927</span>                    next += 10</div>
<div class="line"><span class="lineno"> 1928</span>                    print(next)</div>
<div class="line"><span class="lineno"> 1929</span>                    ret, frame = cap.read()</div>
<div class="line"><span class="lineno"> 1930</span>                    cap.set(cv2.CAP_PROP_POS_FRAMES, cap.get(cv2.CAP_PROP_POS_FRAMES) + next + skip-1)</div>
<div class="line"><span class="lineno"> 1931</span>            <span class="comment">#set current frame to the next n-skipped frames</span></div>
<div class="line"><span class="lineno"> 1932</span>            <span class="comment"># print(cap.get(cv2.CAP_PROP_POS_FRAMES))</span></div>
<div class="line"><span class="lineno"> 1933</span> </div>
<div class="line"><span class="lineno"> 1934</span>            <span class="keywordflow">if</span> ret:</div>
<div class="line"><span class="lineno"> 1935</span>                <span class="comment"># print(ret)</span></div>
<div class="line"><span class="lineno"> 1936</span>                <span class="comment"># if cv2.waitKey(30) &amp; 0xFF == ord(&#39;q&#39;):</span></div>
<div class="line"><span class="lineno"> 1937</span>                <span class="comment">#     break</span></div>
<div class="line"><span class="lineno"> 1938</span>                <span class="comment"># cv2.imshow(&#39;frame&#39;, frame)</span></div>
<div class="line"><span class="lineno"> 1939</span>                <span class="comment">#append the frames to be processed</span></div>
<div class="line"><span class="lineno"> 1940</span>                frames.append(frame)</div>
<div class="line"><span class="lineno"> 1941</span> </div>
<div class="line"><span class="lineno"> 1942</span>                cv2.imshow(<span class="stringliteral">&quot;FrameCollection&quot;</span>, frame)</div>
<div class="line"><span class="lineno"> 1943</span>                cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1944</span> </div>
<div class="line"><span class="lineno"> 1945</span>        cv2.destroyAllWindows()</div>
<div class="line"><span class="lineno"> 1946</span>        <span class="keywordflow">return</span> frames</div>
<div class="line"><span class="lineno"> 1947</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a2a5df656a4b4d07c05b290f8197c316f">room_estimation.save_room()</a>, <a class="el" href="a00206.html#adbe2f98b84513775c3106191f2845ed3">room_estimation.stitch_rooms()</a>, and <a class="el" href="a00206.html#a75031a34aadd8c7847c479a17524e00e">room_estimation.stitch_trackers()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a048722841bc8d71bae4a1e4a9eb9db00_icgraph.png" border="0" usemap="#aa00206_a048722841bc8d71bae4a1e4a9eb9db00_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ae2c8ef2eee13d8eb75d88c0559626fac" name="ae2c8ef2eee13d8eb75d88c0559626fac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2c8ef2eee13d8eb75d88c0559626fac">&#9670;&#160;</a></span>connect_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">connect_points </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  506</span>    <span class="keyword">def </span>connect_points(self, points):</div>
<div class="line"><span class="lineno">  507</span>        <span class="stringliteral">&quot;Helper functio nthat visualizes corners&quot;</span></div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordflow">for</span> index, point <span class="keywordflow">in</span> enumerate(points):</div>
<div class="line"><span class="lineno">  509</span>            <span class="keywordflow">if</span> self.room_points:</div>
<div class="line"><span class="lineno">  510</span>                p1 = (int(points[index][0]), int(points[index][1]))</div>
<div class="line"><span class="lineno">  511</span>                self.show_img = cv2.putText(self.show_img, str(self.room_points[index]), p1, fontFace=cv2.FONT_HERSHEY_PLAIN,fontScale=1, color=(255,0,0), thickness=2)</div>
<div class="line"><span class="lineno">  512</span>            <span class="comment"># if index+1 == len(points):</span></div>
<div class="line"><span class="lineno">  513</span>            <span class="comment">#     # print(&quot;Last point&quot;)</span></div>
<div class="line"><span class="lineno">  514</span>            <span class="comment">#     p1 = (int(points[index][0]), int(points[index][1]))</span></div>
<div class="line"><span class="lineno">  515</span>            <span class="comment">#     p2 = (int(points[0][0]), int(points[0][1]))</span></div>
<div class="line"><span class="lineno">  516</span>            <span class="comment">#     cv2.line(self.show_img, p1, p2, (255,0,0))</span></div>
<div class="line"><span class="lineno">  517</span>            <span class="keywordflow">if</span> len(points) &gt; 1 <span class="keywordflow">and</span> index+1 &lt; len(points):</div>
<div class="line"><span class="lineno">  518</span>                p1 = (int(points[index][0]), int(points[index][1]))</div>
<div class="line"><span class="lineno">  519</span>                p2 = (int(points[index+1][0]), int(points[index+1][1]))</div>
<div class="line"><span class="lineno">  520</span>                self.show_img=cv2.line(self.show_img, p1, p2, (255,0,0))</div>
<div class="line"><span class="lineno">  521</span>                </div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>        cv2.imshow(self.window_name, self.show_img)</div>
<div class="line"><span class="lineno">  524</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a921523998615aa3555a3cb0ca2b36965">room_estimation.assign_non_square_corners()</a>, <a class="el" href="a00206.html#af69d43ebb2e1d46a4e6313f41860c4fb">room_estimation.find_wall_intersection()</a>, and <a class="el" href="a00206.html#a1cc866ee6a78b68a77485eb1eb0f00ba">room_estimation.get_room_corners()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_ae2c8ef2eee13d8eb75d88c0559626fac_icgraph.png" border="0" usemap="#aa00206_ae2c8ef2eee13d8eb75d88c0559626fac_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ab870abde92556016846a09d5feb9e03c" name="ab870abde92556016846a09d5feb9e03c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab870abde92556016846a09d5feb9e03c">&#9670;&#160;</a></span>correct_tracker_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">correct_tracker_points </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">ratios is the x,y|width,height ratios of the estimate to the ground truth.
Example: Estimates are recorded at 480x720 while ground truths are recorded at 720x1280. The ratio inputed would be (720/480, 1280/720) or (1.5, 1.777778)


invert_y is the height of the video. We record the data as if the origin is in the bottom left, but in other applications the origin is the top left.
This means we subtract the height of the video to inverse this effect.
If the height of the video is 720, invert_y=720. If the data being tested IS NOT inverted, leave it as 0 
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2115</span>    <span class="keyword">def </span>correct_tracker_points(self, df):</div>
<div class="line"><span class="lineno"> 2116</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2117</span><span class="stringliteral">        ratios is the x,y|width,height ratios of the estimate to the ground truth.</span></div>
<div class="line"><span class="lineno"> 2118</span><span class="stringliteral">        Example: Estimates are recorded at 480x720 while ground truths are recorded at 720x1280. The ratio inputed would be (720/480, 1280/720) or (1.5, 1.777778)</span></div>
<div class="line"><span class="lineno"> 2119</span><span class="stringliteral">        </span></div>
<div class="line"><span class="lineno"> 2120</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2121</span><span class="stringliteral">        invert_y is the height of the video. We record the data as if the origin is in the bottom left, but in other applications the origin is the top left.</span></div>
<div class="line"><span class="lineno"> 2122</span><span class="stringliteral">        This means we subtract the height of the video to inverse this effect.</span></div>
<div class="line"><span class="lineno"> 2123</span><span class="stringliteral">        If the height of the video is 720, invert_y=720. If the data being tested IS NOT inverted, leave it as 0 </span></div>
<div class="line"><span class="lineno"> 2124</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2125</span>        width = int(df.iloc[0][<span class="stringliteral">&#39;Width(px)&#39;</span>])</div>
<div class="line"><span class="lineno"> 2126</span>        height = int(df.iloc[0][<span class="stringliteral">&#39;Height(px)&#39;</span>])</div>
<div class="line"><span class="lineno"> 2127</span> </div>
<div class="line"><span class="lineno"> 2128</span>        df = df.iloc[1: , :] <span class="comment"># Drop first row</span></div>
<div class="line"><span class="lineno"> 2129</span>        </div>
<div class="line"><span class="lineno"> 2130</span>        df[<span class="stringliteral">&#39;Pixel_Loc_x&#39;</span>] = df[<span class="stringliteral">&#39;Pixel_Loc_x&#39;</span>].astype(int) * (width/df[<span class="stringliteral">&#39;Max_Pixel_x&#39;</span>].astype(int))</div>
<div class="line"><span class="lineno"> 2131</span>        df[<span class="stringliteral">&#39;Pixel_Loc_y&#39;</span>] = (df[<span class="stringliteral">&#39;Max_Pixel_y&#39;</span>].astype(int) - df[<span class="stringliteral">&#39;Pixel_Loc_y&#39;</span>].astype(int)) * (height/df[<span class="stringliteral">&#39;Max_Pixel_y&#39;</span>].astype(int))</div>
<div class="line"><span class="lineno"> 2132</span>        <span class="comment"># point = (float(point[&#39;Pixel_Loc_x&#39;])*ratios[0],</span></div>
<div class="line"><span class="lineno"> 2133</span>        <span class="comment"># (invert_y-float(point[&#39;y2&#39;]))*ratios[1],</span></div>
<div class="line"><span class="lineno"> 2134</span>        <span class="comment">#         float(point[&#39;x2&#39;])*ratios[0],</span></div>
<div class="line"><span class="lineno"> 2135</span>        <span class="comment"># (invert_y-float(point[&#39;y1&#39;]))*ratios[1]</span></div>
<div class="line"><span class="lineno"> 2136</span>        <span class="comment"># )</span></div>
<div class="line"><span class="lineno"> 2137</span>        print(df)</div>
<div class="line"><span class="lineno"> 2138</span>        <span class="keywordflow">return</span> df</div>
<div class="line"><span class="lineno"> 2139</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a444510358faa06884318d1ebe94846ff">room_estimation.load_tracker()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_ab870abde92556016846a09d5feb9e03c_icgraph.png" border="0" usemap="#aa00206_ab870abde92556016846a09d5feb9e03c_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a9d5c0b06be5dbf308587eac88c486612" name="a9d5c0b06be5dbf308587eac88c486612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d5c0b06be5dbf308587eac88c486612">&#9670;&#160;</a></span>crop_plain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">crop_plain </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plain_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plain_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Given 4 points the image will be cropped and reprojected as a rectangle.

NOTE: Use length and height synonymously

points = [(x1,y1), (x2,y2) ... (x4,y4)]
</pre> <div class="fragment"><div class="line"><span class="lineno">  580</span>    <span class="keyword">def </span>crop_plain(self, points, plain_width, plain_length, image=None):</div>
<div class="line"><span class="lineno">  581</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">        Given 4 points the image will be cropped and reprojected as a rectangle.</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">        NOTE: Use length and height synonymously</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">        points = [(x1,y1), (x2,y2) ... (x4,y4)]</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  588</span>        <span class="keywordflow">if</span> image == <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  589</span>            image = self.image</div>
<div class="line"><span class="lineno">  590</span>            </div>
<div class="line"><span class="lineno">  591</span>        h, w = image.shape[:2]</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>        <span class="comment"># These are the physical dimensions of the wall and the ratio in order to calculate the perspective</span></div>
<div class="line"><span class="lineno">  594</span>        plane_ratio = plain_width/plain_length</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>        <span class="comment"># Perspective points are the points labelled multiplied by the ratio to get the end values of the points</span></div>
<div class="line"><span class="lineno">  597</span>        <span class="comment"># We start with the bottom left of the wall, which means we use max_y of the wall room</span></div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral">        2---3</span></div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral">        |   |</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">        1   4</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>        p1 = (plain_length,0)</div>
<div class="line"><span class="lineno">  606</span>        p2 = (0,0)</div>
<div class="line"><span class="lineno">  607</span>        p3 = (plain_length, plain_width)</div>
<div class="line"><span class="lineno">  608</span>        p4 = (0, plain_width)</div>
<div class="line"><span class="lineno">  609</span>        perspective_points = np.array([p1,p2,p3,p4])</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>        <span class="comment"># print(points)</span></div>
<div class="line"><span class="lineno">  612</span>        <span class="comment"># print(perspective_points)</span></div>
<div class="line"><span class="lineno">  613</span>        </div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>        points = np.array(points, dtype=np.float32)</div>
<div class="line"><span class="lineno">  616</span>        perspective_points = np.array(perspective_points, dtype=np.float32)</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>        print(points.shape)</div>
<div class="line"><span class="lineno">  619</span>        print(perspective_points.shape)</div>
<div class="line"><span class="lineno">  620</span>        <span class="comment"># use cv2.getPerspectiveTransform() to get M, the transform matrix, and Minv, the inverse</span></div>
<div class="line"><span class="lineno">  621</span>        M = cv2.getPerspectiveTransform(points, perspective_points)</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>        <span class="comment"># use cv2.warpPerspective() to warp your image to a top-down view</span></div>
<div class="line"><span class="lineno">  624</span>        warped = cv2.warpPerspective(image, M, (w, h), flags=cv2.INTER_LINEAR)</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>        cv2.imshow(<span class="stringliteral">&quot;Wall Warped&quot;</span>, warped)</div>
<div class="line"><span class="lineno">  627</span>        cv2.waitKey(0)</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>        <span class="keywordflow">return</span> warped</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span> </div>
</div><!-- fragment -->
<p class="reference">References App.image, room_estimation.image, and person_tab.image.</p>

</div>
</div>
<a id="ae4a382139afef48e3b930752120b4c35" name="ae4a382139afef48e3b930752120b4c35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4a382139afef48e3b930752120b4c35">&#9670;&#160;</a></span>define_perspective_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">define_perspective_grid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>division</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extend</em> = <code>500</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Assign 4 corners on an image where a grid will be projected into that space. This only selects the points and draws the edges. This should be called before superimpose_checker.

See superimpose_checker for definition of the grid and how it works.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1568</span>    <span class="keyword">def </span>define_perspective_grid(self, division=10, extend = 500):</div>
<div class="line"><span class="lineno"> 1569</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1570</span><span class="stringliteral">        Assign 4 corners on an image where a grid will be projected into that space. This only selects the points and draws the edges. This should be called before superimpose_checker.</span></div>
<div class="line"><span class="lineno"> 1571</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1572</span><span class="stringliteral">        See superimpose_checker for definition of the grid and how it works.</span></div>
<div class="line"><span class="lineno"> 1573</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1574</span>        wall = self.get_room_corners()</div>
<div class="line"><span class="lineno"> 1575</span> </div>
<div class="line"><span class="lineno"> 1576</span>        <span class="comment"># Describe a line with the two end points</span></div>
<div class="line"><span class="lineno"> 1577</span>        fit1, equation1 = self.poly_fit_wall(wall, pixels_past_extent=1000, degree=1)</div>
<div class="line"><span class="lineno"> 1578</span>        line_1 = (fit1[0], fit1[-1])</div>
<div class="line"><span class="lineno"> 1579</span>        self.clear_corners()</div>
<div class="line"><span class="lineno"> 1580</span> </div>
<div class="line"><span class="lineno"> 1581</span>        wall = self.get_room_corners()</div>
<div class="line"><span class="lineno"> 1582</span>        fit2, equation2 = self.poly_fit_wall(wall, pixels_past_extent=1000, degree=1)</div>
<div class="line"><span class="lineno"> 1583</span>        line_2 = (fit2[0], fit2[-1])</div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span>        intersection = self.find_intersection(equation1, equation2)</div>
<div class="line"><span class="lineno"> 1586</span>        self.show_img = cv2.circle(self.show_img, (int(intersection[0]), int(intersection[1])), 1,(0,255,0), 5, 0)</div>
<div class="line"><span class="lineno"> 1587</span>        print(intersection)</div>
<div class="line"><span class="lineno"> 1588</span>        </div>
<div class="line"><span class="lineno"> 1589</span>        <span class="comment"># self.make_interpolater()</span></div>
<div class="line"><span class="lineno"> 1590</span>        <span class="comment"># x1i = interpolate.interp1d(line_1[0],line_1[1])</span></div>
<div class="line"><span class="lineno"> 1591</span>        <span class="comment"># y1i = interpolate.interp1d(line_2[0],line_2[1])</span></div>
<div class="line"><span class="lineno"> 1592</span> </div>
<div class="line"><span class="lineno"> 1593</span>        <span class="comment"># x2i = interpolate.interp1d(line_1[0],line_2[0])</span></div>
<div class="line"><span class="lineno"> 1594</span>        <span class="comment"># y2i = interpolate.interp1d(line_1[1],line_2[1])</span></div>
<div class="line"><span class="lineno"> 1595</span> </div>
<div class="line"><span class="lineno"> 1596</span>        edge, step1 = np.linspace(line_1[0] - extend, line_2[0] + extend, division, endpoint=<span class="keyword">True</span>, retstep=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1597</span>        edge2, step2 = np.linspace(line_1[1] - extend, line_2[1] + extend, division, endpoint=<span class="keyword">True</span>, retstep=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1598</span>        </div>
<div class="line"><span class="lineno"> 1599</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(edge)):</div>
<div class="line"><span class="lineno"> 1600</span>            start = (int(edge[i][0]),int(edge[i][1]))</div>
<div class="line"><span class="lineno"> 1601</span>            end = (int(intersection[0]), int(intersection[1]))</div>
<div class="line"><span class="lineno"> 1602</span>            self.show_img = cv2.line(self.show_img, start, end, (255,0,0))</div>
<div class="line"><span class="lineno"> 1603</span> </div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>            start = (int(edge2[i][0]),int(edge2[i][1]))</div>
<div class="line"><span class="lineno"> 1606</span>            end = (int(intersection[0]), int(intersection[1]))</div>
<div class="line"><span class="lineno"> 1607</span> </div>
<div class="line"><span class="lineno"> 1608</span>            self.show_img = cv2.line(self.show_img, start, end, (255,0,0))</div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>            <span class="keywordflow">if</span> i % 10 == 0:</div>
<div class="line"><span class="lineno"> 1611</span>                self.show_img = cv2.line(self.show_img, start, end, (0,100,0), thickness=2)</div>
<div class="line"><span class="lineno"> 1612</span>            cv2.imshow(<span class="stringliteral">&quot;test_interp&quot;</span>, self.show_img)</div>
<div class="line"><span class="lineno"> 1613</span>            cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1614</span> </div>
<div class="line"><span class="lineno"> 1615</span>        self.clear_corners()</div>
<div class="line"><span class="lineno"> 1616</span> </div>
<div class="line"><span class="lineno"> 1617</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.clear_corners(), <a class="el" href="a00206.html#a54166ae0c7b7f8e5aadcc81eda56ce58">room_estimation.find_intersection()</a>, <a class="el" href="a00206.html#a1cc866ee6a78b68a77485eb1eb0f00ba">room_estimation.get_room_corners()</a>, <a class="el" href="a00206.html#a9ddc57e65b6b90133dae37504451b764">room_estimation.poly_fit_wall()</a>, and room_estimation.show_img.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_ae4a382139afef48e3b930752120b4c35_cgraph.png" border="0" usemap="#aa00206_ae4a382139afef48e3b930752120b4c35_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a84fbd0580af51d4905aeeb1b71889390" name="a84fbd0580af51d4905aeeb1b71889390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84fbd0580af51d4905aeeb1b71889390">&#9670;&#160;</a></span>define_room()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">define_room </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>width</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>length</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>height</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>offset</em> = <code>[0,0,0,0]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corners</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>room_points</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>refine_corners</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stitch_videos</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>calibration</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extend</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes variables and defines a room

- width: and length are in mm

- height: is the assumed height of all objects in the room

- offset: is used when we extend the image to get all of the corners.
NOTE: If arrows do not line up with lines you drew, the camera matrix or the distortion matrix are off

- room_points: are the real-world defined points in mm (if not defined points are the height and width of the room)

- refine_corners: is opencv's sub-pixel optimizer to better estimate corner locations. This is mostly used in checkerboard calibration but may be useful when manually selecting corners.

- calibration: is the calibration saved from a video (enter a video to calibrate, if calibration has been done save results in a pickle file)</pre> <div class="fragment"><div class="line"><span class="lineno">  248</span>    <span class="keyword">def </span>define_room(self, width=None, length=None, height=None, offset=[0,0,0,0], corners=None, room_points=None, refine_corners=False, image=None, stitch_videos=None, calibration=None, extend=None):</div>
<div class="line"><span class="lineno">  249</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">        Takes variables and defines a room</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">        - width: and length are in mm</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">        - height: is the assumed height of all objects in the room</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">        - offset: is used when we extend the image to get all of the corners.</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">        NOTE: If arrows do not line up with lines you drew, the camera matrix or the distortion matrix are off</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">        - room_points: are the real-world defined points in mm (if not defined points are the height and width of the room)</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">        - refine_corners: is opencv&#39;s sub-pixel optimizer to better estimate corner locations. This is mostly used in checkerboard calibration but may be useful when manually selecting corners.</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">        - calibration: is the calibration saved from a video (enter a video to calibrate, if calibration has been done save results in a pickle file)</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>        <span class="keywordflow">if</span> width <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  269</span>            self.room_width = width</div>
<div class="line"><span class="lineno">  270</span>        <span class="keywordflow">if</span> length <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  271</span>            self.room_length = length</div>
<div class="line"><span class="lineno">  272</span>        <span class="keywordflow">if</span> height <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  273</span>            self.room_height = height</div>
<div class="line"><span class="lineno">  274</span>        </div>
<div class="line"><span class="lineno">  275</span>        </div>
<div class="line"><span class="lineno">  276</span>        <span class="keywordflow">if</span> calibration <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  277</span>            calibration_path = calibration[:-3] + <span class="stringliteral">&quot;pickle&quot;</span></div>
<div class="line"><span class="lineno">  278</span>            self.load_calibration(calibration_path)</div>
<div class="line"><span class="lineno">  279</span>        </div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>        <span class="comment"># Stitch images takes care of undistortion based on calibration</span></div>
<div class="line"><span class="lineno">  282</span>        <span class="keywordflow">if</span> stitch_videos <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>            self.image, self.stitch_homographies = self.stitch_rooms(stitch_videos, key_index=3)</div>
<div class="line"><span class="lineno">  285</span>            self.show_img = deepcopy(self.image)</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>        </div>
<div class="line"><span class="lineno">  288</span>        <span class="comment"># Undistort images</span></div>
<div class="line"><span class="lineno">  289</span>        self.undistort_room()</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>        <span class="comment"># find extention before selecting points so you do not have to calculate offset</span></div>
<div class="line"><span class="lineno">  292</span>        <span class="comment"># extend is the number of walls you want to extend. Each wall intersection/extention requires 2 walls, 4 estimates each.</span></div>
<div class="line"><span class="lineno">  293</span>        offsets = [0,0,0,0]</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">if</span> extend <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  295</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(extend):</div>
<div class="line"><span class="lineno">  296</span>                intersection = self.find_wall_intersection(degree=1)</div>
<div class="line"><span class="lineno">  297</span>                <span class="comment"># offset = [top, left, bottom, right] in pixels</span></div>
<div class="line"><span class="lineno">  298</span>                self.image, offset = self.extend_image_to_corners(self.image, intersection)</div>
<div class="line"><span class="lineno">  299</span>                self.show_img =self.image</div>
<div class="line"><span class="lineno">  300</span>                <span class="comment"># Offsets are the maximum offset values between all edges</span></div>
<div class="line"><span class="lineno">  301</span>                <span class="keywordflow">for</span> index, value <span class="keywordflow">in</span> enumerate(offset):</div>
<div class="line"><span class="lineno">  302</span>                    <span class="keywordflow">if</span> offsets[index] &lt; value:</div>
<div class="line"><span class="lineno">  303</span>                        offsets[index] = offset[index]</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>        self.image = self.superimpose_checker()</div>
<div class="line"><span class="lineno">  307</span>        self.show_img =self.image</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">if</span> stitch_videos <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  310</span>            self.stitch_trackers(stitch_videos, self.stitch_homographies, offsets)</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>        <span class="comment"># creates a 4 corner room in real coordinates</span></div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordflow">if</span> room_points <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  315</span>            print(<span class="stringliteral">&quot;Choose your points for the defined corners (in order)&quot;</span>)</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>            <span class="comment"># Assign real world coordinates</span></div>
<div class="line"><span class="lineno">  318</span>            self.room_points = room_points</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>            <span class="comment"># Assign a rectangular shape given room points (width and length)</span></div>
<div class="line"><span class="lineno">  321</span>            self.room_width, self.room_length = self.get_room_dimensions(room_points)</div>
<div class="line"><span class="lineno">  322</span>            </div>
<div class="line"><span class="lineno">  323</span>            <span class="comment"># get 2D locations which will map to real world room points</span></div>
<div class="line"><span class="lineno">  324</span>            self.corners = self.get_room_corners(len(room_points))</div>
<div class="line"><span class="lineno">  325</span>            room_points = np.reshape(np.asfarray(room_points), (len(room_points),3,1))</div>
<div class="line"><span class="lineno">  326</span>            self.room_points = room_points</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>            </div>
<div class="line"><span class="lineno">  329</span>        <span class="comment"># </span></div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">elif</span> corners <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  331</span>            <span class="keywordflow">if</span> width == <span class="keywordtype">None</span> <span class="keywordflow">or</span> length == <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  332</span>                room_points, self.corners = self.assign_non_square_corners()</div>
<div class="line"><span class="lineno">  333</span>            </div>
<div class="line"><span class="lineno">  334</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  335</span>                room_points = self.get_room_points(self.room_width, self.room_length)</div>
<div class="line"><span class="lineno">  336</span>                self.corners = self.get_room_corners()</div>
<div class="line"><span class="lineno">  337</span>        </div>
<div class="line"><span class="lineno">  338</span>        print(self.corners)</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>        <span class="comment"># &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>        <span class="keywordflow">if</span> refine_corners:</div>
<div class="line"><span class="lineno">  343</span>            <span class="comment"># assert(image != None)</span></div>
<div class="line"><span class="lineno">  344</span>            <span class="keywordflow">if</span> image <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  345</span>                image = self.image</div>
<div class="line"><span class="lineno">  346</span>            <span class="comment"># Refer to https://docs.opencv.org/3.4/dd/d1a/group__imgproc__feature.html#ga354e0d7c86d0d9da75de9b9701a9a87e</span></div>
<div class="line"><span class="lineno">  347</span>            <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">            W FORSTNER. A fast operator for detection and precise location of distincs points, corners and center of circular features. In Proc. of the Intercommission Conference on Fast Processing of Photogrammetric Data, Interlaken, Switzerland, 1987, pages 281305, 1987.</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">            &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  350</span>            <span class="comment"># maxCorners = max(5000, 1)</span></div>
<div class="line"><span class="lineno">  351</span>            <span class="comment"># # Parameters for Shi-Tomasi algorithm</span></div>
<div class="line"><span class="lineno">  352</span>            <span class="comment"># qualityLevel = 0.01</span></div>
<div class="line"><span class="lineno">  353</span>            <span class="comment"># minDistance = 10</span></div>
<div class="line"><span class="lineno">  354</span>            <span class="comment"># blockSize = 3</span></div>
<div class="line"><span class="lineno">  355</span>            <span class="comment"># gradientSize = 3</span></div>
<div class="line"><span class="lineno">  356</span>            <span class="comment"># useHarrisDetector = False</span></div>
<div class="line"><span class="lineno">  357</span>            <span class="comment"># k = 0.05</span></div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>            src_gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>                <span class="comment"># Apply corner detection</span></div>
<div class="line"><span class="lineno">  362</span>            <span class="comment"># corners = cv2.goodFeaturesToTrack(src_gray, maxCorners, qualityLevel, minDistance, None, \</span></div>
<div class="line"><span class="lineno">  363</span>            <span class="comment">#     blockSize=blockSize, gradientSize=gradientSize, useHarrisDetector=useHarrisDetector, k=k)</span></div>
<div class="line"><span class="lineno">  364</span>            <span class="comment"># Draw corners detected</span></div>
<div class="line"><span class="lineno">  365</span>            <span class="comment"># print(&#39;** Number of corners detected:&#39;, self.corners.shape[0])</span></div>
<div class="line"><span class="lineno">  366</span>            <span class="comment"># radius = 4</span></div>
<div class="line"><span class="lineno">  367</span>            <span class="comment"># for i in range(corners.shape[0]):</span></div>
<div class="line"><span class="lineno">  368</span>            <span class="comment">#     cv2.circle(src_gray, (int(corners[i,0,0]), int(corners[i,0,1])), radius, (rng.randint(0,256), rng.randint(0,256), rng.randint(0,256)), cv2.FILLED)</span></div>
<div class="line"><span class="lineno">  369</span>            </div>
<div class="line"><span class="lineno">  370</span>            <span class="comment"># Set the needed parameters to find the refined corners</span></div>
<div class="line"><span class="lineno">  371</span>            winSize = (5, 5)</div>
<div class="line"><span class="lineno">  372</span>            zeroZone = (-1, -1)</div>
<div class="line"><span class="lineno">  373</span>            criteria = (cv2.TERM_CRITERIA_EPS + cv2.TermCriteria_COUNT, 40, 0.001)</div>
<div class="line"><span class="lineno">  374</span>            <span class="comment"># Calculate the refined corner locations</span></div>
<div class="line"><span class="lineno">  375</span>            src_gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</div>
<div class="line"><span class="lineno">  376</span>            self.corners = cv2.cornerSubPix(src_gray, self.corners, winSize, zeroZone, criteria)</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>            cv2.imshow(<span class="stringliteral">&quot;Corner Detection&quot;</span>, src_gray)</div>
<div class="line"><span class="lineno">  379</span>            cv2.waitKey(0)</div>
<div class="line"><span class="lineno">  380</span>            </div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>        <span class="comment"># print(room_points)</span></div>
<div class="line"><span class="lineno">  383</span>        <span class="comment"># self.corners, room_points = self.assign_non_square_corners()</span></div>
<div class="line"><span class="lineno">  384</span>        <span class="comment"># # Correct for offsets with exteneded image</span></div>
<div class="line"><span class="lineno">  385</span>        <span class="comment"># offset = [top, left, bottom, right]</span></div>
<div class="line"><span class="lineno">  386</span>        <span class="comment"># for index, corner in enumerate(self.corners):</span></div>
<div class="line"><span class="lineno">  387</span>        <span class="comment">#     x,y =self.corners[index]</span></div>
<div class="line"><span class="lineno">  388</span>        <span class="comment">#     self.corners[index] = ((x - offset[1]), (y - offset[0]))</span></div>
<div class="line"><span class="lineno">  389</span>            </div>
<div class="line"><span class="lineno">  390</span>        <span class="comment"># print(room_points)</span></div>
<div class="line"><span class="lineno">  391</span>        <span class="comment"># print(self.corners)</span></div>
<div class="line"><span class="lineno">  392</span>        key = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  393</span>        </div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">while</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  395</span>            test_image = deepcopy(self.image)</div>
<div class="line"><span class="lineno">  396</span>            print(<span class="stringliteral">&quot;Room Dimensions&quot;</span>, self.room_width, self.room_length)</div>
<div class="line"><span class="lineno">  397</span>            room_points = self.get_room_points(self.room_width, self.room_length)</div>
<div class="line"><span class="lineno">  398</span>            <span class="comment">#NOTE This is calculated after distortion is corrected</span></div>
<div class="line"><span class="lineno">  399</span>            <span class="comment"># Because we correct for this, distortion should be &quot;None&quot; as we undistort already. </span></div>
<div class="line"><span class="lineno">  400</span>            <span class="comment"># retval, rvecs, tvecs = cv2.solvePnP(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, self.distioriton_matrix)</span></div>
<div class="line"><span class="lineno">  401</span>            <span class="comment"># retval, rvecs, tvecs = cv2.solvePnP(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, None)</span></div>
<div class="line"><span class="lineno">  402</span>            retval, r1, t1 = cv2.solvePnP(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, <span class="keywordtype">None</span>, cv2.SOLVEPNP_IPPE, useExtrinsicGuess=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  403</span>            retval, r2, t2 = cv2.solvePnP(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, <span class="keywordtype">None</span>, cv2.SOLVEPNP_EPNP, useExtrinsicGuess=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  404</span>            retval, r3, t3 = cv2.solvePnP(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, <span class="keywordtype">None</span>, cv2.SOLVEPNP_ITERATIVE, useExtrinsicGuess=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  405</span>            retval, r4, t4 = cv2.solvePnP(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, <span class="keywordtype">None</span>, cv2.SOLVEPNP_MAX_COUNT, useExtrinsicGuess=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  406</span>            retval, r5, t5 = cv2.solvePnP(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, <span class="keywordtype">None</span>, cv2.SOLVEPNP_UPNP, useExtrinsicGuess=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  407</span>            retval, r1, t1, inliers = cv2.solvePnPRansac(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  408</span>            img1, cube, target_cube = self.draw_cuboid(image=test_image, rvec=r1, tvec=t1)</div>
<div class="line"><span class="lineno">  409</span>            cv2.imshow(<span class="stringliteral">&quot;Iterative Default&quot;</span>, img1)</div>
<div class="line"><span class="lineno">  410</span>            cv2.waitKey(0)</div>
<div class="line"><span class="lineno">  411</span>            <span class="comment"># Returns all solutions</span></div>
<div class="line"><span class="lineno">  412</span>            <span class="comment"># retval, rall, tall, error = cv2.solvePnPGeneric(room_points.astype(np.float64), self.corners.astype(np.float64), self.camera_matrix, None)</span></div>
<div class="line"><span class="lineno">  413</span>            <span class="comment"># for i in range(len(rall)):</span></div>
<div class="line"><span class="lineno">  414</span>                </div>
<div class="line"><span class="lineno">  415</span>            <span class="comment">#     img1, cube, target_cube = self.draw_cuboid(image=test_image, rvec=rall[i], tvec=tall[i])</span></div>
<div class="line"><span class="lineno">  416</span>            <span class="comment">#     cv2.imshow(&quot;Iterative Default&quot;, img1)</span></div>
<div class="line"><span class="lineno">  417</span>            <span class="comment">#     cv2.waitKey(0)</span></div>
<div class="line"><span class="lineno">  418</span>            <span class="comment"># # self.rotation_vector = rvecs</span></div>
<div class="line"><span class="lineno">  419</span>            <span class="comment"># self.translation_vector = tvecs</span></div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;q&#39;</span>):</div>
<div class="line"><span class="lineno">  424</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  425</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;=&#39;</span>):</div>
<div class="line"><span class="lineno">  426</span>                self.room_width += 100</div>
<div class="line"><span class="lineno">  427</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;-&#39;</span>):</div>
<div class="line"><span class="lineno">  428</span>                self.room_width -= 100</div>
<div class="line"><span class="lineno">  429</span>            </div>
<div class="line"><span class="lineno">  430</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;0&#39;</span>):</div>
<div class="line"><span class="lineno">  431</span>                self.room_length += 100</div>
<div class="line"><span class="lineno">  432</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;9&#39;</span>):</div>
<div class="line"><span class="lineno">  433</span>                self.room_length -= 100</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>            point = 0</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;1&#39;</span>):</div>
<div class="line"><span class="lineno">  438</span>                point = 1</div>
<div class="line"><span class="lineno">  439</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;2&#39;</span>):</div>
<div class="line"><span class="lineno">  440</span>                point = 2</div>
<div class="line"><span class="lineno">  441</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;3&#39;</span>):</div>
<div class="line"><span class="lineno">  442</span>                point = 3</div>
<div class="line"><span class="lineno">  443</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;4&#39;</span>):</div>
<div class="line"><span class="lineno">  444</span>                point = 4</div>
<div class="line"><span class="lineno">  445</span>            </div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>            self.set_axis(self.room_width, self.room_height, self.room_length)</div>
<div class="line"><span class="lineno">  448</span>            img1, cube, target_cube = self.draw_cuboid(image=test_image, rvec=r1, tvec=t1)</div>
<div class="line"><span class="lineno">  449</span>            img2, cube, target_cube = self.draw_cuboid(image=test_image, rvec=r2, tvec=t2)</div>
<div class="line"><span class="lineno">  450</span>            img3, cube, target_cube = self.draw_cuboid(image=test_image, rvec=r3, tvec=t3)</div>
<div class="line"><span class="lineno">  451</span>            img4, cube, target_cube = self.draw_cuboid(image=test_image, rvec=r4, tvec=t4)</div>
<div class="line"><span class="lineno">  452</span>            img5, cube, target_cube = self.draw_cuboid(image=test_image, rvec=r5, tvec=t5)</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>            cv2.imshow(<span class="stringliteral">&quot;IPPE&quot;</span>, img1)</div>
<div class="line"><span class="lineno">  455</span>            cv2.imshow(<span class="stringliteral">&quot;EPNP&quot;</span>, img2)</div>
<div class="line"><span class="lineno">  456</span>            cv2.imshow(<span class="stringliteral">&quot;ITERATIVE&quot;</span>, img3)</div>
<div class="line"><span class="lineno">  457</span>            cv2.imshow(<span class="stringliteral">&quot;MAX_COUNT&quot;</span>, img4)</div>
<div class="line"><span class="lineno">  458</span>            cv2.imshow(<span class="stringliteral">&quot;UPNP&quot;</span>, img5)</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>            key = cv2.waitKey(1)</div>
<div class="line"><span class="lineno">  461</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b5abc31dfc859a8bd979479f51da933" name="a5b5abc31dfc859a8bd979479f51da933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b5abc31dfc859a8bd979479f51da933">&#9670;&#160;</a></span>define_sides()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">define_sides </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sides</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lengths</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  245</span>    <span class="keyword">def </span>define_sides(self, sides, lengths):</div>
<div class="line"><span class="lineno">  246</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  247</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acd30d2c67d090d15947b3abde53e876f" name="acd30d2c67d090d15947b3abde53e876f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd30d2c67d090d15947b3abde53e876f">&#9670;&#160;</a></span>display_3D_Plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">display_3D_Plot </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shown</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  755</span>    <span class="keyword">def </span>display_3D_Plot(points, shown):</div>
<div class="line"><span class="lineno">  756</span>        fig = plt.figure()</div>
<div class="line"><span class="lineno">  757</span>        ax = plt.axes(projection=<span class="stringliteral">&#39;3d&#39;</span>)</div>
<div class="line"><span class="lineno">  758</span>        x_data = points[0]</div>
<div class="line"><span class="lineno">  759</span>        y_data = points[1]</div>
<div class="line"><span class="lineno">  760</span>        z_data = points[2]</div>
<div class="line"><span class="lineno">  761</span>        scatter = ax.scatter3D(x_data, y_data,z_data, cmap=<span class="stringliteral">&#39;Greens&#39;</span>)</div>
<div class="line"><span class="lineno">  762</span>        </div>
<div class="line"><span class="lineno">  763</span>        <span class="keywordflow">if</span> shown:</div>
<div class="line"><span class="lineno">  764</span>            fig.canvas.draw()</div>
<div class="line"><span class="lineno">  765</span>            fig.canvas.flush_events()</div>
<div class="line"><span class="lineno">  766</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  767</span>            fig.show()</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a61a9f1d7c10c86838c5928c76bb2ca59" name="a61a9f1d7c10c86838c5928c76bb2ca59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61a9f1d7c10c86838c5928c76bb2ca59">&#9670;&#160;</a></span>display_room()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">display_room </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>box</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>show_3d_plot</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>with_points</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  201</span>    <span class="keyword">def </span>display_room(self, image=None, axis=True, box=True, show_3d_plot=True,  with_points=False):</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">while</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  203</span>            </div>
<div class="line"><span class="lineno">  204</span>            <span class="comment"># self.draw_vector()</span></div>
<div class="line"><span class="lineno">  205</span>            <span class="keywordflow">if</span> axis:</div>
<div class="line"><span class="lineno">  206</span>                self.draw_axis()</div>
<div class="line"><span class="lineno">  207</span>            </div>
<div class="line"><span class="lineno">  208</span>            <span class="keywordflow">if</span> box:</div>
<div class="line"><span class="lineno">  209</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  210</span>                    self.draw_box()</div>
<div class="line"><span class="lineno">  211</span>                <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno">  212</span>                    <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>            <span class="comment"># if show_3d_plot:</span></div>
<div class="line"><span class="lineno">  215</span>            <span class="comment">#     self.show_3D_plot()</span></div>
<div class="line"><span class="lineno">  216</span>            <span class="keywordflow">if</span> image <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  217</span>                print(<span class="stringliteral">&quot;Show img&quot;</span>)</div>
<div class="line"><span class="lineno">  218</span>                cv2.imshow(self.window_name, image)</div>
<div class="line"><span class="lineno">  219</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  220</span>                cv2.imshow(self.window_name, self.show_img)</div>
<div class="line"><span class="lineno">  221</span>            key = cv2.waitKey(1)</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&#39;c&#39;</span>):</div>
<div class="line"><span class="lineno">  224</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  225</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b52f7921f3d60a3a6b7d2dc641aa44c" name="a6b52f7921f3d60a3a6b7d2dc641aa44c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b52f7921f3d60a3a6b7d2dc641aa44c">&#9670;&#160;</a></span>draw_axis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">draw_axis </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  770</span>    <span class="keyword">def </span>draw_axis(self):</div>
<div class="line"><span class="lineno">  771</span>        </div>
<div class="line"><span class="lineno">  772</span>        projected, jac = cv2.projectPoints(self.axis, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno">  773</span>        corner = tuple(self.corners[0].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  774</span>        corner2 = tuple(projected[0].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  775</span>        corner3 = tuple(projected[1].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  776</span>        corner4 = tuple(projected[2].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  777</span>        </div>
<div class="line"><span class="lineno">  778</span>        cv2.putText(self.show_img,<span class="stringliteral">&quot;x&quot;</span>,corner2,fontFace=cv2.FONT_HERSHEY_PLAIN,fontScale=2, color=(255,0,0))</div>
<div class="line"><span class="lineno">  779</span>        cv2.putText(self.show_img,<span class="stringliteral">&quot;y&quot;</span>,corner4,fontFace=cv2.FONT_HERSHEY_PLAIN,fontScale=2, color=(0,255,0))</div>
<div class="line"><span class="lineno">  780</span>        cv2.putText(self.show_img,<span class="stringliteral">&quot;z&quot;</span>,corner3,fontFace=cv2.FONT_HERSHEY_PLAIN,fontScale=2, color=(0,0,255))</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>        self.show_img = cv2.arrowedLine(self.show_img, corner, corner2, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  783</span>        self.show_img = cv2.arrowedLine(self.show_img, corner, corner4, (0,255,0), 2)</div>
<div class="line"><span class="lineno">  784</span>        self.show_img = cv2.arrowedLine(self.show_img, corner, corner3, (0,0,255), 2)</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>        <span class="keywordflow">return</span> self.show_img</div>
<div class="line"><span class="lineno">  787</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a8277f150767e58ce0824de54928fb184">room_estimation.get_3d_to_2d()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a6b52f7921f3d60a3a6b7d2dc641aa44c_icgraph.png" border="0" usemap="#aa00206_a6b52f7921f3d60a3a6b7d2dc641aa44c_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a07baa9eba436c81cea0c49e0d5b5099f" name="a07baa9eba436c81cea0c49e0d5b5099f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07baa9eba436c81cea0c49e0d5b5099f">&#9670;&#160;</a></span>draw_box()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">draw_box </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corners</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>imgpts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  874</span>    <span class="keyword">def </span>draw_box(img, corners, imgpts):</div>
<div class="line"><span class="lineno">  875</span>        imgpts = np.int32(imgpts).reshape(-1,2)</div>
<div class="line"><span class="lineno">  876</span>        <span class="comment"># draw ground floor in green</span></div>
<div class="line"><span class="lineno">  877</span>        img = cv2.drawContours(img, [imgpts[:4]],-1,(0,255,0),-3)</div>
<div class="line"><span class="lineno">  878</span>        <span class="comment"># draw pillars in blue color</span></div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>        <span class="keywordflow">for</span> i,j <span class="keywordflow">in</span> zip(range(4),range(4,8)):</div>
<div class="line"><span class="lineno">  881</span>            img = cv2.line(img, tuple(imgpts[i]), tuple(imgpts[j]),(255),3)</div>
<div class="line"><span class="lineno">  882</span>        <span class="comment"># draw top layer in red color</span></div>
<div class="line"><span class="lineno">  883</span>        img = cv2.drawContours(img, [imgpts[4:]],-1,(0,0,255),3)</div>
<div class="line"><span class="lineno">  884</span>        <span class="keywordflow">return</span> img</div>
<div class="line"><span class="lineno">  885</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aef4827bfb173a05c4794fb8b29ec8055" name="aef4827bfb173a05c4794fb8b29ec8055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4827bfb173a05c4794fb8b29ec8055">&#9670;&#160;</a></span>draw_cuboid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">draw_cuboid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distortion</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rvec</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tvec</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Distortion is removed if image is undistorted.
    Rvec and Tvec are transformation vectors calculated by previous SolvePNP, so we use that if we have alerady done so.
    6        7
   *--------*
 / |       /|
2 *---------*3|
|  * 5    | *8
| /       |/
1 *---------*4</pre> <div class="fragment"><div class="line"><span class="lineno">  788</span>    <span class="keyword">def </span>draw_cuboid(self, image=None, distortion=None, rvec=None, tvec=None):</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>        <span class="stringliteral">&#39;&#39;&#39;  </span></div>
<div class="line"><span class="lineno">  791</span><span class="stringliteral">            Distortion is removed if image is undistorted.</span></div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral">            Rvec and Tvec are transformation vectors calculated by previous SolvePNP, so we use that if we have alerady done so.</span></div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">            6        7</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral">           *--------*</span></div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral">         / |       /|</span></div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">      2 *---------*3|</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">        |  * 5    | *8</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral">        | /       |/</span></div>
<div class="line"><span class="lineno">  799</span><span class="stringliteral">      1 *---------*4</span></div>
<div class="line"><span class="lineno">  800</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  801</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>        cube = np.float32([ [0,0,0], <span class="comment">#1</span></div>
<div class="line"><span class="lineno">  804</span>                            [0,0,self.room_height], <span class="comment">#2 Y</span></div>
<div class="line"><span class="lineno">  805</span>                            [self.room_width,0,self.room_height], <span class="comment"># 3</span></div>
<div class="line"><span class="lineno">  806</span>                            [self.room_width,0,0], <span class="comment">#4 X</span></div>
<div class="line"><span class="lineno">  807</span> </div>
<div class="line"><span class="lineno">  808</span>                            [0,self.room_length,0],</div>
<div class="line"><span class="lineno">  809</span>                            [0,self.room_length,self.room_height],</div>
<div class="line"><span class="lineno">  810</span>                            [self.room_width,self.room_length,self.room_height],</div>
<div class="line"><span class="lineno">  811</span>                            [self.room_width,self.room_length,0]</div>
<div class="line"><span class="lineno">  812</span>                            </div>
<div class="line"><span class="lineno">  813</span>                            ]).reshape(-1,3)</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>        <span class="comment"># retval, rvecs, tvecs, inliers = cv2.solvePnPRansac(cube.astype(np.float64), selected_2d.astype(np.float64), self.camera_matrix, distortion, rvec=rvec, tvec=tvec)</span></div>
<div class="line"><span class="lineno">  816</span>        <span class="comment"># rvecs, tvecs = [None, None]</span></div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>        <span class="comment"># try:</span></div>
<div class="line"><span class="lineno">  820</span>        <span class="comment">#     if distortion:</span></div>
<div class="line"><span class="lineno">  821</span>        <span class="comment">#         retval, rvecs, tvecs = cv2.solvePnP(points.astype(np.float64), corners.astype(np.float64), self.camera_matrix, self.distioriton_matrix)</span></div>
<div class="line"><span class="lineno">  822</span>        <span class="comment">#     else:</span></div>
<div class="line"><span class="lineno">  823</span>        <span class="comment">#         retval, rvecs, tvecs =cv2.solvePnP(points.astype(np.float64), corners.astype(np.float64), self.camera_matrix, self.distioriton_matrix)</span></div>
<div class="line"><span class="lineno">  824</span>        <span class="comment"># except:</span></div>
<div class="line"><span class="lineno">  825</span>        <span class="comment">#     try:</span></div>
<div class="line"><span class="lineno">  826</span>        <span class="comment">#         corners = np.reshape(np.asfarray(self.corners), (len(self.corners),2,1))</span></div>
<div class="line"><span class="lineno">  827</span>        <span class="comment">#         retval, rvecs, tvecs = cv2.solvePnP(self.room_points.astype(np.float64), corners.astype(np.float64), self.camera_matrix, self.distioriton_matrix)</span></div>
<div class="line"><span class="lineno">  828</span>        <span class="comment">#     except:</span></div>
<div class="line"><span class="lineno">  829</span>        <span class="comment">#         corners = np.reshape(np.asfarray(self.corners), (len(self.corners),2,1))</span></div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>        <span class="comment">#         points = self.get_n_room_points(self.room_points[:corners.shape[0]])</span></div>
<div class="line"><span class="lineno">  832</span>        <span class="comment">#         retval, rvecs, tvecs = cv2.solvePnP(points.astype(np.float64), corners.astype(np.float64), self.camera_matrix, self.distioriton_matrix)</span></div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span>                </div>
<div class="line"><span class="lineno">  835</span>        projected, jac = cv2.projectPoints(cube, rvec, tvec, self.camera_matrix, distortion)</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>        </div>
<div class="line"><span class="lineno">  839</span>        corner1 = tuple(projected[0].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  840</span>        corner2 = tuple(projected[1].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  841</span>        corner3 = tuple(projected[2].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  842</span>        corner4 = tuple(projected[3].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  843</span>        corner5 = tuple(projected[4].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  844</span>        corner6 = tuple(projected[5].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  845</span>        corner7 = tuple(projected[6].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  846</span>        corner8 = tuple(projected[7].ravel().astype(<span class="stringliteral">&#39;int32&#39;</span>))</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>        projected_cube = [corner1, corner2, corner3, corner4, corner5, corner6, corner7, corner8]</div>
<div class="line"><span class="lineno">  849</span>        </div>
<div class="line"><span class="lineno">  850</span>        <span class="keywordflow">if</span> image <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  851</span>            image = self.show_img</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>        cv2.putText(image,<span class="stringliteral">&quot;x&quot;</span>,corner4,fontFace=cv2.FONT_HERSHEY_PLAIN,fontScale=2, color=(255,25,200))</div>
<div class="line"><span class="lineno">  854</span>        cv2.putText(image,<span class="stringliteral">&quot;y&quot;</span>,corner2,fontFace=cv2.FONT_HERSHEY_PLAIN,fontScale=2, color=(0,255,0))</div>
<div class="line"><span class="lineno">  855</span>        cv2.putText(image,<span class="stringliteral">&quot;z&quot;</span>,corner5,fontFace=cv2.FONT_HERSHEY_PLAIN,fontScale=2, color=(0,0,255))</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>        image = cv2.line(image, corner1, corner2, (0,255,0), 2) <span class="comment"># Y</span></div>
<div class="line"><span class="lineno">  858</span>        image = cv2.line(image, corner2, corner3, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  859</span>        image = cv2.line(image, corner3, corner4, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  860</span>        image = cv2.line(image, corner1, corner4, (255,25,200), 2) <span class="comment">#X</span></div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>        image = cv2.line(image, corner5, corner6, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  863</span>        image = cv2.line(image, corner6, corner7, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  864</span>        image = cv2.line(image, corner7, corner8, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  865</span>        image = cv2.line(image, corner8, corner5, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>        image = cv2.line(image, corner1, corner5, (0,0,255), 2) <span class="comment">#Z</span></div>
<div class="line"><span class="lineno">  868</span>        image = cv2.line(image, corner2, corner6, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  869</span>        image = cv2.line(image, corner3, corner7, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  870</span>        image = cv2.line(image, corner4, corner8, (255,0,0), 2)</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>        <span class="keywordflow">return</span> image, cube, projected_cube</div>
<div class="line"><span class="lineno">  873</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.ax, room_estimation.back_plt, room_estimation.camera_matrix, room_estimation.distioriton_matrix, room_estimation.fig, room_estimation.float_plt, room_estimation.front_plt, room_estimation.line_plt, room_estimation.mapped, room_estimation.mapped_dictionary, room_estimation.points_plt, room_estimation.quiver, room_estimation.room_height, room_estimation.room_length, room_estimation.room_width, room_estimation.rotation_vector, room_estimation.show_3D_plot, room_estimation.show_img, room_estimation.translation_vector, room_estimation.vector_depth, and room_estimation.window_name.</p>

</div>
</div>
<a id="ab20e46a19ec3f0b9c7fd04d2264ba8a1" name="ab20e46a19ec3f0b9c7fd04d2264ba8a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab20e46a19ec3f0b9c7fd04d2264ba8a1">&#9670;&#160;</a></span>draw_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">draw_grid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>grid_shape</em> = <code>(20,20)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>color</em> = <code>(255,&#160;255,&#160;255)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thickness</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2704</span>    <span class="keyword">def </span>draw_grid(self, grid_shape=(20,20), color=(255, 255, 255), thickness=2):</div>
<div class="line"><span class="lineno"> 2705</span>        h = 1080</div>
<div class="line"><span class="lineno"> 2706</span>        w = 1080</div>
<div class="line"><span class="lineno"> 2707</span>        <span class="comment"># h, w, _ = img.shape</span></div>
<div class="line"><span class="lineno"> 2708</span>        img = np.zeros((h, w, 3), dtype = <span class="stringliteral">&quot;uint8&quot;</span>)</div>
<div class="line"><span class="lineno"> 2709</span>        rows, cols = grid_shape</div>
<div class="line"><span class="lineno"> 2710</span>        dy, dx = h / rows, w / cols</div>
<div class="line"><span class="lineno"> 2711</span> </div>
<div class="line"><span class="lineno"> 2712</span> </div>
<div class="line"><span class="lineno"> 2713</span>        <span class="comment"># draw vertical lines</span></div>
<div class="line"><span class="lineno"> 2714</span>        <span class="keywordflow">for</span> index, x <span class="keywordflow">in</span> enumerate(np.linspace(start=dx, stop=w-dx, num=cols-1)):</div>
<div class="line"><span class="lineno"> 2715</span>            <span class="keywordflow">if</span> index == (cols-1)/2:</div>
<div class="line"><span class="lineno"> 2716</span>                x = int(round(x))</div>
<div class="line"><span class="lineno"> 2717</span>                img = cv2.line(img, (x, 0), (x, h), color=(255,0,255), thickness=7)</div>
<div class="line"><span class="lineno"> 2718</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2719</span>                x = int(round(x))</div>
<div class="line"><span class="lineno"> 2720</span>                img = cv2.line(img, (x, 0), (x, h), color=color, thickness=thickness)</div>
<div class="line"><span class="lineno"> 2721</span> </div>
<div class="line"><span class="lineno"> 2722</span>        <span class="comment"># draw horizontal lines</span></div>
<div class="line"><span class="lineno"> 2723</span>        <span class="keywordflow">for</span> index, y <span class="keywordflow">in</span> enumerate(np.linspace(start=dy, stop=h-dy, num=rows-1)):</div>
<div class="line"><span class="lineno"> 2724</span>            <span class="keywordflow">if</span> index == (rows-1)/2:</div>
<div class="line"><span class="lineno"> 2725</span>                y = int(round(y))</div>
<div class="line"><span class="lineno"> 2726</span>                img = cv2.line(img, (0, y), (w, y), color=(255,0,255), thickness=7)</div>
<div class="line"><span class="lineno"> 2727</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2728</span>                y = int(round(y))</div>
<div class="line"><span class="lineno"> 2729</span>                img = cv2.line(img, (0, y), (w, y), color=color, thickness=thickness)</div>
<div class="line"><span class="lineno"> 2730</span> </div>
<div class="line"><span class="lineno"> 2731</span>        <span class="keywordflow">return</span> img</div>
<div class="line"><span class="lineno"> 2732</span> </div>
<div class="line"><span class="lineno"> 2733</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#abeac4cbae89aef891cee148cbbbc6232">room_estimation.superimpose_checker()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_ab20e46a19ec3f0b9c7fd04d2264ba8a1_icgraph.png" border="0" usemap="#aa00206_ab20e46a19ec3f0b9c7fd04d2264ba8a1_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a9efcb6eeef35186ade72c0bbc5c531fe" name="a9efcb6eeef35186ade72c0bbc5c531fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9efcb6eeef35186ade72c0bbc5c531fe">&#9670;&#160;</a></span>draw_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">draw_point </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>front_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>back_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  886</span>    <span class="keyword">def </span>draw_point(self, img, front_pt, back_pt):</div>
<div class="line"><span class="lineno">  887</span>        img = cv2.circle(img, front_pt, 8,(125,0,125),2,0)</div>
<div class="line"><span class="lineno">  888</span>        img = cv2.drawMarker(img, back_pt, color=(255,255,0),markerType=1)</div>
<div class="line"><span class="lineno">  889</span>        img = cv2.line(img,front_pt, back_pt, (100,100,0), 2)</div>
<div class="line"><span class="lineno">  890</span>        img = cv2.circle(img, front_pt, 8,(255,255,0),2,0)</div>
<div class="line"><span class="lineno">  891</span>        <span class="keywordflow">return</span> img</div>
<div class="line"><span class="lineno">  892</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a77a48d83bb7e61c5a28680a2de16c11c" name="a77a48d83bb7e61c5a28680a2de16c11c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a48d83bb7e61c5a28680a2de16c11c">&#9670;&#160;</a></span>draw_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">draw_vector </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  912</span>    <span class="keyword">def </span>draw_vector(self,event,x,y,flags,params):</div>
<div class="line"><span class="lineno">  913</span>        <span class="comment"># self.show_img = self.img_copy()</span></div>
<div class="line"><span class="lineno">  914</span>        values = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  915</span>        x_list = []</div>
<div class="line"><span class="lineno">  916</span>        y_list = []</div>
<div class="line"><span class="lineno">  917</span>        z_list = []</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>        <span class="keywordflow">if</span> event == 10:</div>
<div class="line"><span class="lineno">  920</span>            <span class="comment">#sign of the flag shows direction of mousewheel</span></div>
<div class="line"><span class="lineno">  921</span>            <span class="keywordflow">if</span> flags &gt; 0:</div>
<div class="line"><span class="lineno">  922</span>                self.vector_depth += 10</div>
<div class="line"><span class="lineno">  923</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  924</span>                self.vector_depth -= 10</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span>        front_point = np.float32([[x,0,y]])</div>
<div class="line"><span class="lineno">  928</span>        </div>
<div class="line"><span class="lineno">  929</span>        front, jac = cv2.projectPoints(front_point, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>        back_point = np.float32([[x,self.room_length,y]])</div>
<div class="line"><span class="lineno">  932</span>        back, jac = cv2.projectPoints(back_point,self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno">  933</span> </div>
<div class="line"><span class="lineno">  934</span>        floater_point = np.float32([[x, self.vector_depth, y]])</div>
<div class="line"><span class="lineno">  935</span>        floater, jac = cv2.projectPoints(floater_point, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno">  936</span> </div>
<div class="line"><span class="lineno">  937</span>        <span class="comment"># print(x,y)</span></div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>        front_point = (front[0][0][0],front[0][0][1])</div>
<div class="line"><span class="lineno">  940</span>        back_point = (back[0][0][0],back[0][0][1])</div>
<div class="line"><span class="lineno">  941</span>        floater_point = (floater[0][0][0],floater[0][0][1])</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>        self.show_img = cv2.circle(self.show_img, front_point, 8,(125,0,125),2,0)</div>
<div class="line"><span class="lineno">  945</span>        self.show_img = cv2.drawMarker(self.show_img, back_point, color=(255,255,0),markerType=1)</div>
<div class="line"><span class="lineno">  946</span>        self.show_img = cv2.line(self.show_img,front_point, back_point, (100,100,0), 2)</div>
<div class="line"><span class="lineno">  947</span>        self.show_img = cv2.circle(self.show_img, front_point, 8,(255,255,0),2,0)</div>
<div class="line"><span class="lineno">  948</span>        self.show_img = cv2.circle(self.show_img, floater_point, 8,(255,0,0),2,0)</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>        ifp = (int(front_point[0]), int(front_point[1]))</div>
<div class="line"><span class="lineno">  951</span>        <span class="keywordflow">if</span> (x,y) <span class="keywordflow">in</span> self.mapped_dictionary.keys():</div>
<div class="line"><span class="lineno">  952</span>            values = self.mapped_dictionary[(x,y)]</div>
<div class="line"><span class="lineno">  953</span>            <span class="keywordflow">for</span> v <span class="keywordflow">in</span> values:</div>
<div class="line"><span class="lineno">  954</span>                self.show_img = cv2.drawMarker(self.show_img, (x,y), color=(0,0,255),markerType=3)</div>
<div class="line"><span class="lineno">  955</span>                x_list = []</div>
<div class="line"><span class="lineno">  956</span>                y_list = []</div>
<div class="line"><span class="lineno">  957</span>                z_list = []</div>
<div class="line"><span class="lineno">  958</span>                <span class="keywordflow">for</span> v <span class="keywordflow">in</span> values:</div>
<div class="line"><span class="lineno">  959</span>                    x_list.append(v[0])</div>
<div class="line"><span class="lineno">  960</span>                    y_list.append(v[2])</div>
<div class="line"><span class="lineno">  961</span>                    z_list.append(v[1])</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span>        cv2.imshow(self.window_name,self.show_img)</div>
<div class="line"><span class="lineno">  964</span>        cv2.waitKey(1)</div>
<div class="line"><span class="lineno">  965</span>        <span class="keywordflow">if</span> self.show_3D_plot == <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  966</span>            plt.ion</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>            <span class="keywordflow">if</span> self.fig <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  970</span>                self.fig = plt.figure(1)</div>
<div class="line"><span class="lineno">  971</span>                self.ax = ax = plt.axes(projection=<span class="stringliteral">&#39;3d&#39;</span>)</div>
<div class="line"><span class="lineno">  972</span>                self.front_plt = ax.scatter3D(front_point[0], front_point[1], 0)</div>
<div class="line"><span class="lineno">  973</span>                self.back_plt = ax.scatter3D(back_point[0],back_point[1], self.vector_depth)</div>
<div class="line"><span class="lineno">  974</span>                self.float_plt = ax.scatter3D(floater_point[0],floater_point[1],self.vector_depth)</div>
<div class="line"><span class="lineno">  975</span>                self.line_plt = ax.plot3D([front_point[0],back_point[0]], [front_point[1],back_point[1]], [0,self.room_length], color=<span class="stringliteral">&#39;teal&#39;</span>)</div>
<div class="line"><span class="lineno">  976</span>                </div>
<div class="line"><span class="lineno">  977</span>                <span class="comment"># plt.quiver(*origin, V[:,0], V[:,1], color=[&#39;r&#39;,&#39;b&#39;,&#39;g&#39;], scale=21)</span></div>
<div class="line"><span class="lineno">  978</span>                self.ax.set_xlim(-self.room_width,self.room_width)</div>
<div class="line"><span class="lineno">  979</span>                self.ax.set_ylim(-self.room_height,self.room_width)</div>
<div class="line"><span class="lineno">  980</span>                self.ax.set_zlim(-self.room_length,self.room_width)</div>
<div class="line"><span class="lineno">  981</span>                self.fig.canvas.draw()</div>
<div class="line"><span class="lineno">  982</span>                self.fig.canvas.flush_events()</div>
<div class="line"><span class="lineno">  983</span>                self.fig.show()</div>
<div class="line"><span class="lineno">  984</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  985</span> </div>
<div class="line"><span class="lineno">  986</span>                </div>
<div class="line"><span class="lineno">  987</span>                </div>
<div class="line"><span class="lineno">  988</span>                self.ax.cla()</div>
<div class="line"><span class="lineno">  989</span>                <span class="keywordflow">if</span> values:</div>
<div class="line"><span class="lineno">  990</span>                    self.points_plt = self.ax.scatter3D(x_list,y_list,z_list, marker=<span class="stringliteral">&quot;D&quot;</span>, color=<span class="stringliteral">&quot;red&quot;</span>)</div>
<div class="line"><span class="lineno">  991</span>                <span class="comment"># plt.quiver((0,0,0), (0,1,0), , color=[&#39;r&#39;,&#39;b&#39;,&#39;g&#39;], scale=21)</span></div>
<div class="line"><span class="lineno">  992</span>                self.ax.set_xlim(-self.room_width,self.room_width)</div>
<div class="line"><span class="lineno">  993</span>                self.ax.set_ylim(-self.room_height,self.room_width)</div>
<div class="line"><span class="lineno">  994</span>                self.ax.set_zlim(-self.room_length,self.room_width)</div>
<div class="line"><span class="lineno">  995</span>                self.ax.set_xlabel(<span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><span class="lineno">  996</span>                self.ax.set_ylabel(<span class="stringliteral">&quot;Y&quot;</span>)</div>
<div class="line"><span class="lineno">  997</span>                self.ax.set_zlabel(<span class="stringliteral">&quot;Z&quot;</span>)</div>
<div class="line"><span class="lineno">  998</span>                self.float_plt = self.ax.scatter3D(floater_point[0],floater_point[1],self.vector_depth, marker=<span class="stringliteral">&quot;o&quot;</span>, color=<span class="stringliteral">&quot;blue&quot;</span>)</div>
<div class="line"><span class="lineno">  999</span>                self.front_plt = self.ax.scatter3D(front_point[0], front_point[1], 0, marker=(<span class="stringliteral">&quot;o&quot;</span>), color=<span class="stringliteral">&quot;cyan&quot;</span>)</div>
<div class="line"><span class="lineno"> 1000</span>                self.back_plt = self.ax.scatter3D(back_point[0],back_point[1], self.room_length, marker=<span class="stringliteral">&quot;x&quot;</span>, color=<span class="stringliteral">&quot;cyan&quot;</span>)</div>
<div class="line"><span class="lineno"> 1001</span>                self.line_plt = self.ax.plot3D([front_point[0],back_point[0]], [front_point[1],back_point[1]], [0,self.room_length], color=<span class="stringliteral">&#39;teal&#39;</span>)</div>
<div class="line"><span class="lineno"> 1002</span>                self.quiver = self.ax.quiver([0,0,0], [0,0,0], [0,0,0], [self.room_width,0,0], [0,self.room_height,0], [0,0,self.room_length], length=0.1, normalize=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1003</span>                self.fig.canvas.draw()</div>
<div class="line"><span class="lineno"> 1004</span>                self.fig.canvas.flush_events()</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>        <span class="keywordflow">return</span> self.show_img</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e02ad6d52be2fc94cd6f1663ecac18d" name="a5e02ad6d52be2fc94cd6f1663ecac18d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e02ad6d52be2fc94cd6f1663ecac18d">&#9670;&#160;</a></span>edit_room_corner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">edit_room_corner </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>new_pixel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  501</span>    <span class="keyword">def </span>edit_room_corner(self, index, new_pixel):</div>
<div class="line"><span class="lineno">  502</span>        self.corners[index][0] = new_pixel[0]</div>
<div class="line"><span class="lineno">  503</span>        self.corners[index][1] = new_pixel[1]</div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordflow">return</span> self.corners</div>
<div class="line"><span class="lineno">  505</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b5b618d6f1cc697a5191f0617a9200a" name="a3b5b618d6f1cc697a5191f0617a9200a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b5b618d6f1cc697a5191f0617a9200a">&#9670;&#160;</a></span>estimate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">estimate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Depreciated...

NOTE: define room first

This defines room limits and projects 3D points onto the screen
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1432</span>    <span class="keyword">def </span>estimate(self):</div>
<div class="line"><span class="lineno"> 1433</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1434</span><span class="stringliteral">        Depreciated...</span></div>
<div class="line"><span class="lineno"> 1435</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1436</span><span class="stringliteral">        NOTE: define room first</span></div>
<div class="line"><span class="lineno"> 1437</span><span class="stringliteral">        </span></div>
<div class="line"><span class="lineno"> 1438</span><span class="stringliteral">        This defines room limits and projects 3D points onto the screen</span></div>
<div class="line"><span class="lineno"> 1439</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1440</span>        print(<span class="stringliteral">&quot;Finding Limits...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1441</span>        limits, _ = self.find_3d_limits()</div>
<div class="line"><span class="lineno"> 1442</span>        print(<span class="stringliteral">&quot;Limits found...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>        print(<span class="stringliteral">&quot;Estimating 3D space within limits...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1445</span>        self.get_room_3d(limits, height=self.room_height, step=2)</div>
<div class="line"><span class="lineno"> 1446</span>        print(<span class="stringliteral">&quot;Estimation complete..&quot;</span>)</div>
<div class="line"><span class="lineno"> 1447</span> </div>
<div class="line"><span class="lineno"> 1448</span>        cv2.imshow(<span class="stringliteral">&quot;Points&quot;</span>, self.show_img)</div>
<div class="line"><span class="lineno"> 1449</span>        cv2.setMouseCallback(<span class="stringliteral">&#39;Points&#39;</span>, self.get_depth)</div>
<div class="line"><span class="lineno"> 1450</span>        cv2.waitKey(0)</div>
<div class="line"><span class="lineno"> 1451</span>    </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.find_3d_limits(), <a class="el" href="a00206.html#a8113e0511b9bcb908b6a9aee98cee69b">room_estimation.get_depth()</a>, room_estimation.get_depth, room_estimation.get_room_3d(), room_estimation.room_height, and room_estimation.show_img.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a3b5b618d6f1cc697a5191f0617a9200a_cgraph.png" border="0" usemap="#aa00206_a3b5b618d6f1cc697a5191f0617a9200a_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a557b4ac632e812552cc251f7b57b6a6e" name="a557b4ac632e812552cc251f7b57b6a6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a557b4ac632e812552cc251f7b57b6a6e">&#9670;&#160;</a></span>estimate_plane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">estimate_plane </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corners</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>calibration_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distortion_matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  893</span>    <span class="keyword">def </span>estimate_plane(img, corners, points, calibration_matrix, distortion_matrix):</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>        criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 30, 0.001)</div>
<div class="line"><span class="lineno">  896</span>        objp = np.zeros((6*7,3), np.float32)</div>
<div class="line"><span class="lineno">  897</span>        objp[:,:2] = np.mgrid[0:7,0:6].T.reshape(-1,2)</div>
<div class="line"><span class="lineno">  898</span>        </div>
<div class="line"><span class="lineno">  899</span>        axis = np.array([[3,0,0], [0,3,0], [0,0,-3]],dtype=np.float32).reshape(-1,3)</div>
<div class="line"><span class="lineno">  900</span>        </div>
<div class="line"><span class="lineno">  901</span>        corners2 = cv2.cornerSubPix(img,corners,(11,11),(-1,-1),criteria)</div>
<div class="line"><span class="lineno">  902</span>        <span class="comment"># Find the rotation and translation vectors.</span></div>
<div class="line"><span class="lineno">  903</span>        ret, rvecs, tvecs = cv2.solvePnPRansac(objp, corners2, calibration_matrix, distortion_matrix)</div>
<div class="line"><span class="lineno">  904</span>        </div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>        print(<span class="stringliteral">&quot;CalibRVEC:&quot;</span>, rvecs, <span class="stringliteral">&quot;CALIBTVEC&quot;</span>, tvecs)</div>
<div class="line"><span class="lineno">  907</span>        <span class="comment"># project 3D points to image plane</span></div>
<div class="line"><span class="lineno">  908</span>        imgpts, jac = cv2.projectPoints(axis, rvecs, tvecs, calibration_matrix, distortion_matrix)</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>        <span class="keywordflow">return</span> imgpts, jac</div>
<div class="line"><span class="lineno">  911</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1eaebbb5317d01c6bbd133cf98a4d30" name="ad1eaebbb5317d01c6bbd133cf98a4d30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1eaebbb5317d01c6bbd133cf98a4d30">&#9670;&#160;</a></span>evaluate_calibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">evaluate_calibration </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2324</span>    <span class="keyword">def </span>evaluate_calibration(self):</div>
<div class="line"><span class="lineno"> 2325</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 2326</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e21d867efbc8b743664f8b6f41d1b8e" name="a2e21d867efbc8b743664f8b6f41d1b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e21d867efbc8b743664f8b6f41d1b8e">&#9670;&#160;</a></span>extend_image_to_corners()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">extend_image_to_corners </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corners</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">extends the image with black until corners are visible.

Returns new image as well as the amount extended and on which sides. This is useful for transforming datapoints.

offset = [top, left, bottom, right] in pixels
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2263</span>    <span class="keyword">def </span>extend_image_to_corners(self, image, corners):</div>
<div class="line"><span class="lineno"> 2264</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2265</span><span class="stringliteral">        extends the image with black until corners are visible.</span></div>
<div class="line"><span class="lineno"> 2266</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2267</span><span class="stringliteral">        Returns new image as well as the amount extended and on which sides. This is useful for transforming datapoints.</span></div>
<div class="line"><span class="lineno"> 2268</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2269</span><span class="stringliteral">        offset = [top, left, bottom, right] in pixels</span></div>
<div class="line"><span class="lineno"> 2270</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2271</span>        min_x = 0</div>
<div class="line"><span class="lineno"> 2272</span>        min_y = 0</div>
<div class="line"><span class="lineno"> 2273</span>        max_x = 0</div>
<div class="line"><span class="lineno"> 2274</span>        max_y = 0</div>
<div class="line"><span class="lineno"> 2275</span> </div>
<div class="line"><span class="lineno"> 2276</span>        <span class="keywordflow">for</span> corner <span class="keywordflow">in</span> corners:</div>
<div class="line"><span class="lineno"> 2277</span>            <span class="keywordflow">if</span> corner[0] &lt; min_x:</div>
<div class="line"><span class="lineno"> 2278</span>                min_x = corner[0]</div>
<div class="line"><span class="lineno"> 2279</span>            <span class="keywordflow">if</span> corner[1] &lt; min_y:</div>
<div class="line"><span class="lineno"> 2280</span>                min_y = corner[1]</div>
<div class="line"><span class="lineno"> 2281</span>            <span class="keywordflow">if</span> corner[0] &gt; max_x:</div>
<div class="line"><span class="lineno"> 2282</span>                max_x = corner[0]</div>
<div class="line"><span class="lineno"> 2283</span>            <span class="keywordflow">if</span> corner[1] &gt; max_y:</div>
<div class="line"><span class="lineno"> 2284</span>                max_y = corner[1]</div>
<div class="line"><span class="lineno"> 2285</span> </div>
<div class="line"><span class="lineno"> 2286</span>        <span class="keywordflow">if</span> max_y &lt; image.shape[0]:</div>
<div class="line"><span class="lineno"> 2287</span>            max_y = image.shape[0]</div>
<div class="line"><span class="lineno"> 2288</span>        <span class="keywordflow">if</span> max_x &lt; image.shape[1]:</div>
<div class="line"><span class="lineno"> 2289</span>            max_x = image.shape[1]</div>
<div class="line"><span class="lineno"> 2290</span> </div>
<div class="line"><span class="lineno"> 2291</span>        offset = (abs(int(min_y)), abs(int(min_x)), abs(int(max_y - image.shape[0])), abs(int(max_x - image.shape[1])))</div>
<div class="line"><span class="lineno"> 2292</span>        image = cv2.copyMakeBorder(image, top=offset[0], left=offset[1], bottom=offset[2], right=offset[3], borderType=0)</div>
<div class="line"><span class="lineno"> 2293</span>        </div>
<div class="line"><span class="lineno"> 2294</span> </div>
<div class="line"><span class="lineno"> 2295</span>        <span class="keywordflow">for</span> corner_1 <span class="keywordflow">in</span> corners:</div>
<div class="line"><span class="lineno"> 2296</span>            p1 = (int(corner_1[0] + offset[1]), int(corner_1[1] + offset[0]))</div>
<div class="line"><span class="lineno"> 2297</span>            image = image = cv2.circle(image, p1, 2, (255,255,0), 2)</div>
<div class="line"><span class="lineno"> 2298</span>            <span class="keywordflow">for</span> corner_2 <span class="keywordflow">in</span> corners:</div>
<div class="line"><span class="lineno"> 2299</span>                p1 = (int(corner_1[0] + offset[1]), int(corner_1[1] + offset[0]))</div>
<div class="line"><span class="lineno"> 2300</span>                p2 = (int(corner_2[0] + offset[1]), int(corner_2[1] + offset[0]))</div>
<div class="line"><span class="lineno"> 2301</span>                image = cv2.line(image, p1, p2, (255,0,0))</div>
<div class="line"><span class="lineno"> 2302</span>        </div>
<div class="line"><span class="lineno"> 2303</span>        <span class="comment">#Resets corners for future assignment</span></div>
<div class="line"><span class="lineno"> 2304</span>        self.clear_corners()</div>
<div class="line"><span class="lineno"> 2305</span>        <span class="keywordflow">return</span> image, offset</div>
<div class="line"><span class="lineno"> 2306</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.clear_corners().</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a2e21d867efbc8b743664f8b6f41d1b8e_cgraph.png" border="0" usemap="#aa00206_a2e21d867efbc8b743664f8b6f41d1b8e_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a9f82d1ff05b9a54401f4749899cfedb5" name="a9f82d1ff05b9a54401f4749899cfedb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f82d1ff05b9a54401f4749899cfedb5">&#9670;&#160;</a></span>find_3d_limits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">find_3d_limits </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>height</em> = <code>1000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1204</span>    <span class="keyword">def </span>find_3d_limits(self, height=1000):</div>
<div class="line"><span class="lineno"> 1205</span>        print(<span class="stringliteral">&quot;Finding Limits...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>        edge_buffer = 5</div>
<div class="line"><span class="lineno"> 1208</span> </div>
<div class="line"><span class="lineno"> 1209</span>        x_limit = self.show_img.shape[1] - edge_buffer</div>
<div class="line"><span class="lineno"> 1210</span>        y_limit = self.show_img.shape[0] - edge_buffer</div>
<div class="line"><span class="lineno"> 1211</span>        x_min = 5</div>
<div class="line"><span class="lineno"> 1212</span>        y_min = 5</div>
<div class="line"><span class="lineno"> 1213</span>        </div>
<div class="line"><span class="lineno"> 1214</span>        bottom_left = (0,0,height)</div>
<div class="line"><span class="lineno"> 1215</span>        top_left = (0,self.room_length,height)</div>
<div class="line"><span class="lineno"> 1216</span>        top_right = (self.room_width,self.room_length,height)</div>
<div class="line"><span class="lineno"> 1217</span>        bottom_right = (self.room_width,0,height)</div>
<div class="line"><span class="lineno"> 1218</span> </div>
<div class="line"><span class="lineno"> 1219</span>        test_step = 100 <span class="comment"># 10cm</span></div>
<div class="line"><span class="lineno"> 1220</span>        max_distance_test = 12000 <span class="comment"># 12m max</span></div>
<div class="line"><span class="lineno"> 1221</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1222</span><span class="stringliteral">        Get top left</span></div>
<div class="line"><span class="lineno"> 1223</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1224</span>        <span class="comment">#test left limits</span></div>
<div class="line"><span class="lineno"> 1225</span>        pixel_y = inf</div>
<div class="line"><span class="lineno"> 1226</span>        pixel_x = inf</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>        <span class="comment"># test_top left</span></div>
<div class="line"><span class="lineno"> 1229</span>        x_lim = top_left[0]</div>
<div class="line"><span class="lineno"> 1230</span>        y_lim = top_left[1]</div>
<div class="line"><span class="lineno"> 1231</span>        z_lim = 0</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>        </div>
<div class="line"><span class="lineno"> 1235</span>        <span class="keywordflow">while</span> abs(x_lim) &lt;= float(max_distance_test) <span class="keywordflow">and</span> abs(y_lim) &lt;= float(max_distance_test) <span class="keywordflow">and</span> abs(z_lim):</div>
<div class="line"><span class="lineno"> 1236</span>            print(x_lim, y_lim, z_lim, max_distance_test)</div>
<div class="line"><span class="lineno"> 1237</span>            <span class="comment"># grab x and y of </span></div>
<div class="line"><span class="lineno"> 1238</span>            x_lim = top_left[0]</div>
<div class="line"><span class="lineno"> 1239</span>            y_lim = top_left[1]</div>
<div class="line"><span class="lineno"> 1240</span>            z_lim = top_left[2]</div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span> </div>
<div class="line"><span class="lineno"> 1243</span>            point_lim = np.float32([x_lim, y_lim , height])</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>            mapped_point, jac = cv2.projectPoints(point_lim, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno"> 1246</span>            pixel_y = mapped_point[0][0][1]</div>
<div class="line"><span class="lineno"> 1247</span>            pixel_x = mapped_point[0][0][0]</div>
<div class="line"><span class="lineno"> 1248</span>            <span class="keywordflow">if</span> pixel_x &gt;= edge_buffer:</div>
<div class="line"><span class="lineno"> 1249</span>                top_left = (top_left[0] - test_step, top_left[1], top_left[2])</div>
<div class="line"><span class="lineno"> 1250</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1251</span>                top_left = (top_left[0] + test_step/2, top_left[1], top_left[2])</div>
<div class="line"><span class="lineno"> 1252</span>            <span class="comment"># if pixel_x &lt; 10:</span></div>
<div class="line"><span class="lineno"> 1253</span>            <span class="comment">#     print(&quot;X reached&quot;)</span></div>
<div class="line"><span class="lineno"> 1254</span>                </div>
<div class="line"><span class="lineno"> 1255</span>            </div>
<div class="line"><span class="lineno"> 1256</span>            <span class="keywordflow">if</span> pixel_y &gt;= edge_buffer:</div>
<div class="line"><span class="lineno"> 1257</span>                top_left = (top_left[0], top_left[1] + test_step, top_left[2])</div>
<div class="line"><span class="lineno"> 1258</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1259</span>                top_left = (top_left[0], top_left[1] - test_step/2, top_left[2])</div>
<div class="line"><span class="lineno"> 1260</span>            <span class="comment"># if pixel_y &lt; 10:</span></div>
<div class="line"><span class="lineno"> 1261</span>            <span class="comment">#     print(&quot;Y reached&quot;)</span></div>
<div class="line"><span class="lineno"> 1262</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1263</span>                self.show_img = cv2.circle(self.show_img, (mapped_point[0][0][0], mapped_point[0][0][1]), 1,(255,0,0),1,0)</div>
<div class="line"><span class="lineno"> 1264</span>                cv2.imshow(<span class="stringliteral">&#39;Points&#39;</span>, self.show_img)</div>
<div class="line"><span class="lineno"> 1265</span>                cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1266</span>            <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno"> 1267</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 1268</span>            <span class="comment"># print(pixel_x, pixel_y,top_left)</span></div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>            <span class="keywordflow">if</span> pixel_x &lt; edge_buffer <span class="keywordflow">and</span> pixel_y &lt; edge_buffer:</div>
<div class="line"><span class="lineno"> 1271</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1272</span>        print(<span class="stringliteral">&quot;Top Left:&quot;</span>, top_left)</div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1275</span><span class="stringliteral">        Get top right</span></div>
<div class="line"><span class="lineno"> 1276</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1277</span>        pixel_y = inf</div>
<div class="line"><span class="lineno"> 1278</span>        pixel_x = -inf</div>
<div class="line"><span class="lineno"> 1279</span>        x_lim = top_right[0]</div>
<div class="line"><span class="lineno"> 1280</span>        y_lim = top_right[1]</div>
<div class="line"><span class="lineno"> 1281</span>        z_lim = top_right[2]</div>
<div class="line"><span class="lineno"> 1282</span>        <span class="comment"># top_right = top_left</span></div>
<div class="line"><span class="lineno"> 1283</span>        <span class="keywordflow">while</span> abs(x_lim) &lt;= max_distance_test <span class="keywordflow">and</span> abs(y_lim) &lt;= max_distance_test <span class="keywordflow">and</span> abs(z_lim) &lt;= max_distance_test:</div>
<div class="line"><span class="lineno"> 1284</span>            print(x_lim, y_lim)</div>
<div class="line"><span class="lineno"> 1285</span>            <span class="comment"># grab x and y of </span></div>
<div class="line"><span class="lineno"> 1286</span>            x_lim = top_right[0]</div>
<div class="line"><span class="lineno"> 1287</span>            y_lim = top_right[1]</div>
<div class="line"><span class="lineno"> 1288</span>            z_lim = top_right[2]</div>
<div class="line"><span class="lineno"> 1289</span> </div>
<div class="line"><span class="lineno"> 1290</span>            <span class="keywordflow">if</span> x_lim &lt;= max_distance_test <span class="keywordflow">or</span> y_lim &lt;= max_distance_test <span class="keywordflow">or</span> abs(z_lim) &lt;= max_distance_test:</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>                point_lim = np.float32([x_lim, y_lim , height])</div>
<div class="line"><span class="lineno"> 1293</span> </div>
<div class="line"><span class="lineno"> 1294</span>                mapped_point, jac = cv2.projectPoints(point_lim, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno"> 1295</span>                pixel_y = mapped_point[0][0][1]</div>
<div class="line"><span class="lineno"> 1296</span>                pixel_x = mapped_point[0][0][0]</div>
<div class="line"><span class="lineno"> 1297</span>                <span class="keywordflow">if</span> pixel_x &lt;= x_limit:</div>
<div class="line"><span class="lineno"> 1298</span>                    top_right = (top_right[0] + test_step, top_right[1], top_right[2])</div>
<div class="line"><span class="lineno"> 1299</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1300</span>                    top_right = (top_right[0] - test_step/2, top_right[1], top_right[2])</div>
<div class="line"><span class="lineno"> 1301</span> </div>
<div class="line"><span class="lineno"> 1302</span>                <span class="keywordflow">if</span> pixel_y &gt;= edge_buffer:</div>
<div class="line"><span class="lineno"> 1303</span>                    top_right = (top_right[0], top_right[1] + test_step, top_right[2])</div>
<div class="line"><span class="lineno"> 1304</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1305</span>                    top_right = (top_right[0], top_right[1] - test_step/2, top_right[2])</div>
<div class="line"><span class="lineno"> 1306</span>                <span class="comment"># if pixel_y &gt; y_limit:</span></div>
<div class="line"><span class="lineno"> 1307</span>                <span class="comment">#     print(&quot;Y reached&quot;)</span></div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1310</span>                self.show_img = cv2.circle(self.show_img, (mapped_point[0][0][0], mapped_point[0][0][1]), 1,(255,0,0),1,0)</div>
<div class="line"><span class="lineno"> 1311</span>                cv2.imshow(<span class="stringliteral">&#39;Points&#39;</span>, self.show_img)</div>
<div class="line"><span class="lineno"> 1312</span>                cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1313</span>            <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno"> 1314</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 1315</span>                </div>
<div class="line"><span class="lineno"> 1316</span>                <span class="keywordflow">if</span> pixel_x &gt;= x_limit <span class="keywordflow">and</span> pixel_y &lt; edge_buffer:</div>
<div class="line"><span class="lineno"> 1317</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1318</span>        print(<span class="stringliteral">&quot;Top Right&quot;</span>, top_right)</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1321</span><span class="stringliteral">        Get bottom left</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1323</span>        pixel_y = -inf</div>
<div class="line"><span class="lineno"> 1324</span>        pixel_x = -inf</div>
<div class="line"><span class="lineno"> 1325</span>        x_lim = bottom_left[0]</div>
<div class="line"><span class="lineno"> 1326</span>        y_lim = bottom_left[1]</div>
<div class="line"><span class="lineno"> 1327</span>        z_lim = bottom_left[2]</div>
<div class="line"><span class="lineno"> 1328</span>        <span class="comment"># bottom_left = top_left</span></div>
<div class="line"><span class="lineno"> 1329</span>        <span class="keywordflow">while</span> abs(x_lim) &lt;= max_distance_test <span class="keywordflow">and</span> abs(y_lim) &lt;= max_distance_test <span class="keywordflow">and</span> abs(z_lim) &lt;= max_distance_test:</div>
<div class="line"><span class="lineno"> 1330</span>            <span class="comment"># grab x and y of </span></div>
<div class="line"><span class="lineno"> 1331</span>            x_lim = bottom_left[0]</div>
<div class="line"><span class="lineno"> 1332</span>            y_lim = bottom_left[1]</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>            point_lim = np.float32([x_lim, y_lim , height])</div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span>            mapped_point, jac = cv2.projectPoints(point_lim, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno"> 1337</span>            pixel_y = mapped_point[0][0][1]</div>
<div class="line"><span class="lineno"> 1338</span>            pixel_x = mapped_point[0][0][0]</div>
<div class="line"><span class="lineno"> 1339</span>            <span class="keywordflow">if</span> pixel_x &gt;= edge_buffer:</div>
<div class="line"><span class="lineno"> 1340</span>                bottom_left = (bottom_left[0] - test_step, bottom_left[1], bottom_left[2])</div>
<div class="line"><span class="lineno"> 1341</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1342</span>                bottom_left = (bottom_left[0] + test_step/2, bottom_left[1], bottom_left[2])</div>
<div class="line"><span class="lineno"> 1343</span> </div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>            </div>
<div class="line"><span class="lineno"> 1346</span>            <span class="keywordflow">if</span> pixel_y &lt;= y_limit:</div>
<div class="line"><span class="lineno"> 1347</span>                bottom_left = (bottom_left[0], bottom_left[1] - test_step, bottom_left[2])</div>
<div class="line"><span class="lineno"> 1348</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1349</span>                bottom_left = (bottom_left[0], bottom_left[1] + test_step/2, bottom_left[2])</div>
<div class="line"><span class="lineno"> 1350</span>            <span class="comment"># if pixel_y &gt; y_limit:</span></div>
<div class="line"><span class="lineno"> 1351</span>            <span class="comment">#     print(&quot;Y reached&quot;)</span></div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1354</span>                self.show_img = cv2.circle(self.show_img, (mapped_point[0][0][0], mapped_point[0][0][1]), 1,(255,0,0),1,0)</div>
<div class="line"><span class="lineno"> 1355</span>                cv2.imshow(<span class="stringliteral">&#39;Points&#39;</span>, self.show_img)</div>
<div class="line"><span class="lineno"> 1356</span>                cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1357</span>            <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno"> 1358</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 1359</span>            <span class="comment"># print(pixel_x, pixel_y,bottom_left)</span></div>
<div class="line"><span class="lineno"> 1360</span> </div>
<div class="line"><span class="lineno"> 1361</span>            <span class="keywordflow">if</span> pixel_x &lt; edge_buffer <span class="keywordflow">and</span> pixel_y &gt; y_limit:</div>
<div class="line"><span class="lineno"> 1362</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1363</span>        print(<span class="stringliteral">&quot;Bottom Left:&quot;</span>, bottom_left)</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1366</span><span class="stringliteral">        Get bottom right</span></div>
<div class="line"><span class="lineno"> 1367</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1368</span>        pixel_y = -inf</div>
<div class="line"><span class="lineno"> 1369</span>        pixel_x = -inf</div>
<div class="line"><span class="lineno"> 1370</span>        <span class="comment"># bottom_right = bottom_left</span></div>
<div class="line"><span class="lineno"> 1371</span>        x_lim = bottom_right[0]</div>
<div class="line"><span class="lineno"> 1372</span>        y_lim = bottom_right[1]</div>
<div class="line"><span class="lineno"> 1373</span>        <span class="keywordflow">while</span> abs(x_lim) &lt;= max_distance_test <span class="keywordflow">and</span> abs(y_lim) &lt;= max_distance_test <span class="keywordflow">and</span> abs(z_lim) &lt;= max_distance_test:</div>
<div class="line"><span class="lineno"> 1374</span>            <span class="comment"># grab x and y of </span></div>
<div class="line"><span class="lineno"> 1375</span>            x_lim = bottom_right[0]</div>
<div class="line"><span class="lineno"> 1376</span>            y_lim = bottom_right[1]</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>            point_lim = np.float32([x_lim, y_lim , height])</div>
<div class="line"><span class="lineno"> 1379</span> </div>
<div class="line"><span class="lineno"> 1380</span>            mapped_point, jac = cv2.projectPoints(point_lim, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno"> 1381</span>            pixel_y = mapped_point[0][0][1]</div>
<div class="line"><span class="lineno"> 1382</span>            pixel_x = mapped_point[0][0][0]</div>
<div class="line"><span class="lineno"> 1383</span>            <span class="keywordflow">if</span> pixel_x &lt;= x_limit:</div>
<div class="line"><span class="lineno"> 1384</span>                bottom_right = (bottom_right[0] + test_step, bottom_right[1], bottom_right[2])</div>
<div class="line"><span class="lineno"> 1385</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1386</span>                bottom_right = (bottom_right[0] - test_step/2, bottom_right[1], bottom_right[2])</div>
<div class="line"><span class="lineno"> 1387</span>   </div>
<div class="line"><span class="lineno"> 1388</span>            <span class="keywordflow">if</span> pixel_y &lt;= y_limit:</div>
<div class="line"><span class="lineno"> 1389</span>                bottom_right = (bottom_right[0], bottom_right[1] - test_step, bottom_right[2])</div>
<div class="line"><span class="lineno"> 1390</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1391</span>                bottom_right = (bottom_right[0], bottom_right[1] + test_step/2, bottom_right[2])</div>
<div class="line"><span class="lineno"> 1392</span>            <span class="comment"># if pixel_y &gt; y_limit:</span></div>
<div class="line"><span class="lineno"> 1393</span>            <span class="comment">#     print(&quot;Y reached&quot;)</span></div>
<div class="line"><span class="lineno"> 1394</span> </div>
<div class="line"><span class="lineno"> 1395</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1396</span>                self.show_img = cv2.circle(self.show_img, (mapped_point[0][0][0], mapped_point[0][0][1]), 1,(255,0,0),1,0)</div>
<div class="line"><span class="lineno"> 1397</span>                cv2.imshow(<span class="stringliteral">&#39;Points&#39;</span>, self.show_img)</div>
<div class="line"><span class="lineno"> 1398</span>                cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1399</span>            <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno"> 1400</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 1401</span>            <span class="comment"># print(pixel_x, pixel_y,bottom_right)</span></div>
<div class="line"><span class="lineno"> 1402</span> </div>
<div class="line"><span class="lineno"> 1403</span>            <span class="keywordflow">if</span> pixel_x &gt;= x_limit <span class="keywordflow">and</span> pixel_y &gt;= y_limit:</div>
<div class="line"><span class="lineno"> 1404</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1405</span>        print(<span class="stringliteral">&quot;Bottom Right:&quot;</span>, bottom_right)</div>
<div class="line"><span class="lineno"> 1406</span>        min = np.array((top_left, bottom_left, top_right, bottom_right))</div>
<div class="line"><span class="lineno"> 1407</span>        min = np.amin(min, 0)</div>
<div class="line"><span class="lineno"> 1408</span> </div>
<div class="line"><span class="lineno"> 1409</span>        max = np.array((top_left, bottom_left, top_right, bottom_right))</div>
<div class="line"><span class="lineno"> 1410</span>        max = np.amax(max, 0)</div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span>        print(min, max)</div>
<div class="line"><span class="lineno"> 1413</span>        <span class="keywordflow">return</span> (min, max), (top_left, bottom_left, top_right, bottom_right)</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a3b5b618d6f1cc697a5191f0617a9200a">room_estimation.estimate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a9f82d1ff05b9a54401f4749899cfedb5_icgraph.png" border="0" usemap="#aa00206_a9f82d1ff05b9a54401f4749899cfedb5_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a54166ae0c7b7f8e5aadcc81eda56ce58" name="a54166ae0c7b7f8e5aadcc81eda56ce58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54166ae0c7b7f8e5aadcc81eda56ce58">&#9670;&#160;</a></span>find_intersection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">find_intersection </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>line_equation1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>line_equation2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the (x,y) location of the intersection of 2 lines given m and b of both lines from slope intercept form (m*x + b)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1487</span>    <span class="keyword">def </span>find_intersection(self, line_equation1, line_equation2):</div>
<div class="line"><span class="lineno"> 1488</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1489</span><span class="stringliteral">        Returns the (x,y) location of the intersection of 2 lines given m and b of both lines from slope intercept form (m*x + b)</span></div>
<div class="line"><span class="lineno"> 1490</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1491</span>        m1 = line_equation1.coef[0]</div>
<div class="line"><span class="lineno"> 1492</span>        b1 = line_equation1.coef[1]</div>
<div class="line"><span class="lineno"> 1493</span> </div>
<div class="line"><span class="lineno"> 1494</span>        m2 = line_equation2.coef[0]</div>
<div class="line"><span class="lineno"> 1495</span>        b2 = line_equation2.coef[1]</div>
<div class="line"><span class="lineno"> 1496</span> </div>
<div class="line"><span class="lineno"> 1497</span>        <span class="comment"># x intersection</span></div>
<div class="line"><span class="lineno"> 1498</span>        xi = (b1-b2) / (m2-m1)</div>
<div class="line"><span class="lineno"> 1499</span> </div>
<div class="line"><span class="lineno"> 1500</span>        <span class="comment">#y intersection</span></div>
<div class="line"><span class="lineno"> 1501</span>        yi = m1 * xi + b1</div>
<div class="line"><span class="lineno"> 1502</span> </div>
<div class="line"><span class="lineno"> 1503</span>        print(<span class="stringliteral">&quot;INTERSECTION&quot;</span>, xi, yi)</div>
<div class="line"><span class="lineno"> 1504</span>        <span class="keywordflow">return</span> (xi, yi)</div>
<div class="line"><span class="lineno"> 1505</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#ae4a382139afef48e3b930752120b4c35">room_estimation.define_perspective_grid()</a>, and <a class="el" href="a00206.html#af69d43ebb2e1d46a4e6313f41860c4fb">room_estimation.find_wall_intersection()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a54166ae0c7b7f8e5aadcc81eda56ce58_icgraph.png" border="0" usemap="#aa00206_a54166ae0c7b7f8e5aadcc81eda56ce58_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="af69d43ebb2e1d46a4e6313f41860c4fb" name="af69d43ebb2e1d46a4e6313f41860c4fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af69d43ebb2e1d46a4e6313f41860c4fb">&#9670;&#160;</a></span>find_wall_intersection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">find_wall_intersection </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>number_of_walls</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples_per_wall</em> = <code>4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extent</em> = <code>10000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>intersection_pairs</em> = <code>[]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>degree</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Using samples along visible parts of walls, it is possible to fit the curve and extend the visible location of the wall


intersection_pairs is a list of pairs of lines which are to be checked for intersections
Because we only check the current, previous and beginning and last, we leave out all other instances so a specification of which pairs are desired is optional
[(0,3), (1,3)] 
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1618</span>    <span class="keyword">def </span>find_wall_intersection(self, number_of_walls=2, samples_per_wall=4, extent=10000, intersection_pairs=[], degree=1):</div>
<div class="line"><span class="lineno"> 1619</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1620</span><span class="stringliteral">        Using samples along visible parts of walls, it is possible to fit the curve and extend the visible location of the wall</span></div>
<div class="line"><span class="lineno"> 1621</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1622</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1623</span><span class="stringliteral">        intersection_pairs is a list of pairs of lines which are to be checked for intersections</span></div>
<div class="line"><span class="lineno"> 1624</span><span class="stringliteral">        Because we only check the current, previous and beginning and last, we leave out all other instances so a specification of which pairs are desired is optional</span></div>
<div class="line"><span class="lineno"> 1625</span><span class="stringliteral">        [(0,3), (1,3)] </span></div>
<div class="line"><span class="lineno"> 1626</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1627</span>        fit_list = []</div>
<div class="line"><span class="lineno"> 1628</span>        corners = []</div>
<div class="line"><span class="lineno"> 1629</span>        <span class="comment"># while True:</span></div>
<div class="line"><span class="lineno"> 1630</span>        <span class="keywordflow">for</span> wall <span class="keywordflow">in</span> range(number_of_walls):</div>
<div class="line"><span class="lineno"> 1631</span>            print(<span class="stringliteral">&quot;Press C when done, 4 points per wall&quot;</span>)</div>
<div class="line"><span class="lineno"> 1632</span>            self.clear_corners()</div>
<div class="line"><span class="lineno"> 1633</span>            print(<span class="stringliteral">&quot;Finding Wall intersection&quot;</span>)</div>
<div class="line"><span class="lineno"> 1634</span> </div>
<div class="line"><span class="lineno"> 1635</span> </div>
<div class="line"><span class="lineno"> 1636</span>            wall = self.get_room_corners()</div>
<div class="line"><span class="lineno"> 1637</span> </div>
<div class="line"><span class="lineno"> 1638</span>            fit, equation = self.poly_fit_wall(wall, pixels_past_extent=extent, degree=degree)</div>
<div class="line"><span class="lineno"> 1639</span>            fit_list.append(equation)</div>
<div class="line"><span class="lineno"> 1640</span>            <span class="keywordflow">if</span> len(fit_list) &gt;= 2:</div>
<div class="line"><span class="lineno"> 1641</span>                <span class="keywordflow">for</span> index, f1 <span class="keywordflow">in</span> enumerate(fit_list):</div>
<div class="line"><span class="lineno"> 1642</span> </div>
<div class="line"><span class="lineno"> 1643</span>                    <span class="comment"># test only when multiple lines exist</span></div>
<div class="line"><span class="lineno"> 1644</span>                    <span class="keywordflow">if</span> index &gt; 0:</div>
<div class="line"><span class="lineno"> 1645</span> </div>
<div class="line"><span class="lineno"> 1646</span>                        <span class="comment">#look for intersection between current and previous</span></div>
<div class="line"><span class="lineno"> 1647</span>                        intersection = self.find_intersection(fit_list[index],fit_list[index-1])</div>
<div class="line"><span class="lineno"> 1648</span>                        <span class="keywordflow">if</span> <span class="keywordflow">not</span> math.isnan(intersection[0]):</div>
<div class="line"><span class="lineno"> 1649</span>                            corners.append(intersection)</div>
<div class="line"><span class="lineno"> 1650</span>                            cv2.circle(self.show_img, (int(intersection[0]), int(intersection[1])), 1,(0,255,0), 5, 0)</div>
<div class="line"><span class="lineno"> 1651</span> </div>
<div class="line"><span class="lineno"> 1652</span>                    <span class="comment"># test between the beginning and end</span></div>
<div class="line"><span class="lineno"> 1653</span>                    <span class="keywordflow">if</span> index+1 == len(fit_list):</div>
<div class="line"><span class="lineno"> 1654</span>                        intersection = self.find_intersection(fit_list[index],fit_list[0])</div>
<div class="line"><span class="lineno"> 1655</span>                        <span class="keywordflow">if</span> <span class="keywordflow">not</span> math.isnan(intersection[0]):</div>
<div class="line"><span class="lineno"> 1656</span>                            corners.append(intersection)</div>
<div class="line"><span class="lineno"> 1657</span>                            cv2.circle(self.show_img, (int(intersection[0]), int(intersection[1])), 1,(0,255,0), 5, 0)</div>
<div class="line"><span class="lineno"> 1658</span> </div>
<div class="line"><span class="lineno"> 1659</span>            end_1 = fit[0]</div>
<div class="line"><span class="lineno"> 1660</span>            end_2 = fit[-1]</div>
<div class="line"><span class="lineno"> 1661</span>            print(end_1, end_2)</div>
<div class="line"><span class="lineno"> 1662</span>            <span class="comment"># print(fit.tolist())</span></div>
<div class="line"><span class="lineno"> 1663</span>            </div>
<div class="line"><span class="lineno"> 1664</span>            self.connect_points(list(fit.astype(np.int).tolist()))</div>
<div class="line"><span class="lineno"> 1665</span>            key = cv2.waitKey(1) &amp; 0xFF</div>
<div class="line"><span class="lineno"> 1666</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&quot;d&quot;</span>):</div>
<div class="line"><span class="lineno"> 1667</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1668</span>        </div>
<div class="line"><span class="lineno"> 1669</span>        <span class="comment"># Add all of intersection_pairs that are specified</span></div>
<div class="line"><span class="lineno"> 1670</span>        <span class="keywordflow">for</span> intersection <span class="keywordflow">in</span> intersection_pairs:</div>
<div class="line"><span class="lineno"> 1671</span>            intersection = self.find_intersection(fit_list[index],fit_list[0])</div>
<div class="line"><span class="lineno"> 1672</span>            corners.append(intersection)</div>
<div class="line"><span class="lineno"> 1673</span>            cv2.circle(self.show_img, (int(intersection[0]), int(intersection[1])), 1,(0,255,0), 5, 0)</div>
<div class="line"><span class="lineno"> 1674</span> </div>
<div class="line"><span class="lineno"> 1675</span>        <span class="comment"># self.display_room()</span></div>
<div class="line"><span class="lineno"> 1676</span>        <span class="keywordflow">return</span> corners</div>
<div class="line"><span class="lineno"> 1677</span>        <span class="comment"># self.connect_points(fit)</span></div>
<div class="line"><span class="lineno"> 1678</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.calibration_resolution, room_estimation.camera_matrix, room_estimation.clear_corners(), room_estimation.connect_points(), room_estimation.distioriton_matrix, room_estimation.error_list, <a class="el" href="a00206.html#a54166ae0c7b7f8e5aadcc81eda56ce58">room_estimation.find_intersection()</a>, room_estimation.get_checkerboard_shape(), <a class="el" href="a00206.html#a1cc866ee6a78b68a77485eb1eb0f00ba">room_estimation.get_room_corners()</a>, <a class="el" href="a00206.html#a9ddc57e65b6b90133dae37504451b764">room_estimation.poly_fit_wall()</a>, room_estimation.rotation_vector, room_estimation.save_calibration(), room_estimation.show_img, and room_estimation.translation_vector.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_af69d43ebb2e1d46a4e6313f41860c4fb_cgraph.png" border="0" usemap="#aa00206_af69d43ebb2e1d46a4e6313f41860c4fb_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a0686ad347e6e14189cd0035e2ea7bd54" name="a0686ad347e6e14189cd0035e2ea7bd54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0686ad347e6e14189cd0035e2ea7bd54">&#9670;&#160;</a></span>fisheye_calibrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fisheye_calibrate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>checkerboard_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>checkerboard_grid</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1699</span>    <span class="keyword">def </span>fisheye_calibrate(self, checkerboard_images, checkerboard_grid=None, out=None):</div>
<div class="line"><span class="lineno"> 1700</span>        <span class="comment"># Checkboard dimensions</span></div>
<div class="line"><span class="lineno"> 1701</span>        <span class="keywordflow">if</span> checkerboard_grid <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1702</span>            CHECKERBOARD = self.get_checkerboard_shape(checkerboard_images)</div>
<div class="line"><span class="lineno"> 1703</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1704</span>            CHECKERBOARD = checkerboard_grid</div>
<div class="line"><span class="lineno"> 1705</span> </div>
<div class="line"><span class="lineno"> 1706</span>        </div>
<div class="line"><span class="lineno"> 1707</span>        subpix_criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 30, 0.1)</div>
<div class="line"><span class="lineno"> 1708</span>        criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 30, 0.1)</div>
<div class="line"><span class="lineno"> 1709</span>        calibration_flags = cv2.fisheye.CALIB_RECOMPUTE_EXTRINSIC + cv2.fisheye.CALIB_CHECK_COND + cv2.fisheye.CALIB_FIX_SKEW</div>
<div class="line"><span class="lineno"> 1710</span>        objp = np.zeros((1, CHECKERBOARD[0]*CHECKERBOARD[1], 3), np.float32)</div>
<div class="line"><span class="lineno"> 1711</span>        objp[0,:,:2] = np.mgrid[0:CHECKERBOARD[0], 0:CHECKERBOARD[1]].T.reshape(-1, 2)</div>
<div class="line"><span class="lineno"> 1712</span> </div>
<div class="line"><span class="lineno"> 1713</span>        objpoints = [] <span class="comment"># 3d point in real world space</span></div>
<div class="line"><span class="lineno"> 1714</span>        imgpoints = [] <span class="comment"># 2d points in image plane.</span></div>
<div class="line"><span class="lineno"> 1715</span> </div>
<div class="line"><span class="lineno"> 1716</span>        imgshape = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1717</span>        <span class="keywordflow">for</span> image <span class="keywordflow">in</span> checkerboard_images:</div>
<div class="line"><span class="lineno"> 1718</span> </div>
<div class="line"><span class="lineno"> 1719</span>            height, width = image.shape[:2]</div>
<div class="line"><span class="lineno"> 1720</span> </div>
<div class="line"><span class="lineno"> 1721</span>            image = cv2.cvtColor(image,cv2.COLOR_BGR2GRAY)</div>
<div class="line"><span class="lineno"> 1722</span> </div>
<div class="line"><span class="lineno"> 1723</span>            cv2.imshow(<span class="stringliteral">&#39;img&#39;</span>,image)</div>
<div class="line"><span class="lineno"> 1724</span>            cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1725</span>            imgshape = image.shape</div>
<div class="line"><span class="lineno"> 1726</span>            retval, corners = cv2.findChessboardCorners(image, CHECKERBOARD)</div>
<div class="line"><span class="lineno"> 1727</span>            <span class="comment"># cv2.cornerSubPix(checkerboard_image, corners)</span></div>
<div class="line"><span class="lineno"> 1728</span> </div>
<div class="line"><span class="lineno"> 1729</span>            <span class="comment"># retval, cameraMatrix, distCoeffs, rvecs, tvecs = cv2.calibrateCamera(objectPoints, imagePoints, imageSize)</span></div>
<div class="line"><span class="lineno"> 1730</span>            objp = np.zeros((1, CHECKERBOARD[0] * CHECKERBOARD[1], 3), np.float32)</div>
<div class="line"><span class="lineno"> 1731</span>            objp[0,:,:2] = np.mgrid[0:CHECKERBOARD[0], 0:CHECKERBOARD[1]].T.reshape(-1, 2)</div>
<div class="line"><span class="lineno"> 1732</span>            prev_img_shape = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1733</span>     </div>
<div class="line"><span class="lineno"> 1734</span> </div>
<div class="line"><span class="lineno"> 1735</span> </div>
<div class="line"><span class="lineno"> 1736</span>            <span class="keywordflow">if</span> retval == <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno"> 1737</span>                objpoints.append(objp)</div>
<div class="line"><span class="lineno"> 1738</span>                <span class="comment"># refining pixel coordinates for given 2d points.</span></div>
<div class="line"><span class="lineno"> 1739</span>                corners2 = cv2.cornerSubPix(image, corners, (11,11),(-1,-1), subpix_criteria)  </div>
<div class="line"><span class="lineno"> 1740</span>                imgpoints.append(corners2)</div>
<div class="line"><span class="lineno"> 1741</span>                <span class="comment"># Draw and display the corners</span></div>
<div class="line"><span class="lineno"> 1742</span> </div>
<div class="line"><span class="lineno"> 1743</span>                image = cv2.drawChessboardCorners(image, CHECKERBOARD, corners2, retval)</div>
<div class="line"><span class="lineno"> 1744</span>                cv2.imshow(<span class="stringliteral">&quot;Calibration&quot;</span>, image)</div>
<div class="line"><span class="lineno"> 1745</span>                cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1746</span> </div>
<div class="line"><span class="lineno"> 1747</span>        mean_error = 0</div>
<div class="line"><span class="lineno"> 1748</span>        total_error = 0</div>
<div class="line"><span class="lineno"> 1749</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(objpoints)):</div>
<div class="line"><span class="lineno"> 1750</span>            imgpoints2, _ = cv2.projectPoints(objpoints[i], rvecs[i], tvecs[i], mtx, dist)</div>
<div class="line"><span class="lineno"> 1751</span>            error = cv2.norm(imgpoints[i],imgpoints2, cv2.NORM_L2)/len(imgpoints2)</div>
<div class="line"><span class="lineno"> 1752</span>            total_error += error</div>
<div class="line"><span class="lineno"> 1753</span>        mean_error = total_error/len(objpoints)</div>
<div class="line"><span class="lineno"> 1754</span> </div>
<div class="line"><span class="lineno"> 1755</span>        print(mean_error)</div>
<div class="line"><span class="lineno"> 1756</span>        cv2.destroyAllWindows()</div>
<div class="line"><span class="lineno"> 1757</span> </div>
<div class="line"><span class="lineno"> 1758</span>        <span class="comment"># calculate K &amp; D</span></div>
<div class="line"><span class="lineno"> 1759</span>        N_imm = len(checkerboard_images)</div>
<div class="line"><span class="lineno"> 1760</span>        K = np.zeros((3, 3))</div>
<div class="line"><span class="lineno"> 1761</span>        D = np.zeros((4, 1))</div>
<div class="line"><span class="lineno"> 1762</span>        rvecs = [np.zeros((1, 1, 3), dtype=np.float64) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(N_imm)]</div>
<div class="line"><span class="lineno"> 1763</span>        tvecs = [np.zeros((1, 1, 3), dtype=np.float64) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(N_imm)]</div>
<div class="line"><span class="lineno"> 1764</span>        retval, K, D, rvecs, tvecs = cv2.fisheye.calibrate(objpoints, imgpoints, imgshape[::-1], K, D, flags=calibration_flags, criteria=criteria)</div>
<div class="line"><span class="lineno"> 1765</span>        self.camera_matrix = K</div>
<div class="line"><span class="lineno"> 1766</span>        self.distioriton_matrix = D</div>
<div class="line"><span class="lineno"> 1767</span>        self.rotation_vector = rvecs</div>
<div class="line"><span class="lineno"> 1768</span>        self.translation_vector = tvecs</div>
<div class="line"><span class="lineno"> 1769</span> </div>
<div class="line"><span class="lineno"> 1770</span>        <span class="keywordflow">if</span> out :</div>
<div class="line"><span class="lineno"> 1771</span>            <span class="keyword">with</span> open(out, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno"> 1772</span>                pickle.dump(K, f)</div>
<div class="line"><span class="lineno"> 1773</span>                pickle.dump(D, f)</div>
<div class="line"><span class="lineno"> 1774</span>                pickle.dump(rvecs, f)</div>
<div class="line"><span class="lineno"> 1775</span>                pickle.dump(tvecs, f)</div>
<div class="line"><span class="lineno"> 1776</span>                pickle.dump(error, f)</div>
<div class="line"><span class="lineno"> 1777</span>                f.close()</div>
<div class="line"><span class="lineno"> 1778</span> </div>
<div class="line"><span class="lineno"> 1779</span>                </div>
<div class="line"><span class="lineno"> 1780</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a52e10ca5ff3f0e459f47e6ccaf82adeb" name="a52e10ca5ff3f0e459f47e6ccaf82adeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52e10ca5ff3f0e459f47e6ccaf82adeb">&#9670;&#160;</a></span>get_3d_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_3d_point </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pixel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>height</em> = <code>1500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>camera_matrix</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rotation_matrix</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tvec</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>show_point</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  730</span>    <span class="keyword">def </span>get_3d_point(self, pixel, height=1500, camera_matrix=None, rotation_matrix=None, tvec=None, show_point=True):</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> camera_matrix:</div>
<div class="line"><span class="lineno">  733</span>            camera_matrix = self.camera_matrix</div>
<div class="line"><span class="lineno">  734</span>        </div>
<div class="line"><span class="lineno">  735</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> rotation_matrix:</div>
<div class="line"><span class="lineno">  736</span>            rotation_matrix = self.camera_matrix</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> tvec:</div>
<div class="line"><span class="lineno">  739</span>            tvec = self.translation_vector</div>
<div class="line"><span class="lineno">  740</span>        </div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">if</span> show_point:</div>
<div class="line"><span class="lineno">  742</span>            cv2.circle(self.show_img, pixel, 1, (255,255,0))</div>
<div class="line"><span class="lineno">  743</span>            cv2.imshow(self.window_name, self.show_img)</div>
<div class="line"><span class="lineno">  744</span>            cv2.waitKey(0)</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>        uv_point = np.array([pixel[0], pixel[1], 1])</div>
<div class="line"><span class="lineno">  747</span>        left_side = np.linalg.inv(rotation_matrix * np.identity(3) ) * np.linalg.inv(camera_matrix * np.identity(3) ) * uv_point</div>
<div class="line"><span class="lineno">  748</span>        right_side = np.linalg.inv(rotation_matrix * np.identity(3)) * tvec</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>        s = height + right_side[2][2]/left_side[2][2]</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>        point = np.linalg.inv(rotation_matrix * np.identity(3)) * (s*np.linalg.inv(camera_matrix* np.identity(3)) * uv_point - tvec)</div>
<div class="line"><span class="lineno">  753</span>        <span class="keywordflow">return</span> point</div>
<div class="line"><span class="lineno">  754</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8277f150767e58ce0824de54928fb184" name="a8277f150767e58ce0824de54928fb184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8277f150767e58ce0824de54928fb184">&#9670;&#160;</a></span>get_3d_to_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_3d_to_2d </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>show</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Point = (X, Z, Y) in mm (NOT PIXELS)
</pre> <div class="fragment"><div class="line"><span class="lineno">  671</span>    <span class="keyword">def </span>get_3d_to_2d(self, point, show=True):</div>
<div class="line"><span class="lineno">  672</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">        Point = (X, Z, Y) in mm (NOT PIXELS)</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  675</span>        <span class="comment"># np.ndarray((len(points), 3))</span></div>
<div class="line"><span class="lineno">  676</span>        <span class="comment"># test = np.array(point[0], point[1], point[2], point[0], point[1], point[2], point[0], point[1], point[2])</span></div>
<div class="line"><span class="lineno">  677</span>        <span class="comment"># points = np.float32(np.ndarray(points))</span></div>
<div class="line"><span class="lineno">  678</span>        point = np.float32([[point[0], point[1], point[2]]])</div>
<div class="line"><span class="lineno">  679</span>        <span class="comment"># print(point.shape)</span></div>
<div class="line"><span class="lineno">  680</span>        mapped_point, jac = cv2.projectPoints(point, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno">  681</span>        mapped_point = (int(mapped_point[0][0][0]),int(mapped_point[0][0][1]))</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordflow">if</span> show <span class="keywordflow">is</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  684</span>            self.draw_axis()</div>
<div class="line"><span class="lineno">  685</span>            cv2.circle(self.show_img, mapped_point, 6, (0, 255, 255))</div>
<div class="line"><span class="lineno">  686</span>            cv2.imshow(self.window_name, self.show_img)</div>
<div class="line"><span class="lineno">  687</span>            cv2.waitKey(0)</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>        <span class="keywordflow">return</span> mapped_point</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.axis, room_estimation.camera_matrix, room_estimation.corners, room_estimation.distioriton_matrix, room_estimation.draw_axis(), room_estimation.rotation_vector, room_estimation.show_img, room_estimation.translation_vector, and room_estimation.window_name.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a8277f150767e58ce0824de54928fb184_cgraph.png" border="0" usemap="#aa00206_a8277f150767e58ce0824de54928fb184_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ad5f4b9a9b0ee17c82d3731e05dba3109" name="ad5f4b9a9b0ee17c82d3731e05dba3109"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5f4b9a9b0ee17c82d3731e05dba3109">&#9670;&#160;</a></span>get_calibration_ratio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_calibration_ratio </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>video_resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>calibration_resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1948</span>    <span class="keyword">def </span>get_calibration_ratio(self, video_resolution, calibration_resolution):</div>
<div class="line"><span class="lineno"> 1949</span>        w_ratio = video_resolution[0]/calibration_resolution[0]</div>
<div class="line"><span class="lineno"> 1950</span>        h_ratio = video_resolution[1]/calibration_resolution[1]</div>
<div class="line"><span class="lineno"> 1951</span>        <span class="keywordflow">return</span> w_ratio, h_ratio</div>
<div class="line"><span class="lineno"> 1952</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c5233bfe740d0250450332850fcad71" name="a7c5233bfe740d0250450332850fcad71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c5233bfe740d0250450332850fcad71">&#9670;&#160;</a></span>get_checkerboard_shape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_checkerboard_shape </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>checkerboard_images</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1679</span>    <span class="keyword">def </span>get_checkerboard_shape(self, checkerboard_images):</div>
<div class="line"><span class="lineno"> 1680</span>        print(<span class="stringliteral">&quot;detecting checkerboard shape...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1681</span>        found = <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1682</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(4,10):</div>
<div class="line"><span class="lineno"> 1683</span>            </div>
<div class="line"><span class="lineno"> 1684</span>            <span class="keywordflow">if</span> found:</div>
<div class="line"><span class="lineno"> 1685</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1686</span>            <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(4,10):</div>
<div class="line"><span class="lineno"> 1687</span>                print(i,j)</div>
<div class="line"><span class="lineno"> 1688</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1689</span>                    retval, corners = cv2.findChessboardCorners(checkerboard_images[0], (i,j))</div>
<div class="line"><span class="lineno"> 1690</span>                    found = retval</div>
<div class="line"><span class="lineno"> 1691</span>                <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno"> 1692</span>                    found=<span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1693</span>                <span class="keywordflow">if</span> found:</div>
<div class="line"><span class="lineno"> 1694</span>                    checkerboard_grid = (i,j)</div>
<div class="line"><span class="lineno"> 1695</span>                    <span class="comment"># break</span></div>
<div class="line"><span class="lineno"> 1696</span>        print(<span class="stringliteral">&quot;Checkerboard shape:&quot;</span>, checkerboard_grid)</div>
<div class="line"><span class="lineno"> 1697</span>        <span class="keywordflow">return</span> checkerboard_grid</div>
<div class="line"><span class="lineno"> 1698</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#af69d43ebb2e1d46a4e6313f41860c4fb">room_estimation.find_wall_intersection()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a7c5233bfe740d0250450332850fcad71_icgraph.png" border="0" usemap="#aa00206_a7c5233bfe740d0250450332850fcad71_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a5f01474eaee314a7013feeaa49685bb9" name="a5f01474eaee314a7013feeaa49685bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f01474eaee314a7013feeaa49685bb9">&#9670;&#160;</a></span>get_corner_with_definition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_corner_with_definition </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  536</span>    <span class="keyword">def </span>get_corner_with_definition(self, event, x, y, flags, param):</div>
<div class="line"><span class="lineno">  537</span>        <span class="keywordflow">if</span> event == cv2.EVENT_LBUTTONDOWN:</div>
<div class="line"><span class="lineno">  538</span>            self.corners.append((x,y))</div>
<div class="line"><span class="lineno">  539</span>            cv2.circle(self.show_img, (x,y), 1,(0,0,255), 5, 0)</div>
<div class="line"><span class="lineno">  540</span>            </div>
<div class="line"><span class="lineno">  541</span>            width = input(<span class="stringliteral">&quot;Width&quot;</span>)</div>
<div class="line"><span class="lineno">  542</span>            length = input(<span class="stringliteral">&quot;Length&quot;</span>)</div>
<div class="line"><span class="lineno">  543</span>            self.room_points.append((int(width), int(length)))</div>
<div class="line"><span class="lineno">  544</span>            self.connect_points(self.corners)</div>
<div class="line"><span class="lineno">  545</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a921523998615aa3555a3cb0ca2b36965">room_estimation.assign_non_square_corners()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a5f01474eaee314a7013feeaa49685bb9_icgraph.png" border="0" usemap="#aa00206_a5f01474eaee314a7013feeaa49685bb9_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a7975986cd4d5ecccaadb6a9a0a521e1e" name="a7975986cd4d5ecccaadb6a9a0a521e1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7975986cd4d5ecccaadb6a9a0a521e1e">&#9670;&#160;</a></span>get_corners()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_corners </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  525</span>    <span class="keyword">def </span>get_corners(self, event, x, y, flags, param):</div>
<div class="line"><span class="lineno">  526</span>        <span class="comment"># grab references to the global variables</span></div>
<div class="line"><span class="lineno">  527</span>        <span class="comment"># global refPt, cropping, corner_count, corner_np</span></div>
<div class="line"><span class="lineno">  528</span>        <span class="comment"># if the left mouse button was clicked, record the starting</span></div>
<div class="line"><span class="lineno">  529</span>        <span class="comment"># (x, y) coordinates and indicate that cropping is being</span></div>
<div class="line"><span class="lineno">  530</span>        <span class="comment"># performed</span></div>
<div class="line"><span class="lineno">  531</span>        <span class="keywordflow">if</span> event == cv2.EVENT_LBUTTONDOWN:</div>
<div class="line"><span class="lineno">  532</span>            self.corners.append((x,y))</div>
<div class="line"><span class="lineno">  533</span>            cv2.circle(self.show_img, (x,y), 1,(0,0,255), 5, 0)</div>
<div class="line"><span class="lineno">  534</span>            print(<span class="stringliteral">&quot;CORNER !!!&quot;</span>)</div>
<div class="line"><span class="lineno">  535</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a921523998615aa3555a3cb0ca2b36965">room_estimation.assign_non_square_corners()</a>, and <a class="el" href="a00206.html#a1cc866ee6a78b68a77485eb1eb0f00ba">room_estimation.get_room_corners()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a7975986cd4d5ecccaadb6a9a0a521e1e_icgraph.png" border="0" usemap="#aa00206_a7975986cd4d5ecccaadb6a9a0a521e1e_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a7bcf809e2d6ba963c04b331f5c53a3a8" name="a7bcf809e2d6ba963c04b331f5c53a3a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bcf809e2d6ba963c04b331f5c53a3a8">&#9670;&#160;</a></span>get_cube_side()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_cube_side </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cube</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>side</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the point set of each side of the cube in 
Start at bottom left of the plane on the opened cube displayed, in clockwise order  (or, the perspective from the center)
This function is to be paired before crop_plain() and the points returned from requested side should be passed on
Example: Side 1 contains points 1,2,6,5

                                    |   5   |   
   5        6                       |_______|
   *--------*                       |       |
 / |       /|                       |   4   |
1 *---------*2|                _______|_______|_______
|  * 4    | *7              |       |       |       |
| /       |/                |   1   |   2   |   3   |
0 *---------*3                |_______|_______|_______|
</pre> <div class="fragment"><div class="line"><span class="lineno">  546</span>    <span class="keyword">def </span>get_cube_side(self, cube, side):</div>
<div class="line"><span class="lineno">  547</span>        <span class="stringliteral">&#39;&#39;&#39;                      </span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">        Returns the point set of each side of the cube in </span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">        Start at bottom left of the plane on the opened cube displayed, in clockwise order  (or, the perspective from the center)</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">        This function is to be paired before crop_plain() and the points returned from requested side should be passed on</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">        Example: Side 1 contains points 1,2,6,5</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">                                            |   5   |   </span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">           5        6                       |_______|</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">           *--------*                       |       |</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">         / |       /|                       |   4   |</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">      1 *---------*2|                _______|_______|_______</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">        |  * 4    | *7              |       |       |       |</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">        | /       |/                |   1   |   2   |   3   |</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">      0 *---------*3                |_______|_______|_______|</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  563</span>        points = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>        <span class="keywordflow">if</span> side == 1: <span class="comment"># Left Wall</span></div>
<div class="line"><span class="lineno">  566</span>            points = [cube[0], cube[1], cube[5], cube[4]]</div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordflow">elif</span> side == 2: <span class="comment"># Floor</span></div>
<div class="line"><span class="lineno">  568</span>            points = [cube[0], cube[4], cube[7], cube[3]]</div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">elif</span> side == 3: <span class="comment"># Right Wall</span></div>
<div class="line"><span class="lineno">  570</span>            points = [cube[7], cube[6], cube[2], cube[3]]</div>
<div class="line"><span class="lineno">  571</span>        <span class="keywordflow">elif</span> side == 4: <span class="comment"># Back wall</span></div>
<div class="line"><span class="lineno">  572</span>            points = [cube[4], cube[5], cube[6], cube[7]]</div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordflow">elif</span> side == 5: <span class="comment"># Ceiling</span></div>
<div class="line"><span class="lineno">  574</span>            points = [cube[5], cube[1], cube[2], cube[6]]</div>
<div class="line"><span class="lineno">  575</span>        print(points)</div>
<div class="line"><span class="lineno">  576</span>        print(np.array(points))</div>
<div class="line"><span class="lineno">  577</span>        </div>
<div class="line"><span class="lineno">  578</span>        <span class="keywordflow">return</span> points</div>
<div class="line"><span class="lineno">  579</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8113e0511b9bcb908b6a9aee98cee69b" name="a8113e0511b9bcb908b6a9aee98cee69b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8113e0511b9bcb908b6a9aee98cee69b">&#9670;&#160;</a></span>get_depth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_depth </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">get z position given x and y.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1419</span>    <span class="keyword">def </span>get_depth(self, event, x, y, p1, p2):</div>
<div class="line"><span class="lineno"> 1420</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1421</span><span class="stringliteral">        get z position given x and y.</span></div>
<div class="line"><span class="lineno"> 1422</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1423</span>        <span class="comment"># if event == cv2.EVENT_LBUTTONDOWN:</span></div>
<div class="line"><span class="lineno"> 1424</span>        <span class="comment"># resets the image so display does not accumulate</span></div>
<div class="line"><span class="lineno"> 1425</span>        self.show_img = self.img_copy()</div>
<div class="line"><span class="lineno"> 1426</span>        min = np.amin(np.array(self.mapped[(x,y)]), 0)</div>
<div class="line"><span class="lineno"> 1427</span>        max = np.amax(np.array(self.mapped[(x,y)]), 0)</div>
<div class="line"><span class="lineno"> 1428</span>        self.show_img = cv2.putText(self.show_img, str((min, max)), (x,y), fontFace=cv2.FONT_HERSHEY_PLAIN,fontScale=1, color=(255,0,0), thickness=2)</div>
<div class="line"><span class="lineno"> 1429</span>        </div>
<div class="line"><span class="lineno"> 1430</span>        print(x,y, <span class="stringliteral">&quot;-&gt;&quot;</span>, min[:2], max[:2])</div>
<div class="line"><span class="lineno"> 1431</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a3b5b618d6f1cc697a5191f0617a9200a">room_estimation.estimate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a8113e0511b9bcb908b6a9aee98cee69b_icgraph.png" border="0" usemap="#aa00206_a8113e0511b9bcb908b6a9aee98cee69b_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a6c3906082600df696b318ba028d67911" name="a6c3906082600df696b318ba028d67911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c3906082600df696b318ba028d67911">&#9670;&#160;</a></span>get_files_from_folder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_files_from_folder </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>folder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extension</em> = <code>&quot;MP4&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2734</span>    <span class="keyword">def </span>get_files_from_folder(self, folder, extension=&quot;MP4&quot;):</div>
<div class="line"><span class="lineno"> 2735</span>        </div>
<div class="line"><span class="lineno"> 2736</span>        files = []</div>
<div class="line"><span class="lineno"> 2737</span>        <span class="keywordflow">for</span> file <span class="keywordflow">in</span> os.listdir(folder):</div>
<div class="line"><span class="lineno"> 2738</span>            <span class="comment"># check only text files</span></div>
<div class="line"><span class="lineno"> 2739</span>            <span class="keywordflow">if</span> file.endswith((<span class="stringliteral">&#39;.&#39;</span> + extension)):</div>
<div class="line"><span class="lineno"> 2740</span>                files.append((folder + file))</div>
<div class="line"><span class="lineno"> 2741</span>        <span class="keywordflow">return</span> files</div>
<div class="line"><span class="lineno"> 2742</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae29c16a83d737f9e9f2b584ae560ad85" name="ae29c16a83d737f9e9f2b584ae560ad85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae29c16a83d737f9e9f2b584ae560ad85">&#9670;&#160;</a></span>get_n_room_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_n_room_points </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_locations</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>height</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">N_locations are known locations along the floor (Non-square rooms)
    5000mm
--------------  
       3-----4  
       |     |
       |     |
1------2     | 5000mm  (Length)
|            |
|            |
0------------5
    (Width)
Where (width,length) in mm
0 = (0,0)
1 = (0, 2500)
2 = (2500, 2500)
3 = (2500, 5000)
4 = (5000, 5000)
5 = (5000, 0)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1074</span>    <span class="keyword">def </span>get_n_room_points(self, n_locations=None, height=0):</div>
<div class="line"><span class="lineno"> 1075</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">        N_locations are known locations along the floor (Non-square rooms)</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral">            5000mm</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">        --------------  </span></div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral">               3-----4  </span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">               |     |</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">               |     |</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">        1------2     | 5000mm  (Length)</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral">        |            |</span></div>
<div class="line"><span class="lineno"> 1084</span><span class="stringliteral">        |            |</span></div>
<div class="line"><span class="lineno"> 1085</span><span class="stringliteral">        0------------5</span></div>
<div class="line"><span class="lineno"> 1086</span><span class="stringliteral">            (Width)</span></div>
<div class="line"><span class="lineno"> 1087</span><span class="stringliteral">        Where (width,length) in mm</span></div>
<div class="line"><span class="lineno"> 1088</span><span class="stringliteral">        0 = (0,0)</span></div>
<div class="line"><span class="lineno"> 1089</span><span class="stringliteral">        1 = (0, 2500)</span></div>
<div class="line"><span class="lineno"> 1090</span><span class="stringliteral">        2 = (2500, 2500)</span></div>
<div class="line"><span class="lineno"> 1091</span><span class="stringliteral">        3 = (2500, 5000)</span></div>
<div class="line"><span class="lineno"> 1092</span><span class="stringliteral">        4 = (5000, 5000)</span></div>
<div class="line"><span class="lineno"> 1093</span><span class="stringliteral">        5 = (5000, 0)</span></div>
<div class="line"><span class="lineno"> 1094</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1095</span>        <span class="keywordflow">if</span> n_locations == <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1096</span>            n_locations = self.room_points</div>
<div class="line"><span class="lineno"> 1097</span>        <span class="comment"># objectPoints = np.reshape(np.asfarray(n_locations), (len(n_locations),3,1))</span></div>
<div class="line"><span class="lineno"> 1098</span>        objectPoints = np.ndarray((len(n_locations), 3, 1))</div>
<div class="line"><span class="lineno"> 1099</span>        <span class="keywordflow">for</span> index, location <span class="keywordflow">in</span> enumerate(n_locations):</div>
<div class="line"><span class="lineno"> 1100</span>            <span class="comment"># for index2, dim in enumerate(location):</span></div>
<div class="line"><span class="lineno"> 1101</span>            print(location)</div>
<div class="line"><span class="lineno"> 1102</span>            objectPoints[index][0][0] = location[0] <span class="comment"># X </span></div>
<div class="line"><span class="lineno"> 1103</span>            objectPoints[index][1][0] = location[1] <span class="comment"># Z</span></div>
<div class="line"><span class="lineno"> 1104</span>            objectPoints[index][2][0] = height      <span class="comment"># Y</span></div>
<div class="line"><span class="lineno"> 1105</span>            <span class="comment"># print(objectPoints[index][:])</span></div>
<div class="line"><span class="lineno"> 1106</span>        print(objectPoints)</div>
<div class="line"><span class="lineno"> 1107</span>        <span class="keywordflow">return</span> objectPoints</div>
<div class="line"><span class="lineno"> 1108</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.room_points.</p>

<p class="reference">Referenced by <a class="el" href="a00206.html#a921523998615aa3555a3cb0ca2b36965">room_estimation.assign_non_square_corners()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_ae29c16a83d737f9e9f2b584ae560ad85_icgraph.png" border="0" usemap="#aa00206_ae29c16a83d737f9e9f2b584ae560ad85_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a0246e47740851d72979f6d5cdc76bf18" name="a0246e47740851d72979f6d5cdc76bf18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0246e47740851d72979f6d5cdc76bf18">&#9670;&#160;</a></span>get_pixel_location()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_pixel_location </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pixel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the pixel location in 3D
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1452</span>    <span class="keyword">def </span>get_pixel_location(self, pixel):</div>
<div class="line"><span class="lineno"> 1453</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1454</span><span class="stringliteral">        Returns the pixel location in 3D</span></div>
<div class="line"><span class="lineno"> 1455</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1456</span>        <span class="keywordflow">return</span> self.mapped[pixel]</div>
<div class="line"><span class="lineno"> 1457</span> </div>
<div class="line"><span class="lineno"> 1458</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.mapped.</p>

</div>
</div>
<a id="a68abc4d3a13c1374dfa93018a57b84be" name="a68abc4d3a13c1374dfa93018a57b84be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68abc4d3a13c1374dfa93018a57b84be">&#9670;&#160;</a></span>get_room_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_room_3d </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>save_filename</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1010</span>    <span class="keyword">def </span>get_room_3d(self, limits, height, step, save_filename=None):</div>
<div class="line"><span class="lineno"> 1011</span>        min, max = limits</div>
<div class="line"><span class="lineno"> 1012</span>        </div>
<div class="line"><span class="lineno"> 1013</span>        points = np.mgrid[min[0]:max[0]:step, min[1]:max[1]:step, height:height+1:1].reshape(3,-1).T.astype(np.float) <span class="comment"># all 40 inches</span></div>
<div class="line"><span class="lineno"> 1014</span>        print(<span class="stringliteral">&quot;Projecting points with size&quot;</span>, points.shape)</div>
<div class="line"><span class="lineno"> 1015</span>        mapped_pixels, jac = cv2.projectPoints(points, self.rotation_vector, self.translation_vector, self.camera_matrix, self.distioriton_matrix)</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>        print(<span class="stringliteral">&quot;Mapping...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1018</span>        mapped = {}</div>
<div class="line"><span class="lineno"> 1019</span>        <span class="keywordflow">for</span> index, pixel <span class="keywordflow">in</span> enumerate(mapped_pixels):</div>
<div class="line"><span class="lineno"> 1020</span>            </div>
<div class="line"><span class="lineno"> 1021</span>            point = points[index]</div>
<div class="line"><span class="lineno"> 1022</span>            pixel = (int(pixel[0][0]), int(pixel[0][1]))</div>
<div class="line"><span class="lineno"> 1023</span>            <span class="comment"># image = cv2.circle(image, pixel, 1, (1,1,1))</span></div>
<div class="line"><span class="lineno"> 1024</span>            <span class="keywordflow">if</span> pixel <span class="keywordflow">in</span> mapped.keys():</div>
<div class="line"><span class="lineno"> 1025</span>                mapped[pixel].append(point)</div>
<div class="line"><span class="lineno"> 1026</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1027</span>                mapped[pixel] = [point]</div>
<div class="line"><span class="lineno"> 1028</span>        self.mapped = mapped</div>
<div class="line"><span class="lineno"> 1029</span>        print(<span class="stringliteral">&quot;Mapping Complete.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1030</span>        <span class="keywordflow">return</span> mapped</div>
<div class="line"><span class="lineno"> 1031</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a3b5b618d6f1cc697a5191f0617a9200a">room_estimation.estimate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a68abc4d3a13c1374dfa93018a57b84be_icgraph.png" border="0" usemap="#aa00206_a68abc4d3a13c1374dfa93018a57b84be_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a1cc866ee6a78b68a77485eb1eb0f00ba" name="a1cc866ee6a78b68a77485eb1eb0f00ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc866ee6a78b68a77485eb1eb0f00ba">&#9670;&#160;</a></span>get_room_corners()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_room_corners </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_points</em> = <code>4</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Assigns 2D Room corners which will map to the real world 3D.

This function is a loop for the number of room points (real world) and lets you select the location they should exist in the video.

Each point should be respective to the order that room points exist. For example, consistently clockwise starting from the bottom left.
</pre> <div class="fragment"><div class="line"><span class="lineno">  467</span>    <span class="keyword">def </span>get_room_corners(self, num_points=4):</div>
<div class="line"><span class="lineno">  468</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">        Assigns 2D Room corners which will map to the real world 3D.</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">        This function is a loop for the number of room points (real world) and lets you select the location they should exist in the video.</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">        Each point should be respective to the order that room points exist. For example, consistently clockwise starting from the bottom left.</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  475</span>        self.clear_corners()</div>
<div class="line"><span class="lineno">  476</span>        print(<span class="stringliteral">&quot;Assigning corners...&quot;</span>)</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">#Initializes feedback to a function</span></div>
<div class="line"><span class="lineno">  479</span>        cv2.setMouseCallback(<span class="stringliteral">&quot;Room Estimation&quot;</span>, self.get_corners)</div>
<div class="line"><span class="lineno">  480</span>        print(<span class="stringliteral">&quot;Setting Callback&quot;</span>)</div>
<div class="line"><span class="lineno">  481</span>        <span class="keywordflow">while</span> len(self.corners) &lt; num_points:</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>            <span class="comment"># display the image and wait for a keypress</span></div>
<div class="line"><span class="lineno">  484</span>            cv2.imshow(<span class="stringliteral">&quot;Room Estimation&quot;</span>, self.show_img)</div>
<div class="line"><span class="lineno">  485</span>            cv2.setMouseCallback(<span class="stringliteral">&quot;Room Estimation&quot;</span>, self.get_corners)</div>
<div class="line"><span class="lineno">  486</span>            key = cv2.waitKey(1) &amp; 0xFF</div>
<div class="line"><span class="lineno">  487</span>            self.connect_points(self.corners)</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>            <span class="comment"># if len(self.corners) &gt;= 4:</span></div>
<div class="line"><span class="lineno">  490</span>            <span class="comment">#     self.show_img, cube, target_cube = self.draw_cuboid()</span></div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>            <span class="keywordflow">if</span> key == ord(<span class="stringliteral">&quot;c&quot;</span>):</div>
<div class="line"><span class="lineno">  493</span>                <span class="keywordflow">return</span> self.connect_points(self.corners)</div>
<div class="line"><span class="lineno">  494</span>            </div>
<div class="line"><span class="lineno">  495</span>        self.connect_points(self.corners)</div>
<div class="line"><span class="lineno">  496</span>    </div>
<div class="line"><span class="lineno">  497</span>        self.corners = np.reshape(np.asfarray(self.corners), (num_points,2,1))</div>
<div class="line"><span class="lineno">  498</span>        <span class="comment"># cv2.setMouseCallback(&quot;Room Estimation&quot;, self.draw_vector)</span></div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">return</span> self.corners</div>
<div class="line"><span class="lineno">  500</span>        </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.clear_corners(), room_estimation.connect_points(), room_estimation.corners, room_estimation.get_corners, room_estimation.get_corners(), room_estimation.room_points, room_estimation.show_img, and room_estimation.window_name.</p>

<p class="reference">Referenced by <a class="el" href="a00206.html#ae4a382139afef48e3b930752120b4c35">room_estimation.define_perspective_grid()</a>, <a class="el" href="a00206.html#af69d43ebb2e1d46a4e6313f41860c4fb">room_estimation.find_wall_intersection()</a>, and <a class="el" href="a00206.html#abeac4cbae89aef891cee148cbbbc6232">room_estimation.superimpose_checker()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a1cc866ee6a78b68a77485eb1eb0f00ba_cgraph.png" border="0" usemap="#aa00206_a1cc866ee6a78b68a77485eb1eb0f00ba_cgraph" alt=""/></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a1cc866ee6a78b68a77485eb1eb0f00ba_icgraph.png" border="0" usemap="#aa00206_a1cc866ee6a78b68a77485eb1eb0f00ba_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="aab76a3fa2901de336d5a1a3e1b707604" name="aab76a3fa2901de336d5a1a3e1b707604"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab76a3fa2901de336d5a1a3e1b707604">&#9670;&#160;</a></span>get_room_dimensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_room_dimensions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>room_points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Given room points returns the width and length of the room given the farthest points.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2307</span>    <span class="keyword">def </span>get_room_dimensions(self, room_points):</div>
<div class="line"><span class="lineno"> 2308</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2309</span><span class="stringliteral">        Given room points returns the width and length of the room given the farthest points.</span></div>
<div class="line"><span class="lineno"> 2310</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2311</span> </div>
<div class="line"><span class="lineno"> 2312</span>        max_width = 0</div>
<div class="line"><span class="lineno"> 2313</span>        max_length = 0</div>
<div class="line"><span class="lineno"> 2314</span>        </div>
<div class="line"><span class="lineno"> 2315</span>        <span class="keywordflow">for</span> point <span class="keywordflow">in</span> room_points:</div>
<div class="line"><span class="lineno"> 2316</span>            x, z, y = point</div>
<div class="line"><span class="lineno"> 2317</span>            <span class="keywordflow">if</span> x &gt; max_width:</div>
<div class="line"><span class="lineno"> 2318</span>                max_width = x</div>
<div class="line"><span class="lineno"> 2319</span>            <span class="keywordflow">if</span> z &gt; max_length:</div>
<div class="line"><span class="lineno"> 2320</span>                max_length = z</div>
<div class="line"><span class="lineno"> 2321</span> </div>
<div class="line"><span class="lineno"> 2322</span>        <span class="keywordflow">return</span> max_width, max_length</div>
<div class="line"><span class="lineno"> 2323</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a62767547824d2f147fc10c5b38f2c725" name="a62767547824d2f147fc10c5b38f2c725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62767547824d2f147fc10c5b38f2c725">&#9670;&#160;</a></span>get_room_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_room_points </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>height</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1046</span>    <span class="keyword">def </span>get_room_points(self, width, length, height=0):</div>
<div class="line"><span class="lineno"> 1047</span>        print(<span class="stringliteral">&quot;Creating room points&quot;</span>)</div>
<div class="line"><span class="lineno"> 1048</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral">        Returns a matrix for real world points.</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral">        These points start on the bottom left and are assigned as a rectangle in a clockwise direction</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">        </span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">        (width)</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">        1------2 </span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">        |      |</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral">        |      | (length)</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">        0      3</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">        We may include Height, but this is not included.</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral">        Format of points (X,Z,Y)</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1062</span> </div>
<div class="line"><span class="lineno"> 1063</span>        objectPoints = np.array(</div>
<div class="line"><span class="lineno"> 1064</span>            [</div>
<div class="line"><span class="lineno"> 1065</span>                [[0.0],[0.0],[float(height)]],</div>
<div class="line"><span class="lineno"> 1066</span>                [[0.0],[float(length)],[float(height)]],</div>
<div class="line"><span class="lineno"> 1067</span>                [[float(width)],[float(length)],[float(height)]],</div>
<div class="line"><span class="lineno"> 1068</span>                [[float(width)],[0.0],[float(height)]],</div>
<div class="line"><span class="lineno"> 1069</span>            ]</div>
<div class="line"><span class="lineno"> 1070</span>        ) </div>
<div class="line"><span class="lineno"> 1071</span>        print(objectPoints.shape)</div>
<div class="line"><span class="lineno"> 1072</span>        <span class="keywordflow">return</span> objectPoints</div>
<div class="line"><span class="lineno"> 1073</span>    </div>
</div><!-- fragment -->
</div>
</div>
<a id="af380d3a1fe6a68080691e578d25937b1" name="af380d3a1fe6a68080691e578d25937b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af380d3a1fe6a68080691e578d25937b1">&#9670;&#160;</a></span>img_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">img_copy </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  242</span>    <span class="keyword">def </span>img_copy(self):</div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordflow">return</span> deepcopy(self.image)</div>
<div class="line"><span class="lineno">  244</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b7fb08f24516ed753d38cd1eccd73f6" name="a3b7fb08f24516ed753d38cd1eccd73f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b7fb08f24516ed753d38cd1eccd73f6">&#9670;&#160;</a></span>load_and_undistort_calibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load_and_undistort_calibration </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>video_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>visualize_distortion</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points_data</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2478</span>    <span class="keyword">def </span>load_and_undistort_calibration(self, video_path, visualize_distortion=False, points_data=None):</div>
<div class="line"><span class="lineno"> 2479</span>        calibration_path = video_path[:-3] + <span class="stringliteral">&quot;pickle&quot;</span></div>
<div class="line"><span class="lineno"> 2480</span>        checkerboard_image = self.collect_frames(video_path,1,1,2)[0]</div>
<div class="line"><span class="lineno"> 2481</span> </div>
<div class="line"><span class="lineno"> 2482</span>        self.calibration_resolution = (checkerboard_image.shape[1], checkerboard_image.shape[0])</div>
<div class="line"><span class="lineno"> 2483</span> </div>
<div class="line"><span class="lineno"> 2484</span>        c, d, r, t, error, resolution = self.load_calibration(calibration_path)</div>
<div class="line"><span class="lineno"> 2485</span>        checkerboard = self.undistort_room(image=checkerboard_image, points_data=points_data)</div>
<div class="line"><span class="lineno"> 2486</span>        visroom = self.undistort_room()</div>
<div class="line"><span class="lineno"> 2487</span>        cv2.imshow(video_path, visroom)</div>
<div class="line"><span class="lineno"> 2488</span>        cv2.imshow(<span class="stringliteral">&quot;checkerboard&quot;</span>, checkerboard)</div>
<div class="line"><span class="lineno"> 2489</span> </div>
<div class="line"><span class="lineno"> 2490</span>        <span class="keywordflow">if</span> visualize_distortion:</div>
<div class="line"><span class="lineno"> 2491</span>            self.visualize_distortion(c, d)</div>
<div class="line"><span class="lineno"> 2492</span> </div>
<div class="line"><span class="lineno"> 2493</span>        cv2.waitKey(0)</div>
<div class="line"><span class="lineno"> 2494</span>        <span class="keywordflow">return</span> visroom, checkerboard, c, d ,r ,t, error, resolution</div>
<div class="line"><span class="lineno"> 2495</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a14966b15146b30927e515a9b3c64328d" name="a14966b15146b30927e515a9b3c64328d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14966b15146b30927e515a9b3c64328d">&#9670;&#160;</a></span>load_calibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load_calibration </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Loads in order
1 Camera matrix
2 Distortion Matrix
3 Rvecs
4 Tvecs
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1866</span>    <span class="keyword">def </span>load_calibration(self, file):</div>
<div class="line"><span class="lineno"> 1867</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1868</span><span class="stringliteral">        Loads in order</span></div>
<div class="line"><span class="lineno"> 1869</span><span class="stringliteral">        1 Camera matrix</span></div>
<div class="line"><span class="lineno"> 1870</span><span class="stringliteral">        2 Distortion Matrix</span></div>
<div class="line"><span class="lineno"> 1871</span><span class="stringliteral">        3 Rvecs</span></div>
<div class="line"><span class="lineno"> 1872</span><span class="stringliteral">        4 Tvecs</span></div>
<div class="line"><span class="lineno"> 1873</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1874</span> </div>
<div class="line"><span class="lineno"> 1875</span>        <span class="keyword">with</span> open(file, <span class="stringliteral">&#39;rb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno"> 1876</span>            mtx = pickle.load(f)</div>
<div class="line"><span class="lineno"> 1877</span>            dist =pickle.load(f)</div>
<div class="line"><span class="lineno"> 1878</span>            rvecs =pickle.load(f)</div>
<div class="line"><span class="lineno"> 1879</span>            tvecs =pickle.load(f)</div>
<div class="line"><span class="lineno"> 1880</span>            error_list = pickle.load(f)</div>
<div class="line"><span class="lineno"> 1881</span>            calibration_resolution = pickle.load(f)</div>
<div class="line"><span class="lineno"> 1882</span>            f.close()</div>
<div class="line"><span class="lineno"> 1883</span> </div>
<div class="line"><span class="lineno"> 1884</span>        print(mtx)</div>
<div class="line"><span class="lineno"> 1885</span>        self.camera_matrix = mtx</div>
<div class="line"><span class="lineno"> 1886</span>        self.distioriton_matrix = dist</div>
<div class="line"><span class="lineno"> 1887</span>        self.rotation_vector = rvecs</div>
<div class="line"><span class="lineno"> 1888</span>        self.translation_vector = tvecs</div>
<div class="line"><span class="lineno"> 1889</span>        self.error_list = error_list</div>
<div class="line"><span class="lineno"> 1890</span>        self.calibration_resolution</div>
<div class="line"><span class="lineno"> 1891</span>        <span class="keywordflow">return</span> mtx, dist, rvecs, tvecs, error_list, calibration_resolution</div>
<div class="line"><span class="lineno"> 1892</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.calibration_resolution, room_estimation.camera_matrix, room_estimation.distioriton_matrix, room_estimation.error_list, room_estimation.rotation_vector, and room_estimation.translation_vector.</p>

<p class="reference">Referenced by <a class="el" href="a00206.html#a2a5df656a4b4d07c05b290f8197c316f">room_estimation.save_room()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a14966b15146b30927e515a9b3c64328d_icgraph.png" border="0" usemap="#aa00206_a14966b15146b30927e515a9b3c64328d_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a7fea1337eef39488e7f6b170151cf628" name="a7fea1337eef39488e7f6b170151cf628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fea1337eef39488e7f6b170151cf628">&#9670;&#160;</a></span>load_room()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load_room </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2459</span>    <span class="keyword">def </span>load_room(self, filename):</div>
<div class="line"><span class="lineno"> 2460</span>        <span class="keywordflow">if</span> filename :</div>
<div class="line"><span class="lineno"> 2461</span> </div>
<div class="line"><span class="lineno"> 2462</span>            <span class="keyword">with</span> open(filename, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno"> 2463</span>                self.room_points = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2464</span>                self.corners = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2465</span>                self.room_width = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2466</span>                self.room_length = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2467</span>                self.room_height = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2468</span>                self.mapped = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2469</span>                self.camera_matrix = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2470</span>                self.distioriton_matrix = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2471</span>                self.rotation_vector = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2472</span>                self.translation_vector = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2473</span>                self.calibration_resolution = pickle.load(f)</div>
<div class="line"><span class="lineno"> 2474</span> </div>
<div class="line"><span class="lineno"> 2475</span> </div>
<div class="line"><span class="lineno"> 2476</span>                f.close()</div>
<div class="line"><span class="lineno"> 2477</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae66e446204a8676a532acab744601f10" name="ae66e446204a8676a532acab744601f10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66e446204a8676a532acab744601f10">&#9670;&#160;</a></span>load_room_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load_room_3d </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1040</span>    <span class="keyword">def </span>load_room_3d(self, filename):</div>
<div class="line"><span class="lineno"> 1041</span>        <span class="keyword">with</span> open(filename, <span class="stringliteral">&#39;rb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno"> 1042</span>            mapped = pickle.load(f)</div>
<div class="line"><span class="lineno"> 1043</span>            f.close()</div>
<div class="line"><span class="lineno"> 1044</span>        <span class="keywordflow">return</span> mapped</div>
<div class="line"><span class="lineno"> 1045</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a444510358faa06884318d1ebe94846ff" name="a444510358faa06884318d1ebe94846ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a444510358faa06884318d1ebe94846ff">&#9670;&#160;</a></span>load_tracker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load_tracker </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>csv_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Loads the tracker data of a csv file
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2100</span>    <span class="keyword">def </span>load_tracker(self, csv_file):</div>
<div class="line"><span class="lineno"> 2101</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2102</span><span class="stringliteral">        Loads the tracker data of a csv file</span></div>
<div class="line"><span class="lineno"> 2103</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2104</span> </div>
<div class="line"><span class="lineno"> 2105</span>        df = pd.read_csv(csv_file)</div>
<div class="line"><span class="lineno"> 2106</span>        fps = int(round(df.iloc[0][<span class="stringliteral">&#39;FrameRate&#39;</span>]))</div>
<div class="line"><span class="lineno"> 2107</span>        self.invert_y = int(df.iloc[1][<span class="stringliteral">&#39;Max_Pixel_y&#39;</span>])</div>
<div class="line"><span class="lineno"> 2108</span> </div>
<div class="line"><span class="lineno"> 2109</span>        df = df[[<span class="stringliteral">&#39;Frame_Num&#39;</span>,<span class="stringliteral">&#39;Pixel_Loc_x&#39;</span>,<span class="stringliteral">&#39;Pixel_Loc_y&#39;</span>, <span class="stringliteral">&#39;Name&#39;</span>, <span class="stringliteral">&#39;ID&#39;</span>,<span class="stringliteral">&#39;Max_Pixel_x&#39;</span>, <span class="stringliteral">&#39;Max_Pixel_y&#39;</span>, <span class="stringliteral">&#39;Width(px)&#39;</span>, <span class="stringliteral">&#39;Height(px)&#39;</span>]]</div>
<div class="line"><span class="lineno"> 2110</span>        df = self.correct_tracker_points(df)</div>
<div class="line"><span class="lineno"> 2111</span>        print(df)</div>
<div class="line"><span class="lineno"> 2112</span>        <span class="keywordflow">return</span> df</div>
<div class="line"><span class="lineno"> 2113</span> </div>
<div class="line"><span class="lineno"> 2114</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00206.html#ab870abde92556016846a09d5feb9e03c">room_estimation.correct_tracker_points()</a>, tracker_evaluation.invert_y, and room_estimation.invert_y.</p>

<p class="reference">Referenced by <a class="el" href="a00206.html#a75031a34aadd8c7847c479a17524e00e">room_estimation.stitch_trackers()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a444510358faa06884318d1ebe94846ff_cgraph.png" border="0" usemap="#aa00206_a444510358faa06884318d1ebe94846ff_cgraph" alt=""/></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a444510358faa06884318d1ebe94846ff_icgraph.png" border="0" usemap="#aa00206_a444510358faa06884318d1ebe94846ff_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a54ccab8062e8ce67319dcd81d75b6d4a" name="a54ccab8062e8ce67319dcd81d75b6d4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54ccab8062e8ce67319dcd81d75b6d4a">&#9670;&#160;</a></span>make_interpolater()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">make_interpolater </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Depreciated.
Supposed to be used to divide a grid space given pixels.
Interpolates values in between min and max.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1506</span>    <span class="keyword">def </span>make_interpolater(left_min, left_max, right_min, right_max): </div>
<div class="line"><span class="lineno"> 1507</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1508</span><span class="stringliteral">        Depreciated.</span></div>
<div class="line"><span class="lineno"> 1509</span><span class="stringliteral">        Supposed to be used to divide a grid space given pixels.</span></div>
<div class="line"><span class="lineno"> 1510</span><span class="stringliteral">        Interpolates values in between min and max.</span></div>
<div class="line"><span class="lineno"> 1511</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1512</span>        <span class="comment"># Figure out how &#39;wide&#39; each range is  </span></div>
<div class="line"><span class="lineno"> 1513</span>        leftSpan = left_max - left_min  </div>
<div class="line"><span class="lineno"> 1514</span>        rightSpan = right_max - right_min  </div>
<div class="line"><span class="lineno"> 1515</span> </div>
<div class="line"><span class="lineno"> 1516</span>        <span class="comment"># Compute the scale factor between left and right values </span></div>
<div class="line"><span class="lineno"> 1517</span>        scaleFactor = float(rightSpan) / float(leftSpan) </div>
<div class="line"><span class="lineno"> 1518</span> </div>
<div class="line"><span class="lineno"> 1519</span>        <span class="comment"># create interpolation function using pre-calculated scaleFactor</span></div>
<div class="line"><span class="lineno"> 1520</span>        <span class="keyword">def </span>interp_fn(value):</div>
<div class="line"><span class="lineno"> 1521</span>            <span class="keywordflow">return</span> right_min + (value-left_min)*scaleFactor</div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>        <span class="keywordflow">return</span> interp_fn</div>
<div class="line"><span class="lineno"> 1524</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8bb923e853aeed05b8e25def792f5e4" name="ab8bb923e853aeed05b8e25def792f5e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8bb923e853aeed05b8e25def792f5e4">&#9670;&#160;</a></span>plot_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plot_points </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  638</span>    <span class="keyword">def </span>plot_points(event,x,y,flags,params):</div>
<div class="line"><span class="lineno">  639</span>        <span class="keyword">global</span> mouseX,mouseY</div>
<div class="line"><span class="lineno">  640</span>        <span class="comment"># print(params)</span></div>
<div class="line"><span class="lineno">  641</span>        mapped_points = params</div>
<div class="line"><span class="lineno">  642</span>        p_list = []</div>
<div class="line"><span class="lineno">  643</span>        x_list = []</div>
<div class="line"><span class="lineno">  644</span>        y_list = []</div>
<div class="line"><span class="lineno">  645</span>        z_list = []</div>
<div class="line"><span class="lineno">  646</span>        <span class="keywordflow">if</span> event == cv2.EVENT_LBUTTONDBLCLK:</div>
<div class="line"><span class="lineno">  647</span>            <span class="keywordflow">if</span> (x,y) <span class="keywordflow">in</span> mapped_points.keys():</div>
<div class="line"><span class="lineno">  648</span>                p_list = mapped_points[(x,y)]</div>
<div class="line"><span class="lineno">  649</span>                </div>
<div class="line"><span class="lineno">  650</span>                </div>
<div class="line"><span class="lineno">  651</span>                <span class="keywordflow">for</span> p <span class="keywordflow">in</span> p_list:</div>
<div class="line"><span class="lineno">  652</span>                    print(p)</div>
<div class="line"><span class="lineno">  653</span>                    x_list.append(p[0])</div>
<div class="line"><span class="lineno">  654</span>                    y_list.append(p[2])</div>
<div class="line"><span class="lineno">  655</span>                    z_list.append(p[1])</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>                fig = plt.figure(figsize=(4,4))</div>
<div class="line"><span class="lineno">  660</span>                ax = fig.add_subplot(111, projection=<span class="stringliteral">&#39;3d&#39;</span>)</div>
<div class="line"><span class="lineno">  661</span>                ax.scatter(xs = x_list, ys = y_list, zs = z_list)</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>                ax.set_title(<span class="stringliteral">&quot;3D Point position in room&quot;</span>)</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>                ax.set_xlabel(<span class="stringliteral">&quot;X (Width&quot;</span>)</div>
<div class="line"><span class="lineno">  666</span>                ax.set_ylabel(<span class="stringliteral">&quot;Y (Height)&quot;</span>)</div>
<div class="line"><span class="lineno">  667</span>                ax.set_zlabel(<span class="stringliteral">&quot;Z (Depth&quot;</span>)</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>                plt.show()</div>
<div class="line"><span class="lineno">  670</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ddc57e65b6b90133dae37504451b764" name="a9ddc57e65b6b90133dae37504451b764"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ddc57e65b6b90133dae37504451b764">&#9670;&#160;</a></span>poly_fit_wall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">poly_fit_wall </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pixels_past_extent</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>horizontal_extent</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>degree</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Samples exist in format np.array([x,y,z], [x,y,z])

Used to find intersection points.

Utilized to define points in the grid.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1459</span>    <span class="keyword">def </span>poly_fit_wall(self, samples, pixels_past_extent=100,horizontal_extent=None, degree=2):</div>
<div class="line"><span class="lineno"> 1460</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1461</span><span class="stringliteral">        Samples exist in format np.array([x,y,z], [x,y,z])</span></div>
<div class="line"><span class="lineno"> 1462</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1463</span><span class="stringliteral">        Used to find intersection points.</span></div>
<div class="line"><span class="lineno"> 1464</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1465</span><span class="stringliteral">        Utilized to define points in the grid.</span></div>
<div class="line"><span class="lineno"> 1466</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1467</span> </div>
<div class="line"><span class="lineno"> 1468</span>        samples = np.reshape(samples, (samples.shape[0], 2))</div>
<div class="line"><span class="lineno"> 1469</span>        <span class="keywordflow">if</span> horizontal_extent <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1470</span>            min = np.amin(samples, 0)[0]</div>
<div class="line"><span class="lineno"> 1471</span>            max = np.amax(samples, 0)[0]</div>
<div class="line"><span class="lineno"> 1472</span>            horizontal_extent = np.linspace(min  - pixels_past_extent, max + pixels_past_extent)</div>
<div class="line"><span class="lineno"> 1473</span> </div>
<div class="line"><span class="lineno"> 1474</span> </div>
<div class="line"><span class="lineno"> 1475</span>        <span class="comment"># Polyfit a model on the samples x,y then create a line with the exten of the horizontal extent we provide</span></div>
<div class="line"><span class="lineno"> 1476</span>        fit = np.polyfit(samples[:,0], samples[:,1], degree)</div>
<div class="line"><span class="lineno"> 1477</span>        </div>
<div class="line"><span class="lineno"> 1478</span>        polynomial_equation = np.poly1d(fit)</div>
<div class="line"><span class="lineno"> 1479</span>        print(<span class="stringliteral">&quot;Equation&quot;</span>, polynomial_equation)</div>
<div class="line"><span class="lineno"> 1480</span>        </div>
<div class="line"><span class="lineno"> 1481</span>        pred_line = polynomial_equation(horizontal_extent)</div>
<div class="line"><span class="lineno"> 1482</span>        pred_line = np.reshape(pred_line, (len(pred_line),1))</div>
<div class="line"><span class="lineno"> 1483</span>        horizontal_extent = np.reshape(horizontal_extent, (len(horizontal_extent),1))</div>
<div class="line"><span class="lineno"> 1484</span>        <span class="comment"># print(pred_line)</span></div>
<div class="line"><span class="lineno"> 1485</span>        <span class="keywordflow">return</span> np.hstack((horizontal_extent, pred_line)), polynomial_equation</div>
<div class="line"><span class="lineno"> 1486</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#ae4a382139afef48e3b930752120b4c35">room_estimation.define_perspective_grid()</a>, and <a class="el" href="a00206.html#af69d43ebb2e1d46a4e6313f41860c4fb">room_estimation.find_wall_intersection()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a9ddc57e65b6b90133dae37504451b764_icgraph.png" border="0" usemap="#aa00206_a9ddc57e65b6b90133dae37504451b764_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a4446e4e6d7e24976a0eb63a6d7970209" name="a4446e4e6d7e24976a0eb63a6d7970209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4446e4e6d7e24976a0eb63a6d7970209">&#9670;&#160;</a></span>project_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">project_point </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1416</span>    <span class="keyword">def </span>project_point(self, event,x,y,flags,params):</div>
<div class="line"><span class="lineno"> 1417</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 1418</span>    </div>
</div><!-- fragment -->
</div>
</div>
<a id="a671eb2401939cdbb1c91570e58d4f7c3" name="a671eb2401939cdbb1c91570e58d4f7c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a671eb2401939cdbb1c91570e58d4f7c3">&#9670;&#160;</a></span>project_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">project_points </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em> = <code>[]</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  632</span>    <span class="keyword">def </span>project_points(self, points=[]):</div>
<div class="line"><span class="lineno">  633</span>        points_np = np.reshape(np.asfarray(points), (len(points),2,1))</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae36b88c1816fb4bd3fef0f9967aa3527" name="ae36b88c1816fb4bd3fef0f9967aa3527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36b88c1816fb4bd3fef0f9967aa3527">&#9670;&#160;</a></span>save_calibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">save_calibration </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distortion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rvecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tvecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>error_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1855</span>    <span class="keyword">def </span>save_calibration(self, file, mtx, distortion, rvecs, tvecs, error_list, resolution):</div>
<div class="line"><span class="lineno"> 1856</span>        <span class="keywordflow">if</span> file :</div>
<div class="line"><span class="lineno"> 1857</span>            <span class="keyword">with</span> open(file, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno"> 1858</span>                pickle.dump(mtx, f)</div>
<div class="line"><span class="lineno"> 1859</span>                pickle.dump(distortion, f)</div>
<div class="line"><span class="lineno"> 1860</span>                pickle.dump(rvecs, f)</div>
<div class="line"><span class="lineno"> 1861</span>                pickle.dump(tvecs, f)</div>
<div class="line"><span class="lineno"> 1862</span>                pickle.dump(error_list, f)</div>
<div class="line"><span class="lineno"> 1863</span>                pickle.dump(resolution, f)</div>
<div class="line"><span class="lineno"> 1864</span>                f.close()</div>
<div class="line"><span class="lineno"> 1865</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#af69d43ebb2e1d46a4e6313f41860c4fb">room_estimation.find_wall_intersection()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_ae36b88c1816fb4bd3fef0f9967aa3527_icgraph.png" border="0" usemap="#aa00206_ae36b88c1816fb4bd3fef0f9967aa3527_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a2a5df656a4b4d07c05b290f8197c316f" name="a2a5df656a4b4d07c05b290f8197c316f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a5df656a4b4d07c05b290f8197c316f">&#9670;&#160;</a></span>save_room()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">save_room </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Saves all values which define a room.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2428</span>    <span class="keyword">def </span>save_room(self, filename):</div>
<div class="line"><span class="lineno"> 2429</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2430</span><span class="stringliteral">        Saves all values which define a room.</span></div>
<div class="line"><span class="lineno"> 2431</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2432</span>        </div>
<div class="line"><span class="lineno"> 2433</span>        <span class="keywordflow">if</span> filename :</div>
<div class="line"><span class="lineno"> 2434</span> </div>
<div class="line"><span class="lineno"> 2435</span>            <span class="keyword">with</span> open(filename, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno"> 2436</span>                pickle.dump(self.room_points, f)</div>
<div class="line"><span class="lineno"> 2437</span>                pickle.dump(self.corners, f)</div>
<div class="line"><span class="lineno"> 2438</span> </div>
<div class="line"><span class="lineno"> 2439</span>                <span class="comment"># Room Dimensions</span></div>
<div class="line"><span class="lineno"> 2440</span>                pickle.dump(self.room_width, f)</div>
<div class="line"><span class="lineno"> 2441</span>                pickle.dump(self.room_length, f)</div>
<div class="line"><span class="lineno"> 2442</span>                pickle.dump(self.room_height, f)</div>
<div class="line"><span class="lineno"> 2443</span>                </div>
<div class="line"><span class="lineno"> 2444</span>                <span class="comment"># Mapped coordinates from 2D to 3D. Useful for loading up tracker and getting 3D points</span></div>
<div class="line"><span class="lineno"> 2445</span>                pickle.dump(self.mapped, f)</div>
<div class="line"><span class="lineno"> 2446</span> </div>
<div class="line"><span class="lineno"> 2447</span>                <span class="comment"># Save calibration.</span></div>
<div class="line"><span class="lineno"> 2448</span>                pickle.dump(self.camera_matrix, f)</div>
<div class="line"><span class="lineno"> 2449</span>                pickle.dump(self.distioriton_matrix, f)</div>
<div class="line"><span class="lineno"> 2450</span>                pickle.dump(self.rotation_vector, f)</div>
<div class="line"><span class="lineno"> 2451</span>                pickle.dump(self.translation_vector, f)</div>
<div class="line"><span class="lineno"> 2452</span> </div>
<div class="line"><span class="lineno"> 2453</span>                pickle.dump(self.calibration_resolution, f)</div>
<div class="line"><span class="lineno"> 2454</span>                f.close()</div>
<div class="line"><span class="lineno"> 2455</span> </div>
<div class="line"><span class="lineno"> 2456</span>            <span class="comment"># Saves camera calibration</span></div>
<div class="line"><span class="lineno"> 2457</span>            <span class="comment"># self.save_calibration(filename)</span></div>
<div class="line"><span class="lineno"> 2458</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.calibration_resolution, room_estimation.camera_matrix, <a class="el" href="a00142.html#adcab0c33567748a21cfc4a90e663c1d6">CameraPosition.collect_frames()</a>, <a class="el" href="a00206.html#a048722841bc8d71bae4a1e4a9eb9db00">room_estimation.collect_frames()</a>, room_estimation.corners, room_estimation.distioriton_matrix, <a class="el" href="a00206.html#a14966b15146b30927e515a9b3c64328d">room_estimation.load_calibration()</a>, room_estimation.mapped, room_estimation.room_height, room_estimation.room_length, room_estimation.room_points, room_estimation.room_width, room_estimation.rotation_vector, room_estimation.translation_vector, <a class="el" href="a00206.html#abd979a29c40c64a598514d7d165bb4a9">room_estimation.undistort_room()</a>, and <a class="el" href="a00206.html#a6c6c06bc8bbf8a0f9f7237a97ff9487e">room_estimation.visualize_distortion()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a2a5df656a4b4d07c05b290f8197c316f_cgraph.png" border="0" usemap="#aa00206_a2a5df656a4b4d07c05b290f8197c316f_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="acf8ba8f0370d5371ba8c5a28e3e3d587" name="acf8ba8f0370d5371ba8c5a28e3e3d587"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf8ba8f0370d5371ba8c5a28e3e3d587">&#9670;&#160;</a></span>save_room_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">save_room_3d </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mapped</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1032</span>    <span class="keyword">def </span>save_room_3d(self, path, filename, mapped):</div>
<div class="line"><span class="lineno"> 1033</span>        print(<span class="stringliteral">&quot;Saving mapped points...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1034</span>        <span class="keywordflow">if</span> path <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1035</span>            <span class="keyword">with</span> open(filename, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno"> 1036</span>                pickle.dump(mapped, f)</div>
<div class="line"><span class="lineno"> 1037</span>                f.close()</div>
<div class="line"><span class="lineno"> 1038</span>        print(<span class="stringliteral">&quot;Save Complete.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1039</span>    </div>
</div><!-- fragment -->
</div>
</div>
<a id="a833c6efe94bd835b3ab82191c47f04fe" name="a833c6efe94bd835b3ab82191c47f04fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a833c6efe94bd835b3ab82191c47f04fe">&#9670;&#160;</a></span>set_axis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">set_axis </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  226</span>    <span class="keyword">def </span>set_axis(self, x, y, z):</div>
<div class="line"><span class="lineno">  227</span>        <span class="comment"># axis = np.float32([[0,0,0], [0,3000,0], [3000,3000,0], [3000,0,0],</span></div>
<div class="line"><span class="lineno">  228</span>        <span class="comment">#             [0,0,3000],[0,3000,3000],[3000,3000,3000],[3000,0,3000] ])</span></div>
<div class="line"><span class="lineno">  229</span>        self.axis = np.float32([[x,0,0], [0,z,0], [0,0,y]]).reshape(-1,3)</div>
<div class="line"><span class="lineno">  230</span>        <span class="keywordflow">return</span> self.axis</div>
<div class="line"><span class="lineno">  231</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acfa65bf2973032f8d2e0e33872634b06" name="acfa65bf2973032f8d2e0e33872634b06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfa65bf2973032f8d2e0e33872634b06">&#9670;&#160;</a></span>set_corners()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">set_corners </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p1</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p2</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p3</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p4</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  232</span>    <span class="keyword">def </span>set_corners(self, p1=None, p2=None, p3=None, p4=None):</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">if</span> p1:</div>
<div class="line"><span class="lineno">  234</span>            self.corner[0] = np.asarray([p1[0],p1[1]]).reshape(1,2,1)</div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordflow">if</span> p2:</div>
<div class="line"><span class="lineno">  236</span>            self.corner[1] = np.asarray([p2[0],p2[1]]).reshape(1,2,1)</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">if</span> p3:</div>
<div class="line"><span class="lineno">  238</span>            self.corner[2] = np.asarray([p3[0],p3[1]]).reshape(1,2,1)</div>
<div class="line"><span class="lineno">  239</span>        <span class="keywordflow">if</span> p3:</div>
<div class="line"><span class="lineno">  240</span>            self.corner[3] = np.asarray([p4[0],p4[1]]).reshape(1,2,1)</div>
<div class="line"><span class="lineno">  241</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5da847c11e206bbccbe29ec5e042462a" name="a5da847c11e206bbccbe29ec5e042462a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5da847c11e206bbccbe29ec5e042462a">&#9670;&#160;</a></span>set_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">set_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  198</span>    <span class="keyword">def </span>set_image(self, image):</div>
<div class="line"><span class="lineno">  199</span>        self.image = image</div>
<div class="line"><span class="lineno">  200</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a327e18a9cf669bab61d714980d73b0" name="a0a327e18a9cf669bab61d714980d73b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a327e18a9cf669bab61d714980d73b0">&#9670;&#160;</a></span>show_tracker_2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">show_tracker_2D </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data_columns</em> = <code>['Pixel_Loc_x',&#160;'Pixel_Loc_y']</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>window</em> = <code>&quot;Tracker2D&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>colour</em> = <code>(255,255,0)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2253</span>    <span class="keyword">def </span>show_tracker_2D(self, df, image, data_columns =[&#39;Pixel_Loc_x&#39;, &#39;Pixel_Loc_y&#39;], window=&quot;Tracker2D&quot;, colour = (255,255,0)):</div>
<div class="line"><span class="lineno"> 2254</span>        x = df[data_columns[0]].tolist()</div>
<div class="line"><span class="lineno"> 2255</span>        y = df[data_columns[1]].tolist()</div>
<div class="line"><span class="lineno"> 2256</span> </div>
<div class="line"><span class="lineno"> 2257</span>        <span class="keywordflow">for</span> index <span class="keywordflow">in</span> range(len(x)):</div>
<div class="line"><span class="lineno"> 2258</span>            image = cv2.circle(image, (int(x[index]), int(y[index])), 2, colour, 2)</div>
<div class="line"><span class="lineno"> 2259</span>            cv2.imshow(window, image)</div>
<div class="line"><span class="lineno"> 2260</span>            cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 2261</span> </div>
<div class="line"><span class="lineno"> 2262</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab099905032ea6fd2a2e17e2414e58872" name="ab099905032ea6fd2a2e17e2414e58872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab099905032ea6fd2a2e17e2414e58872">&#9670;&#160;</a></span>show_tracker_3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">show_tracker_3D </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mapped_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mapped_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2145</span>    <span class="keyword">def </span>show_tracker_3D(self, df, mapped_min, mapped_max):</div>
<div class="line"><span class="lineno"> 2146</span>        <span class="comment"># https://stackoverflow.com/questions/38118598/3d-animation-using-matplotlib</span></div>
<div class="line"><span class="lineno"> 2147</span>        <span class="comment"># Convert df points numpy array</span></div>
<div class="line"><span class="lineno"> 2148</span>        x_df = df[<span class="stringliteral">&#39;Pixel_Loc_x&#39;</span>]</div>
<div class="line"><span class="lineno"> 2149</span>        y_df = df[<span class="stringliteral">&#39;Pixel_Loc_y&#39;</span>]</div>
<div class="line"><span class="lineno"> 2150</span> </div>
<div class="line"><span class="lineno"> 2151</span> </div>
<div class="line"><span class="lineno"> 2152</span> </div>
<div class="line"><span class="lineno"> 2153</span>        <span class="comment"># N = 100</span></div>
<div class="line"><span class="lineno"> 2154</span>        <span class="comment"># data = np.array(list(gen(N))).T</span></div>
<div class="line"><span class="lineno"> 2155</span>        <span class="comment"># line, = ax.plot(data[0, 0:1], data[1, 0:1], data[2, 0:1])</span></div>
<div class="line"><span class="lineno"> 2156</span> </div>
<div class="line"><span class="lineno"> 2157</span> </div>
<div class="line"><span class="lineno"> 2158</span> </div>
<div class="line"><span class="lineno"> 2159</span>        x_list1 = []</div>
<div class="line"><span class="lineno"> 2160</span>        y_list1 = []</div>
<div class="line"><span class="lineno"> 2161</span>        z_list1 = []</div>
<div class="line"><span class="lineno"> 2162</span> </div>
<div class="line"><span class="lineno"> 2163</span>        x_list2 = []</div>
<div class="line"><span class="lineno"> 2164</span>        y_list2 = []</div>
<div class="line"><span class="lineno"> 2165</span>        z_list2 = []</div>
<div class="line"><span class="lineno"> 2166</span>        <span class="keywordflow">for</span> index <span class="keywordflow">in</span> range(len(x_df)):</div>
<div class="line"><span class="lineno"> 2167</span>            point = (int(x_df.loc[index+1]), int(y_df.loc[index+1]))</div>
<div class="line"><span class="lineno"> 2168</span> </div>
<div class="line"><span class="lineno"> 2169</span>            <span class="comment"># Interactive mode</span></div>
<div class="line"><span class="lineno"> 2170</span> </div>
<div class="line"><span class="lineno"> 2171</span>            <span class="keywordflow">if</span> point <span class="keywordflow">in</span> mapped_min.keys():</div>
<div class="line"><span class="lineno"> 2172</span><span class="comment"># </span></div>
<div class="line"><span class="lineno"> 2173</span>                min_point = mapped_min[point]</div>
<div class="line"><span class="lineno"> 2174</span>                <span class="comment"># for p in min_point:</span></div>
<div class="line"><span class="lineno"> 2175</span>                    <span class="comment"># x,y,z = p</span></div>
<div class="line"><span class="lineno"> 2176</span>                x,z,y = min_point[0]</div>
<div class="line"><span class="lineno"> 2177</span>                x_list1.append(x)</div>
<div class="line"><span class="lineno"> 2178</span>                y_list1.append(y)</div>
<div class="line"><span class="lineno"> 2179</span>                z_list1.append(z)</div>
<div class="line"><span class="lineno"> 2180</span>                <span class="comment"># scatter = ax.scatter3D(x, y,z, cmap=&#39;Greens&#39;)</span></div>
<div class="line"><span class="lineno"> 2181</span>                <span class="comment"># self.front_plt = ax.scatter3D(x, y, z)</span></div>
<div class="line"><span class="lineno"> 2182</span> </div>
<div class="line"><span class="lineno"> 2183</span>            <span class="keywordflow">if</span> point <span class="keywordflow">in</span> mapped_max.keys():</div>
<div class="line"><span class="lineno"> 2184</span>                max_point = mapped_max[point]</div>
<div class="line"><span class="lineno"> 2185</span> </div>
<div class="line"><span class="lineno"> 2186</span>                <span class="comment"># for p in max_point:</span></div>
<div class="line"><span class="lineno"> 2187</span>                x,z,y = max_point[0]</div>
<div class="line"><span class="lineno"> 2188</span>                x_list2.append(x)</div>
<div class="line"><span class="lineno"> 2189</span>                y_list2.append(y)</div>
<div class="line"><span class="lineno"> 2190</span>                z_list2.append(z)</div>
<div class="line"><span class="lineno"> 2191</span>        plt.ion</div>
<div class="line"><span class="lineno"> 2192</span>        <span class="keywordflow">if</span> self.fig <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2193</span>            self.fig = plt.figure(1)</div>
<div class="line"><span class="lineno"> 2194</span>            self.ax = plt.axes(projection=<span class="stringliteral">&#39;3d&#39;</span>)</div>
<div class="line"><span class="lineno"> 2195</span> </div>
<div class="line"><span class="lineno"> 2196</span> </div>
<div class="line"><span class="lineno"> 2197</span>            self.back_plt = self.ax.scatter3D(x_list1, y_list1, z_list1, cmap=<span class="stringliteral">&#39;Greens&#39;</span>)</div>
<div class="line"><span class="lineno"> 2198</span>            self.back_plt = self.ax.scatter3D(x_list2, y_list2, z_list2, cmap=<span class="stringliteral">&#39;Blues&#39;</span>)</div>
<div class="line"><span class="lineno"> 2199</span> </div>
<div class="line"><span class="lineno"> 2200</span>            <span class="comment"># self.line_plt = ax.plot3D([front_point[0],back_point[0]], [front_point[1],back_point[1]], [0,self.room_length], color=&#39;teal&#39;)</span></div>
<div class="line"><span class="lineno"> 2201</span>            </div>
<div class="line"><span class="lineno"> 2202</span>            <span class="comment"># plt.quiver(*origin, V[:,0], V[:,1], color=[&#39;r&#39;,&#39;b&#39;,&#39;g&#39;], scale=21)</span></div>
<div class="line"><span class="lineno"> 2203</span>            self.ax.set_xlim(-self.room_width,self.room_width)</div>
<div class="line"><span class="lineno"> 2204</span>            self.ax.set_ylim(-self.room_height,self.room_height)</div>
<div class="line"><span class="lineno"> 2205</span>            self.ax.set_zlim(-self.room_length,self.room_length)</div>
<div class="line"><span class="lineno"> 2206</span>            self.fig.canvas.draw()</div>
<div class="line"><span class="lineno"> 2207</span>            self.fig.canvas.flush_events()</div>
<div class="line"><span class="lineno"> 2208</span>            self.fig.show()</div>
<div class="line"><span class="lineno"> 2209</span> </div>
<div class="line"><span class="lineno"> 2210</span>            <span class="comment"># else:</span></div>
<div class="line"><span class="lineno"> 2211</span>                <span class="comment"># self.ax.cla()</span></div>
<div class="line"><span class="lineno"> 2212</span>                <span class="comment"># if values:</span></div>
<div class="line"><span class="lineno"> 2213</span>                <span class="comment">#     self.points_plt = self.ax.scatter3D(x_list,y_list,z_list, marker=&quot;D&quot;, color=&quot;red&quot;)</span></div>
<div class="line"><span class="lineno"> 2214</span>                <span class="comment"># # plt.quiver((0,0,0), (0,1,0), , color=[&#39;r&#39;,&#39;b&#39;,&#39;g&#39;], scale=21)</span></div>
<div class="line"><span class="lineno"> 2215</span>                <span class="comment"># self.ax.set_xlim(-self.room_width,self.room_width)</span></div>
<div class="line"><span class="lineno"> 2216</span>                <span class="comment"># self.ax.set_ylim(-self.room_height,self.room_width)</span></div>
<div class="line"><span class="lineno"> 2217</span>                <span class="comment"># self.ax.set_zlim(-self.room_length,self.room_width)</span></div>
<div class="line"><span class="lineno"> 2218</span>                <span class="comment"># self.ax.set_xlabel(&quot;X&quot;)</span></div>
<div class="line"><span class="lineno"> 2219</span>                <span class="comment"># self.ax.set_ylabel(&quot;Y&quot;)</span></div>
<div class="line"><span class="lineno"> 2220</span>                <span class="comment"># self.ax.set_zlabel(&quot;Z&quot;)</span></div>
<div class="line"><span class="lineno"> 2221</span>                </div>
<div class="line"><span class="lineno"> 2222</span>                <span class="comment"># self.float_plt = self.ax.scatter3D(floater_point[0],floater_point[1],self.vector_depth, marker=&quot;o&quot;, color=&quot;blue&quot;)</span></div>
<div class="line"><span class="lineno"> 2223</span>                <span class="comment"># self.front_plt = self.ax.scatter3D(front_point[0], front_point[1], 0, marker=(&quot;o&quot;), color=&quot;cyan&quot;)</span></div>
<div class="line"><span class="lineno"> 2224</span>                <span class="comment"># self.back_plt = self.ax.scatter3D(back_point[0],back_point[1], self.room_length, marker=&quot;x&quot;, color=&quot;cyan&quot;)</span></div>
<div class="line"><span class="lineno"> 2225</span>                <span class="comment"># self.line_plt = self.ax.plot3D([front_point[0],back_point[0]], [front_point[1],back_point[1]], [0,self.room_length], color=&#39;teal&#39;)</span></div>
<div class="line"><span class="lineno"> 2226</span>                <span class="comment"># self.quiver = self.ax.quiver([0,0,0], [0,0,0], [0,0,0], [self.room_width,0,0], [0,self.room_height,0], [0,0,self.room_length], length=0.1, normalize=False)</span></div>
<div class="line"><span class="lineno"> 2227</span>                <span class="comment"># self.fig.canvas.draw()</span></div>
<div class="line"><span class="lineno"> 2228</span>                <span class="comment"># self.fig.canvas.flush_events()</span></div>
<div class="line"><span class="lineno"> 2229</span>            <span class="comment"># image = cv2.circle(image, point, 2, (255,255,0), 2)</span></div>
<div class="line"><span class="lineno"> 2230</span>            <span class="comment"># cv2.imshow(&quot;Tracker2D&quot;, image)</span></div>
<div class="line"><span class="lineno"> 2231</span>            <span class="comment"># cv2.waitKey(1)</span></div>
<div class="line"><span class="lineno"> 2232</span> </div>
<div class="line"><span class="lineno"> 2233</span>            <span class="comment"># if point in mapped_min.keys():</span></div>
<div class="line"><span class="lineno"> 2234</span>            <span class="comment">#     min_point = mapped_min[point]</span></div>
<div class="line"><span class="lineno"> 2235</span> </div>
<div class="line"><span class="lineno"> 2236</span>            <span class="comment">#     for p in min_point:</span></div>
<div class="line"><span class="lineno"> 2237</span>            <span class="comment">#         x,y,z = p</span></div>
<div class="line"><span class="lineno"> 2238</span>            <span class="comment">#         scatter = ax.scatter3D(x, y,z, cmap=&#39;Greens&#39;)</span></div>
<div class="line"><span class="lineno"> 2239</span>            <span class="comment">#         # ax.plot_surface(x, y, z, color=(&#39;r&#39;))</span></div>
<div class="line"><span class="lineno"> 2240</span> </div>
<div class="line"><span class="lineno"> 2241</span>            <span class="comment"># if point in mapped_max.keys():</span></div>
<div class="line"><span class="lineno"> 2242</span>            <span class="comment">#     max_point = mapped_max[point]</span></div>
<div class="line"><span class="lineno"> 2243</span> </div>
<div class="line"><span class="lineno"> 2244</span>            <span class="comment">#     for p in max_point:</span></div>
<div class="line"><span class="lineno"> 2245</span>            <span class="comment">#         x,y,z = p</span></div>
<div class="line"><span class="lineno"> 2246</span>            <span class="comment">#         scatter = ax.scatter3D(x, y,z, cmap=&#39;Blues&#39;)</span></div>
<div class="line"><span class="lineno"> 2247</span> </div>
<div class="line"><span class="lineno"> 2248</span>            </div>
<div class="line"><span class="lineno"> 2249</span>            </div>
<div class="line"><span class="lineno"> 2250</span>        <span class="keywordflow">return</span> self.show_img</div>
<div class="line"><span class="lineno"> 2251</span> </div>
<div class="line"><span class="lineno"> 2252</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adbe2f98b84513775c3106191f2845ed3" name="adbe2f98b84513775c3106191f2845ed3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe2f98b84513775c3106191f2845ed3">&#9670;&#160;</a></span>stitch_rooms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">stitch_rooms </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>video_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>undistort</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>key_index</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>show</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Stitches rooms with custom keypoints with SIFT descriptors

undistort uses current room undistortion parameters to undistort all the videos in video_list

key_index is the index for which video is the source that all others will use as alignment reference.

returns a stitched image that is overlapped by all videos and a list of homography transformation matrices for every video index
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2506</span>    <span class="keyword">def </span>stitch_rooms(self, video_list, undistort=True, key_index=None, show=False):</div>
<div class="line"><span class="lineno"> 2507</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2508</span><span class="stringliteral">        Stitches rooms with custom keypoints with SIFT descriptors</span></div>
<div class="line"><span class="lineno"> 2509</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2510</span><span class="stringliteral">        undistort uses current room undistortion parameters to undistort all the videos in video_list</span></div>
<div class="line"><span class="lineno"> 2511</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2512</span><span class="stringliteral">        key_index is the index for which video is the source that all others will use as alignment reference.</span></div>
<div class="line"><span class="lineno"> 2513</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2514</span><span class="stringliteral">        returns a stitched image that is overlapped by all videos and a list of homography transformation matrices for every video index</span></div>
<div class="line"><span class="lineno"> 2515</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2516</span> </div>
<div class="line"><span class="lineno"> 2517</span>        <span class="comment"># Undistort all the rooms</span></div>
<div class="line"><span class="lineno"> 2518</span>        room_images = []</div>
<div class="line"><span class="lineno"> 2519</span>        room_tracks = []</div>
<div class="line"><span class="lineno"> 2520</span>        <span class="keywordflow">for</span> video <span class="keywordflow">in</span> video_list:</div>
<div class="line"><span class="lineno"> 2521</span>            print(video)</div>
<div class="line"><span class="lineno"> 2522</span>            frame = self.collect_frames(video,1,1,2)[0]</div>
<div class="line"><span class="lineno"> 2523</span>            <span class="keywordflow">if</span> undistort:</div>
<div class="line"><span class="lineno"> 2524</span>                frame = self.undistort_room(frame)</div>
<div class="line"><span class="lineno"> 2525</span>            room_images.append(frame)</div>
<div class="line"><span class="lineno"> 2526</span>        </div>
<div class="line"><span class="lineno"> 2527</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2528</span>        image_dict = {}</div>
<div class="line"><span class="lineno"> 2529</span>        orb = cv2.ORB_create()</div>
<div class="line"><span class="lineno"> 2530</span>        sift = cv2.SIFT_create()</div>
<div class="line"><span class="lineno"> 2531</span> </div>
<div class="line"><span class="lineno"> 2532</span>        <span class="comment"># Self defined keypoints with corner detection. </span></div>
<div class="line"><span class="lineno"> 2533</span>        <span class="keywordflow">for</span> index, img <span class="keywordflow">in</span> enumerate(room_images):</div>
<div class="line"><span class="lineno"> 2534</span>            maxCorners = max(0, 200)</div>
<div class="line"><span class="lineno"> 2535</span>            <span class="comment"># Parameters for Shi-Tomasi algorithm</span></div>
<div class="line"><span class="lineno"> 2536</span>            qualityLevel = 0.01</div>
<div class="line"><span class="lineno"> 2537</span>            minDistance = 10</div>
<div class="line"><span class="lineno"> 2538</span>            blockSize = 3</div>
<div class="line"><span class="lineno"> 2539</span>            gradientSize = 3</div>
<div class="line"><span class="lineno"> 2540</span>            useHarrisDetector = <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 2541</span>            k = 0.03</div>
<div class="line"><span class="lineno"> 2542</span>            <span class="comment"># Copy the source image</span></div>
<div class="line"><span class="lineno"> 2543</span>            copy = np.copy(img)</div>
<div class="line"><span class="lineno"> 2544</span>            gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)</div>
<div class="line"><span class="lineno"> 2545</span>            <span class="comment"># Apply corner detection</span></div>
<div class="line"><span class="lineno"> 2546</span>            corners = cv2.goodFeaturesToTrack(gray, maxCorners, qualityLevel, minDistance, <span class="keywordtype">None</span>, blockSize=blockSize, gradientSize=gradientSize, useHarrisDetector=useHarrisDetector, k=k)</div>
<div class="line"><span class="lineno"> 2547</span>            <span class="comment"># Draw corners detected</span></div>
<div class="line"><span class="lineno"> 2548</span>            print(<span class="stringliteral">&#39;** Number of corners detected:&#39;</span>, corners.shape[0])</div>
<div class="line"><span class="lineno"> 2549</span>            radius = 4</div>
<div class="line"><span class="lineno"> 2550</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(corners.shape[0]):</div>
<div class="line"><span class="lineno"> 2551</span>                cv2.circle(copy, (int(corners[i,0,0]), int(corners[i,0,1])), radius, (0, 255, 0), cv2.FILLED)</div>
<div class="line"><span class="lineno"> 2552</span>            <span class="comment"># Show what you got</span></div>
<div class="line"><span class="lineno"> 2553</span>            <span class="keywordflow">if</span> show:</div>
<div class="line"><span class="lineno"> 2554</span>                cv2.namedWindow(<span class="stringliteral">&quot;source_window&quot;</span>)</div>
<div class="line"><span class="lineno"> 2555</span>                cv2.imshow(<span class="stringliteral">&quot;source_window&quot;</span>, copy)</div>
<div class="line"><span class="lineno"> 2556</span>                cv2.waitKey(600)</div>
<div class="line"><span class="lineno"> 2557</span>            <span class="comment"># Set the needed parameters to find the refined corners</span></div>
<div class="line"><span class="lineno"> 2558</span>            winSize = (5, 5)</div>
<div class="line"><span class="lineno"> 2559</span>            zeroZone = (-1, -1)</div>
<div class="line"><span class="lineno"> 2560</span>            criteria = (cv2.TERM_CRITERIA_EPS + cv2.TermCriteria_COUNT, 40, 0.001)</div>
<div class="line"><span class="lineno"> 2561</span>            <span class="comment"># Calculate the refined corner locations</span></div>
<div class="line"><span class="lineno"> 2562</span>            corners = cv2.cornerSubPix(gray, corners, winSize, zeroZone, criteria)</div>
<div class="line"><span class="lineno"> 2563</span> </div>
<div class="line"><span class="lineno"> 2564</span>            <span class="comment"># Convert subpixel corners to keypoints and create SIFT descriptors</span></div>
<div class="line"><span class="lineno"> 2565</span>            kp_corners = cv2.KeyPoint_convert(corners)</div>
<div class="line"><span class="lineno"> 2566</span>            kp_corners, kp_des = sift.compute(img, kp_corners)</div>
<div class="line"><span class="lineno"> 2567</span>            img=cv2.drawKeypoints(img,kp_corners,img)</div>
<div class="line"><span class="lineno"> 2568</span> </div>
<div class="line"><span class="lineno"> 2569</span>            <span class="comment"># Store for later use</span></div>
<div class="line"><span class="lineno"> 2570</span>            image_dict[index] = (kp_corners, kp_des, img, corners)</div>
<div class="line"><span class="lineno"> 2571</span> </div>
<div class="line"><span class="lineno"> 2572</span> </div>
<div class="line"><span class="lineno"> 2573</span> </div>
<div class="line"><span class="lineno"> 2574</span>        matcher = cv2.BFMatcher()</div>
<div class="line"><span class="lineno"> 2575</span>        <span class="comment"># matcher = cv2.DescriptorMatcher_create(cv2.DESCRIPTOR_MATCHER_FLANNBASED)</span></div>
<div class="line"><span class="lineno"> 2576</span>        <span class="comment"># matcher = flann.knnMatch(des1,des2,k=2)</span></div>
<div class="line"><span class="lineno"> 2577</span>        <span class="comment"># FLANN_INDEX_KDTREE = 1</span></div>
<div class="line"><span class="lineno"> 2578</span>        <span class="comment"># index_params = dict(algorithm = FLANN_INDEX_KDTREE, trees = 8)</span></div>
<div class="line"><span class="lineno"> 2579</span>        <span class="comment"># search_params = dict(checks = 100)</span></div>
<div class="line"><span class="lineno"> 2580</span>        <span class="comment"># flann = cv2.FlannBasedMatcher(index_params, search_params)</span></div>
<div class="line"><span class="lineno"> 2581</span>        </div>
<div class="line"><span class="lineno"> 2582</span>        print(<span class="stringliteral">&quot;MATCHING&quot;</span>)</div>
<div class="line"><span class="lineno"> 2583</span>        <span class="keywordflow">if</span> key_index <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2584</span>            source_images = image_dict.keys()</div>
<div class="line"><span class="lineno"> 2585</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2586</span>            source_images = [key_index]</div>
<div class="line"><span class="lineno"> 2587</span> </div>
<div class="line"><span class="lineno"> 2588</span>        accumulate = image_dict[source_images[0]][2]</div>
<div class="line"><span class="lineno"> 2589</span>        homographies = []</div>
<div class="line"><span class="lineno"> 2590</span>        <span class="keywordflow">for</span> img_key_1 <span class="keywordflow">in</span> source_images:</div>
<div class="line"><span class="lineno"> 2591</span>            accumulate = image_dict[img_key_1][2]</div>
<div class="line"><span class="lineno"> 2592</span>            <span class="keywordflow">for</span> img_key_2 <span class="keywordflow">in</span> image_dict.keys():</div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span>                <span class="keywordflow">if</span> img_key_1 == img_key_2:</div>
<div class="line"><span class="lineno"> 2595</span>                    <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno"> 2596</span> </div>
<div class="line"><span class="lineno"> 2597</span>                print(image_dict[img_key_1][3].shape)</div>
<div class="line"><span class="lineno"> 2598</span>                d1 = image_dict[img_key_1][1]</div>
<div class="line"><span class="lineno"> 2599</span>                d2 = image_dict[img_key_2][1]</div>
<div class="line"><span class="lineno"> 2600</span> </div>
<div class="line"><span class="lineno"> 2601</span>                kp1 = image_dict[img_key_1][0]</div>
<div class="line"><span class="lineno"> 2602</span>                kp2 = image_dict[img_key_2][0]</div>
<div class="line"><span class="lineno"> 2603</span>                img = image_dict[img_key_2][2]</div>
<div class="line"><span class="lineno"> 2604</span>                matches = matcher.knnMatch(d1,d2, k=2)</div>
<div class="line"><span class="lineno"> 2605</span>                <span class="comment"># matches = flann.knnMatch(d1,d2, k=2)</span></div>
<div class="line"><span class="lineno"> 2606</span>                <span class="keywordflow">for</span> m <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno"> 2607</span>                    print(m[0].distance)</div>
<div class="line"><span class="lineno"> 2608</span> </div>
<div class="line"><span class="lineno"> 2609</span>                good = []</div>
<div class="line"><span class="lineno"> 2610</span>                <span class="keywordflow">for</span> m,n <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno"> 2611</span>                    <span class="keywordflow">if</span> m.distance &lt; 0.4*n.distance:</div>
<div class="line"><span class="lineno"> 2612</span>                        good.append(m)</div>
<div class="line"><span class="lineno"> 2613</span>                </div>
<div class="line"><span class="lineno"> 2614</span> </div>
<div class="line"><span class="lineno"> 2615</span>                dst_pts = np.float32([ kp1[m.queryIdx].pt <span class="keywordflow">for</span> m <span class="keywordflow">in</span> good ]).reshape(-1,1,2)</div>
<div class="line"><span class="lineno"> 2616</span>                src_pts = np.float32([ kp2[m.trainIdx].pt <span class="keywordflow">for</span> m <span class="keywordflow">in</span> good ]).reshape(-1,1,2)</div>
<div class="line"><span class="lineno"> 2617</span>                </div>
<div class="line"><span class="lineno"> 2618</span>                </div>
<div class="line"><span class="lineno"> 2619</span>                <span class="comment"># Sort them in the order of their distance.</span></div>
<div class="line"><span class="lineno"> 2620</span>                matches = sorted(matches, key = <span class="keyword">lambda</span> x:x[0].distance)</div>
<div class="line"><span class="lineno"> 2621</span> </div>
<div class="line"><span class="lineno"> 2622</span>                <span class="comment"># print(matches)</span></div>
<div class="line"><span class="lineno"> 2623</span>                <span class="comment"># img3 = cv2.drawMatchesKnn(image_dict[img_key_1][2], image_dict[img_key_1][0],</span></div>
<div class="line"><span class="lineno"> 2624</span>                <span class="comment">#                         image_dict[img_key_2][2], image_dict[img_key_2][0],</span></div>
<div class="line"><span class="lineno"> 2625</span>                <span class="comment">#                         matches[:10],</span></div>
<div class="line"><span class="lineno"> 2626</span>                <span class="comment">#                         None,flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)</span></div>
<div class="line"><span class="lineno"> 2627</span>                <span class="comment"># cv2.imshow(&quot;homography&quot;, img3)</span></div>
<div class="line"><span class="lineno"> 2628</span>                </div>
<div class="line"><span class="lineno"> 2629</span> </div>
<div class="line"><span class="lineno"> 2630</span> </div>
<div class="line"><span class="lineno"> 2631</span>                <span class="comment"># RHO = [Bazargani15]. (weighted RANSAC modification, faster in the case of many outliers)</span></div>
<div class="line"><span class="lineno"> 2632</span>                M, mask = cv2.findHomography(src_pts, dst_pts, cv2.RHO, 10.0)</div>
<div class="line"><span class="lineno"> 2633</span>                homographies.append((M,mask))</div>
<div class="line"><span class="lineno"> 2634</span>                h,w, _ = img.shape</div>
<div class="line"><span class="lineno"> 2635</span>                result = cv2.warpPerspective(image_dict[img_key_2][2], M,(w, h))</div>
<div class="line"><span class="lineno"> 2636</span>                print(h)</div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span>                accumulate = cv2.addWeighted(accumulate,0.8,result,0.4,0)</div>
<div class="line"><span class="lineno"> 2639</span> </div>
<div class="line"><span class="lineno"> 2640</span>        <span class="comment"># cv2.imshow(&quot;warped&quot;, accumulate)</span></div>
<div class="line"><span class="lineno"> 2641</span>        <span class="comment"># cv2.waitKey(0)</span></div>
<div class="line"><span class="lineno"> 2642</span>        <span class="keywordflow">return</span> accumulate, homographies</div>
<div class="line"><span class="lineno"> 2643</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00142.html#adcab0c33567748a21cfc4a90e663c1d6">CameraPosition.collect_frames()</a>, <a class="el" href="a00206.html#a048722841bc8d71bae4a1e4a9eb9db00">room_estimation.collect_frames()</a>, and <a class="el" href="a00206.html#abd979a29c40c64a598514d7d165bb4a9">room_estimation.undistort_room()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_adbe2f98b84513775c3106191f2845ed3_cgraph.png" border="0" usemap="#aa00206_adbe2f98b84513775c3106191f2845ed3_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a75031a34aadd8c7847c479a17524e00e" name="a75031a34aadd8c7847c479a17524e00e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75031a34aadd8c7847c479a17524e00e">&#9670;&#160;</a></span>stitch_trackers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">stitch_trackers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>video_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>homography_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_csv</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>offsets</em> = <code>[0,0,0,0]</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">returns a list of trackers
# offset = [top, left, bottom, right] in pixels

We correct offsets if top and left edges are extended
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2644</span>    <span class="keyword">def </span>stitch_trackers(self, video_list, homography_list, use_csv=True, offsets=[0,0,0,0]):</div>
<div class="line"><span class="lineno"> 2645</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2646</span><span class="stringliteral">        returns a list of trackers</span></div>
<div class="line"><span class="lineno"> 2647</span><span class="stringliteral">        # offset = [top, left, bottom, right] in pixels</span></div>
<div class="line"><span class="lineno"> 2648</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2649</span><span class="stringliteral">        We correct offsets if top and left edges are extended</span></div>
<div class="line"><span class="lineno"> 2650</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2651</span> </div>
<div class="line"><span class="lineno"> 2652</span>        dataframe_list = []</div>
<div class="line"><span class="lineno"> 2653</span>        <span class="keywordflow">for</span> index, video <span class="keywordflow">in</span> enumerate(video_list):</div>
<div class="line"><span class="lineno"> 2654</span>            data_path = str(video[:-3] + <span class="stringliteral">&#39;csv&#39;</span>)</div>
<div class="line"><span class="lineno"> 2655</span>            image = self.collect_frames(video,1,1,2)[0]</div>
<div class="line"><span class="lineno"> 2656</span>            <span class="comment"># Load data</span></div>
<div class="line"><span class="lineno"> 2657</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2658</span>                data = self.load_tracker(data_path)</div>
<div class="line"><span class="lineno"> 2659</span>            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2660</span>                print(e)</div>
<div class="line"><span class="lineno"> 2661</span>                print(<span class="stringliteral">&quot;Skipping Data&quot;</span>)</div>
<div class="line"><span class="lineno"> 2662</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno"> 2663</span> </div>
<div class="line"><span class="lineno"> 2664</span>            offset_top = offsets[0]</div>
<div class="line"><span class="lineno"> 2665</span>            offset_left = offsets[1]</div>
<div class="line"><span class="lineno"> 2666</span>            </div>
<div class="line"><span class="lineno"> 2667</span>            <span class="comment"># Undistort data</span></div>
<div class="line"><span class="lineno"> 2668</span>            data = self.undistort_tracker_data(data, image)</div>
<div class="line"><span class="lineno"> 2669</span>            x = data[<span class="stringliteral">&#39;undistorted_x&#39;</span>].to_numpy() + offset_left</div>
<div class="line"><span class="lineno"> 2670</span>            y = data[<span class="stringliteral">&#39;undistorted_y&#39;</span>].to_numpy() + offset_top</div>
<div class="line"><span class="lineno"> 2671</span>            z = [1] * len(x)</div>
<div class="line"><span class="lineno"> 2672</span>            points = np.vstack((x, y)).T</div>
<div class="line"><span class="lineno"> 2673</span>            points = points.reshape((-1, 1, 2))</div>
<div class="line"><span class="lineno"> 2674</span>            <span class="comment"># points = points.reshape((1,3, len(x)))</span></div>
<div class="line"><span class="lineno"> 2675</span> </div>
<div class="line"><span class="lineno"> 2676</span>            <span class="comment"># No transformation if we have the same image</span></div>
<div class="line"><span class="lineno"> 2677</span>            <span class="keywordflow">if</span> index == 0:</div>
<div class="line"><span class="lineno"> 2678</span>                print(<span class="stringliteral">&quot;NO DISTORTION&quot;</span>)</div>
<div class="line"><span class="lineno"> 2679</span>                Matrix = np.identity(3)</div>
<div class="line"><span class="lineno"> 2680</span>                Maks = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2681</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2682</span>                Matrix, Mask = homography_list[index-1]</div>
<div class="line"><span class="lineno"> 2683</span>            <span class="comment"># a_transformed = np.dot(Matrix, points)</span></div>
<div class="line"><span class="lineno"> 2684</span>            <span class="comment"># print(a_transformed)</span></div>
<div class="line"><span class="lineno"> 2685</span>            <span class="comment"># Note homography_lost[index] = (TransformationMatrix, Mask)</span></div>
<div class="line"><span class="lineno"> 2686</span>            <span class="comment"># Project points with stitched homographies</span></div>
<div class="line"><span class="lineno"> 2687</span>            projected_points = cv2.perspectiveTransform(points, Matrix).T</div>
<div class="line"><span class="lineno"> 2688</span> </div>
<div class="line"><span class="lineno"> 2689</span> </div>
<div class="line"><span class="lineno"> 2690</span>            new_x = projected_points[0][0]</div>
<div class="line"><span class="lineno"> 2691</span>            new_y = projected_points[1][0]</div>
<div class="line"><span class="lineno"> 2692</span> </div>
<div class="line"><span class="lineno"> 2693</span>            data[<span class="stringliteral">&#39;stitched_x&#39;</span>] = new_x</div>
<div class="line"><span class="lineno"> 2694</span>            data[<span class="stringliteral">&#39;stitched_y&#39;</span>] = new_y</div>
<div class="line"><span class="lineno"> 2695</span> </div>
<div class="line"><span class="lineno"> 2696</span>            print(data)</div>
<div class="line"><span class="lineno"> 2697</span> </div>
<div class="line"><span class="lineno"> 2698</span>            dataframe_list.append(data)</div>
<div class="line"><span class="lineno"> 2699</span>            </div>
<div class="line"><span class="lineno"> 2700</span> </div>
<div class="line"><span class="lineno"> 2701</span>        <span class="keywordflow">return</span> dataframe_list</div>
<div class="line"><span class="lineno"> 2702</span> </div>
<div class="line"><span class="lineno"> 2703</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00142.html#adcab0c33567748a21cfc4a90e663c1d6">CameraPosition.collect_frames()</a>, <a class="el" href="a00206.html#a048722841bc8d71bae4a1e4a9eb9db00">room_estimation.collect_frames()</a>, <a class="el" href="a00206.html#a444510358faa06884318d1ebe94846ff">room_estimation.load_tracker()</a>, and room_estimation.undistort_tracker_data().</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a75031a34aadd8c7847c479a17524e00e_cgraph.png" border="0" usemap="#aa00206_a75031a34aadd8c7847c479a17524e00e_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="abeac4cbae89aef891cee148cbbbc6232" name="abeac4cbae89aef891cee148cbbbc6232"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeac4cbae89aef891cee148cbbbc6232">&#9670;&#160;</a></span>superimpose_checker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">superimpose_checker </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>21</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This draws the grid from "define_perspective_grid" onto an image. 

This grid is given a "size" that is the number of lines present. 
This function utilizes draw_grid which is a 1080x1080 resolution image with cv2.lines drawn on it.

This grid image is then registered onto defined points from "define_perspective_grid" given the homograpy.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1529</span>    <span class="keyword">def </span>superimpose_checker(self, size=21):</div>
<div class="line"><span class="lineno"> 1530</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1531</span><span class="stringliteral">        This draws the grid from &quot;define_perspective_grid&quot; onto an image. </span></div>
<div class="line"><span class="lineno"> 1532</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1533</span><span class="stringliteral">        This grid is given a &quot;size&quot; that is the number of lines present. </span></div>
<div class="line"><span class="lineno"> 1534</span><span class="stringliteral">        This function utilizes draw_grid which is a 1080x1080 resolution image with cv2.lines drawn on it.</span></div>
<div class="line"><span class="lineno"> 1535</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1536</span><span class="stringliteral">        This grid image is then registered onto defined points from &quot;define_perspective_grid&quot; given the homograpy.</span></div>
<div class="line"><span class="lineno"> 1537</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1538</span>        </div>
<div class="line"><span class="lineno"> 1539</span>        temp = deepcopy(self.image)</div>
<div class="line"><span class="lineno"> 1540</span>        <span class="comment"># grid = cv2.imread(&quot;K:/Github/PeopleTracker/Grid.jpg&quot;)</span></div>
<div class="line"><span class="lineno"> 1541</span>        print(<span class="stringliteral">&quot;\n \n Creating Grid...&quot;</span>)</div>
<div class="line"><span class="lineno"> 1542</span>        corners = self.get_room_corners()</div>
<div class="line"><span class="lineno"> 1543</span> </div>
<div class="line"><span class="lineno"> 1544</span>        grid = self.draw_grid()</div>
<div class="line"><span class="lineno"> 1545</span>        h, w, _ = grid.shape</div>
<div class="line"><span class="lineno"> 1546</span>        src = np.array(((0,0), (w-1,0), (w-1,h-1), (0,h-1)))</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>        h, status = cv2.findHomography(src, corners)</div>
<div class="line"><span class="lineno"> 1549</span>        self.clear_corners()</div>
<div class="line"><span class="lineno"> 1550</span>        print(<span class="stringliteral">&quot;+/- to change grid, Q to quit.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1551</span>        <span class="keywordflow">while</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno"> 1552</span>            grid = self.draw_grid(grid_shape=(size,size))</div>
<div class="line"><span class="lineno"> 1553</span>            registered = cv2.warpPerspective(grid, h, (temp.shape[1], temp.shape[0]))</div>
<div class="line"><span class="lineno"> 1554</span>            registered = cv2.addWeighted(temp,1,registered,0.3,0)</div>
<div class="line"><span class="lineno"> 1555</span>            cv2.imshow(<span class="stringliteral">&quot;Registered&quot;</span>, registered)</div>
<div class="line"><span class="lineno"> 1556</span>            k = cv2.waitKey(1)</div>
<div class="line"><span class="lineno"> 1557</span>            <span class="keywordflow">if</span> k == ord(<span class="stringliteral">&quot;=&quot;</span>):</div>
<div class="line"><span class="lineno"> 1558</span>                size += 1</div>
<div class="line"><span class="lineno"> 1559</span>            <span class="keywordflow">if</span> k == ord(<span class="stringliteral">&#39;-&#39;</span>):</div>
<div class="line"><span class="lineno"> 1560</span>                size -= 1</div>
<div class="line"><span class="lineno"> 1561</span>            <span class="keywordflow">if</span> k == ord(<span class="stringliteral">&#39;q&#39;</span>):</div>
<div class="line"><span class="lineno"> 1562</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1563</span> </div>
<div class="line"><span class="lineno"> 1564</span>            </div>
<div class="line"><span class="lineno"> 1565</span> </div>
<div class="line"><span class="lineno"> 1566</span>        <span class="keywordflow">return</span> registered</div>
<div class="line"><span class="lineno"> 1567</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.clear_corners(), room_estimation.draw_grid(), <a class="el" href="a00206.html#a1cc866ee6a78b68a77485eb1eb0f00ba">room_estimation.get_room_corners()</a>, App.image, room_estimation.image, and person_tab.image.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_abeac4cbae89aef891cee148cbbbc6232_cgraph.png" border="0" usemap="#aa00206_abeac4cbae89aef891cee148cbbbc6232_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="abd979a29c40c64a598514d7d165bb4a9" name="abd979a29c40c64a598514d7d165bb4a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd979a29c40c64a598514d7d165bb4a9">&#9670;&#160;</a></span>undistort_room()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">undistort_room </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points_data</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>camera_matrix</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distortion</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>show</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fisheye</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>calibration_resolution</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment"></pre> <div class="fragment"><div class="line"><span class="lineno"> 1953</span>    <span class="keyword">def </span>undistort_room(self, image=None, points_data=None, camera_matrix=None, distortion=None, show=False, fisheye=False, calibration_resolution=None):</div>
<div class="line"><span class="lineno"> 1954</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1955</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1956</span>        <span class="keywordflow">if</span> camera_matrix <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1957</span>            camera_matrix = self.camera_matrix</div>
<div class="line"><span class="lineno"> 1958</span>        <span class="keywordflow">if</span> distortion <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1959</span>            distortion = self.distioriton_matrix</div>
<div class="line"><span class="lineno"> 1960</span> </div>
<div class="line"><span class="lineno"> 1961</span>        <span class="keywordflow">if</span> image <span class="keywordflow">is</span> <span class="keywordtype">None</span>: </div>
<div class="line"><span class="lineno"> 1962</span>            image = self.image</div>
<div class="line"><span class="lineno"> 1963</span>        </div>
<div class="line"><span class="lineno"> 1964</span>        <span class="keywordflow">if</span> calibration_resolution <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1965</span>            calibration_resolution = self.calibration_resolution</div>
<div class="line"><span class="lineno"> 1966</span>        </div>
<div class="line"><span class="lineno"> 1967</span>        width = image.shape[1]</div>
<div class="line"><span class="lineno"> 1968</span>        height = image.shape[0]</div>
<div class="line"><span class="lineno"> 1969</span> </div>
<div class="line"><span class="lineno"> 1970</span>        </div>
<div class="line"><span class="lineno"> 1971</span>        <span class="keywordflow">if</span> fisheye:</div>
<div class="line"><span class="lineno"> 1972</span>            img_dim = image.shape[:2][::-1]  </div>
<div class="line"><span class="lineno"> 1973</span>            scaled_K = camera_matrix * img_dim[0] / width</div>
<div class="line"><span class="lineno"> 1974</span>            scaled_K[2][2] = 1.0  </div>
<div class="line"><span class="lineno"> 1975</span> </div>
<div class="line"><span class="lineno"> 1976</span>            <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1977</span><span class="stringliteral">            new_K = cv2.fisheye.estimateNewCameraMatrixForUndistortRectify(scaled_K, distortion,</span></div>
<div class="line"><span class="lineno"> 1978</span><span class="stringliteral">                                                                        img_dim, np.eye(3), balance=0, fov_scale=1)</span></div>
<div class="line"><span class="lineno"> 1979</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1980</span><span class="stringliteral">            map1, map2 = cv2.fisheye.initUndistortRectifyMap(scaled_K, distortion, np.eye(3),</span></div>
<div class="line"><span class="lineno"> 1981</span><span class="stringliteral">                                                                    new_K, img_dim, cv2.CV_16SC2)</span></div>
<div class="line"><span class="lineno"> 1982</span><span class="stringliteral">            undistorted_image = cv2.remap(image, map1, map2, interpolation=cv2.INTER_LINEAR, borderMode=cv2.BORDER_CONSTANT)</span></div>
<div class="line"><span class="lineno"> 1983</span><span class="stringliteral">            &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span>            <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1986</span><span class="stringliteral">            # New Camera matrix is </span></div>
<div class="line"><span class="lineno"> 1987</span><span class="stringliteral">            newcameramatrix = cv2.fisheye.estimateNewCameraMatrixForUndistortRectify(camera_matrix, distortion, img_dim, np.eye(3), balance=0, fov_scale=1)</span></div>
<div class="line"><span class="lineno"> 1988</span><span class="stringliteral">            undistorted_image = cv2.fisheye.undistortImage(image, camera_matrix, distortion, None, newcameramatrix)         </span></div>
<div class="line"><span class="lineno"> 1989</span><span class="stringliteral">            &#39;&#39;&#39;</span>             </div>
<div class="line"><span class="lineno"> 1990</span>            <span class="comment"># &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1991</span>            map1, map2 = cv2.fisheye.initUndistortRectifyMap(camera_matrix, distortion, np.eye(3), camera_matrix, (width,height), cv2.CV_16SC2)</div>
<div class="line"><span class="lineno"> 1992</span>            undistorted_image = cv2.remap(image, map1, map2, interpolation=cv2.INTER_LINEAR, borderMode=cv2.BORDER_CONSTANT)</div>
<div class="line"><span class="lineno"> 1993</span>            <span class="comment"># &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 1994</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1995</span>            <span class="comment"># self.image.shape[1]</span></div>
<div class="line"><span class="lineno"> 1996</span>            <span class="comment"># h1, w1, _ = image.shape</span></div>
<div class="line"><span class="lineno"> 1997</span>            <span class="comment"># #Account for resolution differences between calibration and image input</span></div>
<div class="line"><span class="lineno"> 1998</span>            <span class="comment"># w_ratio, h_ratio = self.get_calibration_ratio((w1,h1), calibration_resolution)</span></div>
<div class="line"><span class="lineno"> 1999</span>            <span class="comment"># print(w_ratio, h_ratio)</span></div>
<div class="line"><span class="lineno"> 2000</span> </div>
<div class="line"><span class="lineno"> 2001</span>            <span class="comment"># camera_matrix[0][0] = camera_matrix[0][0] * w_ratio</span></div>
<div class="line"><span class="lineno"> 2002</span>            <span class="comment"># camera_matrix[1][1] = camera_matrix[1][1] * h_ratio</span></div>
<div class="line"><span class="lineno"> 2003</span>            <span class="comment"># camera_matrix[0][2] = camera_matrix[0][2] * w_ratio</span></div>
<div class="line"><span class="lineno"> 2004</span>            <span class="comment"># camera_matrix[1][2] = camera_matrix[1][2] * h_ratio</span></div>
<div class="line"><span class="lineno"> 2005</span> </div>
<div class="line"><span class="lineno"> 2006</span>            <span class="comment"># for index, d in enumerate(distortion[0]):</span></div>
<div class="line"><span class="lineno"> 2007</span>            <span class="comment">#     distortion[0][index] = [0][index] * w_ratio</span></div>
<div class="line"><span class="lineno"> 2008</span>            </div>
<div class="line"><span class="lineno"> 2009</span>            newcameramatrix, _ = cv2.getOptimalNewCameraMatrix(camera_matrix, distortion, (width, height), 1, (width, height))</div>
<div class="line"><span class="lineno"> 2010</span>            <span class="keywordflow">if</span> points_data <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2011</span> </div>
<div class="line"><span class="lineno"> 2012</span> </div>
<div class="line"><span class="lineno"> 2013</span>                <span class="comment">#NOTE Solution to this being wrong, we should just calibrate the camera in the same resolution as our videos</span></div>
<div class="line"><span class="lineno"> 2014</span>                x = data[<span class="stringliteral">&#39;Pixel_Loc_x&#39;</span>].to_numpy()</div>
<div class="line"><span class="lineno"> 2015</span>                y = data[<span class="stringliteral">&#39;Pixel_Loc_y&#39;</span>].to_numpy()</div>
<div class="line"><span class="lineno"> 2016</span>                points = np.vstack((y, x)).T</div>
<div class="line"><span class="lineno"> 2017</span> </div>
<div class="line"><span class="lineno"> 2018</span>                <span class="comment"># d2 = distortion</span></div>
<div class="line"><span class="lineno"> 2019</span>                <span class="comment"># for index, d in enumerate(distortion[0]):</span></div>
<div class="line"><span class="lineno"> 2020</span>                <span class="comment"># d2 = distortion[0] * w_ratio</span></div>
<div class="line"><span class="lineno"> 2021</span> </div>
<div class="line"><span class="lineno"> 2022</span>                pts_r_norm = cv2.undistortPoints(points, camera_matrix, distortion, <span class="keywordtype">None</span>, newcameramatrix)</div>
<div class="line"><span class="lineno"> 2023</span> </div>
<div class="line"><span class="lineno"> 2024</span>                new_x = pts_r_norm.T[1]</div>
<div class="line"><span class="lineno"> 2025</span>                new_y = pts_r_norm.T[0]</div>
<div class="line"><span class="lineno"> 2026</span> </div>
<div class="line"><span class="lineno"> 2027</span>                data[<span class="stringliteral">&#39;undistorted_x&#39;</span>] = new_x[0].tolist()</div>
<div class="line"><span class="lineno"> 2028</span>                data[<span class="stringliteral">&#39;undistorted_y&#39;</span>] = new_y[0].tolist()</div>
<div class="line"><span class="lineno"> 2029</span>                self.points_data = data</div>
<div class="line"><span class="lineno"> 2030</span>            undistorted_image = cv2.undistort(image, camera_matrix, distortion, <span class="keywordtype">None</span>, newcameramatrix)</div>
<div class="line"><span class="lineno"> 2031</span> </div>
<div class="line"><span class="lineno"> 2032</span> </div>
<div class="line"><span class="lineno"> 2033</span> </div>
<div class="line"><span class="lineno"> 2034</span> </div>
<div class="line"><span class="lineno"> 2035</span>            <span class="comment"># if show:</span></div>
<div class="line"><span class="lineno"> 2036</span>            <span class="comment">#     cv2.imshow(&quot;undistorted&quot;, undistorted_image)</span></div>
<div class="line"><span class="lineno"> 2037</span>            <span class="comment">#     cv2.waitKey(0)</span></div>
<div class="line"><span class="lineno"> 2038</span> </div>
<div class="line"><span class="lineno"> 2039</span>        <span class="keywordflow">if</span> show:</div>
<div class="line"><span class="lineno"> 2040</span>            cv2.imshow(<span class="stringliteral">&quot;undistorted&quot;</span>, undistorted_image)</div>
<div class="line"><span class="lineno"> 2041</span>            cv2.waitKey(0)</div>
<div class="line"><span class="lineno"> 2042</span>        <span class="keywordflow">return</span> undistorted_image</div>
<div class="line"><span class="lineno"> 2043</span> </div>
</div><!-- fragment -->
<p class="reference">References room_estimation.calibration_resolution, room_estimation.camera_matrix, room_estimation.distioriton_matrix, App.image, room_estimation.image, person_tab.image, and room_estimation.points_data.</p>

<p class="reference">Referenced by <a class="el" href="a00206.html#a2a5df656a4b4d07c05b290f8197c316f">room_estimation.save_room()</a>, and <a class="el" href="a00206.html#adbe2f98b84513775c3106191f2845ed3">room_estimation.stitch_rooms()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_abd979a29c40c64a598514d7d165bb4a9_icgraph.png" border="0" usemap="#aa00206_abd979a29c40c64a598514d7d165bb4a9_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a66fa5cbb4e0e7ce0bfa08b4b5e14482f" name="a66fa5cbb4e0e7ce0bfa08b4b5e14482f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66fa5cbb4e0e7ce0bfa08b4b5e14482f">&#9670;&#160;</a></span>undistort_tracker_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">undistort_tracker_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>camera_matrix</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distortion</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2044</span>    <span class="keyword">def </span>undistort_tracker_data(self,data, image=None, camera_matrix=None, distortion=None):</div>
<div class="line"><span class="lineno"> 2045</span>        <span class="keywordflow">if</span> camera_matrix <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2046</span>            camera_matrix = self.camera_matrix</div>
<div class="line"><span class="lineno"> 2047</span>        <span class="keywordflow">if</span> distortion <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2048</span>            distortion = self.distioriton_matrix</div>
<div class="line"><span class="lineno"> 2049</span>        </div>
<div class="line"><span class="lineno"> 2050</span>        <span class="keywordflow">if</span> image <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2051</span>            image = self.image</div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span>        <span class="comment">#Image dimensions</span></div>
<div class="line"><span class="lineno"> 2054</span>        width = image.shape[1]</div>
<div class="line"><span class="lineno"> 2055</span>        height = image.shape[0]</div>
<div class="line"><span class="lineno"> 2056</span> </div>
<div class="line"><span class="lineno"> 2057</span> </div>
<div class="line"><span class="lineno"> 2058</span>        x = data[<span class="stringliteral">&#39;Pixel_Loc_x&#39;</span>].to_numpy()</div>
<div class="line"><span class="lineno"> 2059</span>        y = data[<span class="stringliteral">&#39;Pixel_Loc_y&#39;</span>].to_numpy()</div>
<div class="line"><span class="lineno"> 2060</span> </div>
<div class="line"><span class="lineno"> 2061</span>        print((width, height), self.calibration_resolution)</div>
<div class="line"><span class="lineno"> 2062</span> </div>
<div class="line"><span class="lineno"> 2063</span> </div>
<div class="line"><span class="lineno"> 2064</span>        points = np.vstack((y, x)).T</div>
<div class="line"><span class="lineno"> 2065</span>        </div>
<div class="line"><span class="lineno"> 2066</span>        <span class="comment"># h1, w1, _ = image.shape</span></div>
<div class="line"><span class="lineno"> 2067</span>        <span class="comment"># # Account for resolution differences between calibration and image input</span></div>
<div class="line"><span class="lineno"> 2068</span>        <span class="comment"># w_ratio, h_ratio = self.get_calibration_ratio((w1,h1), self.calibration_resolution)</span></div>
<div class="line"><span class="lineno"> 2069</span>        <span class="comment"># print(w_ratio, h_ratio)</span></div>
<div class="line"><span class="lineno"> 2070</span> </div>
<div class="line"><span class="lineno"> 2071</span>        <span class="comment"># camera_matrix[0][0] = camera_matrix[0][0] * w_ratio</span></div>
<div class="line"><span class="lineno"> 2072</span>        <span class="comment"># camera_matrix[1][1] = camera_matrix[1][1] * h_ratio</span></div>
<div class="line"><span class="lineno"> 2073</span>        <span class="comment"># camera_matrix[0][2] = camera_matrix[0][2] * w_ratio</span></div>
<div class="line"><span class="lineno"> 2074</span>        <span class="comment"># camera_matrix[1][2] = camera_matrix[1][2] * h_ratio</span></div>
<div class="line"><span class="lineno"> 2075</span> </div>
<div class="line"><span class="lineno"> 2076</span>        newcameramatrix, _ = cv2.getOptimalNewCameraMatrix(camera_matrix, distortion, (width, height), 1, (width, height))</div>
<div class="line"><span class="lineno"> 2077</span>        <span class="comment"># numpy_points = np.reshape(np.asfarray(points), (len(points),2,1))</span></div>
<div class="line"><span class="lineno"> 2078</span> </div>
<div class="line"><span class="lineno"> 2079</span> </div>
<div class="line"><span class="lineno"> 2080</span> </div>
<div class="line"><span class="lineno"> 2081</span>        pts_r_norm = cv2.undistortPoints(points, camera_matrix, distortion, <span class="keywordtype">None</span>, newcameramatrix)</div>
<div class="line"><span class="lineno"> 2082</span> </div>
<div class="line"><span class="lineno"> 2083</span>        new_x = pts_r_norm.T[1]</div>
<div class="line"><span class="lineno"> 2084</span>        new_y = pts_r_norm.T[0]</div>
<div class="line"><span class="lineno"> 2085</span> </div>
<div class="line"><span class="lineno"> 2086</span> </div>
<div class="line"><span class="lineno"> 2087</span>        data[<span class="stringliteral">&#39;undistorted_x&#39;</span>] = new_x[0].tolist()</div>
<div class="line"><span class="lineno"> 2088</span>        data[<span class="stringliteral">&#39;undistorted_y&#39;</span>] = new_y[0].tolist()</div>
<div class="line"><span class="lineno"> 2089</span> </div>
<div class="line"><span class="lineno"> 2090</span>        <span class="comment"># for i in range(new_x.shape[0]):</span></div>
<div class="line"><span class="lineno"> 2091</span>        <span class="comment">#     # print(&#39;showing&#39;)</span></div>
<div class="line"><span class="lineno"> 2092</span>        <span class="comment">#     p = (int(new_x[0][i]),int(new_y[0][i]))</span></div>
<div class="line"><span class="lineno"> 2093</span>        <span class="comment">#     cv2.circle(self.show_img,p,1,color=(0,255,255), thickness=4)</span></div>
<div class="line"><span class="lineno"> 2094</span>        <span class="comment"># cv2.imshow(&quot;Projected&quot;, self.show_img)</span></div>
<div class="line"><span class="lineno"> 2095</span>        <span class="comment"># cv2.waitKey(0)</span></div>
<div class="line"><span class="lineno"> 2096</span> </div>
<div class="line"><span class="lineno"> 2097</span>        <span class="keywordflow">return</span> data</div>
<div class="line"><span class="lineno"> 2098</span> </div>
<div class="line"><span class="lineno"> 2099</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a75031a34aadd8c7847c479a17524e00e">room_estimation.stitch_trackers()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a66fa5cbb4e0e7ce0bfa08b4b5e14482f_icgraph.png" border="0" usemap="#aa00206_a66fa5cbb4e0e7ce0bfa08b4b5e14482f_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a0bd7f71bd75e917a01563ad8dce62565" name="a0bd7f71bd75e917a01563ad8dce62565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bd7f71bd75e917a01563ad8dce62565">&#9670;&#160;</a></span>update_tracker_3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_tracker_3D </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mapped_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mapped_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Updates the already created plot with new data
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2140</span>    <span class="keyword">def </span>update_tracker_3D(self,index, df, mapped_min, mapped_max):</div>
<div class="line"><span class="lineno"> 2141</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2142</span><span class="stringliteral">        Updates the already created plot with new data</span></div>
<div class="line"><span class="lineno"> 2143</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2144</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c6c06bc8bbf8a0f9f7237a97ff9487e" name="a6c6c06bc8bbf8a0f9f7237a97ff9487e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6c06bc8bbf8a0f9f7237a97ff9487e">&#9670;&#160;</a></span>visualize_distortion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">visualize_distortion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>camera_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distiortion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">https://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#void%20projectPoints(InputArray%20objectPoints,%20InputArray%20rvec,%20InputArray%20tvec,%20InputArray%20cameraMatrix,%20InputArray%20distCoeffs,%20OutputArray%20imagePoints,%20OutputArray%20jacobian,%20double%20aspectRatio)

opencv 3 here: 
https://docs.opencv.org/4.x/dc/dbb/tutorial_py_calibration.html

[x] =  [X]
[y] = R[Y] + t
[z] =  [Z]

x' = x/z
y' = y/z

NOTE: k1-6 are radial distortion coefficients, p1 and p2 are tangential distortion
        if any 

x'' = x' (1 + k1 * r^2+k2 + k3*r^4 + k3*r^6)/ + 2*p1*x'*y' + p2(r^2 + (2x')^2)
         (1 + k4 * r^2+k5 + k3*r^4 + k6*r^6)

y'' = y' (1 + k1 * r^2+k2 + k3*r^4 + k3*r^6)/ + p1(r^2 + (2y')^2) + 2*p2 * x' * y'
         (1 + k4 * r^2+k5 + k3*r^4 + k6*r^6)

r^2 = x'^2 + y'^2
u = fx * x'' + cx
v = fy * y'' + cy
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2327</span>    <span class="keyword">def </span>visualize_distortion(self, camera_matrix, distiortion, image=None):</div>
<div class="line"><span class="lineno"> 2328</span>        <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2329</span><span class="stringliteral">        https://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#void%20projectPoints(InputArray%20objectPoints,%20InputArray%20rvec,%20InputArray%20tvec,%20InputArray%20cameraMatrix,%20InputArray%20distCoeffs,%20OutputArray%20imagePoints,%20OutputArray%20jacobian,%20double%20aspectRatio)</span></div>
<div class="line"><span class="lineno"> 2330</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2331</span><span class="stringliteral">        opencv 3 here: </span></div>
<div class="line"><span class="lineno"> 2332</span><span class="stringliteral">        https://docs.opencv.org/4.x/dc/dbb/tutorial_py_calibration.html</span></div>
<div class="line"><span class="lineno"> 2333</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2334</span><span class="stringliteral">        [x] =  [X]</span></div>
<div class="line"><span class="lineno"> 2335</span><span class="stringliteral">        [y] = R[Y] + t</span></div>
<div class="line"><span class="lineno"> 2336</span><span class="stringliteral">        [z] =  [Z]</span></div>
<div class="line"><span class="lineno"> 2337</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2338</span><span class="stringliteral">        x&#39; = x/z</span></div>
<div class="line"><span class="lineno"> 2339</span><span class="stringliteral">        y&#39; = y/z</span></div>
<div class="line"><span class="lineno"> 2340</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2341</span><span class="stringliteral">        NOTE: k1-6 are radial distortion coefficients, p1 and p2 are tangential distortion</span></div>
<div class="line"><span class="lineno"> 2342</span><span class="stringliteral">                if any </span></div>
<div class="line"><span class="lineno"> 2343</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2344</span><span class="stringliteral">        x&#39;&#39; = x&#39; (1 + k1 * r^2+k2 + k3*r^4 + k3*r^6)/ + 2*p1*x&#39;*y&#39; + p2(r^2 + (2x&#39;)^2)</span></div>
<div class="line"><span class="lineno"> 2345</span><span class="stringliteral">                 (1 + k4 * r^2+k5 + k3*r^4 + k6*r^6)</span></div>
<div class="line"><span class="lineno"> 2346</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2347</span><span class="stringliteral">        y&#39;&#39; = y&#39; (1 + k1 * r^2+k2 + k3*r^4 + k3*r^6)/ + p1(r^2 + (2y&#39;)^2) + 2*p2 * x&#39; * y&#39;</span></div>
<div class="line"><span class="lineno"> 2348</span><span class="stringliteral">                 (1 + k4 * r^2+k5 + k3*r^4 + k6*r^6)</span></div>
<div class="line"><span class="lineno"> 2349</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2350</span><span class="stringliteral">        r^2 = x&#39;^2 + y&#39;^2</span></div>
<div class="line"><span class="lineno"> 2351</span><span class="stringliteral">        u = fx * x&#39;&#39; + cx</span></div>
<div class="line"><span class="lineno"> 2352</span><span class="stringliteral">        v = fy * y&#39;&#39; + cy</span></div>
<div class="line"><span class="lineno"> 2353</span><span class="stringliteral">        &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2354</span>        <span class="keywordflow">if</span> image <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2355</span>            image = self.image</div>
<div class="line"><span class="lineno"> 2356</span>        </div>
<div class="line"><span class="lineno"> 2357</span>        height, width, _ = image.shape</div>
<div class="line"><span class="lineno"> 2358</span>        nstep = 20</div>
<div class="line"><span class="lineno"> 2359</span>        d = list(distiortion[0])</div>
<div class="line"><span class="lineno"> 2360</span>        <span class="comment"># print(d)</span></div>
<div class="line"><span class="lineno"> 2361</span>        k1, k2, p1, p2, k3, k4, k5, k6, s1, s2, s3, s4, taux, tauy = list(distiortion[0])</div>
<div class="line"><span class="lineno"> 2362</span>        fx = camera_matrix[0,0]</div>
<div class="line"><span class="lineno"> 2363</span>        fy = camera_matrix[1,1]</div>
<div class="line"><span class="lineno"> 2364</span>        cx = camera_matrix[0,2]</div>
<div class="line"><span class="lineno"> 2365</span>        cy = camera_matrix[1,2]</div>
<div class="line"><span class="lineno"> 2366</span> </div>
<div class="line"><span class="lineno"> 2367</span>        <span class="comment"># Create a grid from the size of the image</span></div>
<div class="line"><span class="lineno"> 2368</span>        uv = np.meshgrid(np.linspace(-width,width-1,nstep), np.linspace(-height,height-1,nstep))</div>
<div class="line"><span class="lineno"> 2369</span>        <span class="comment"># print(uv)</span></div>
<div class="line"><span class="lineno"> 2370</span>        <span class="comment"># NOTE: p stands for prime (&#39;)</span></div>
<div class="line"><span class="lineno"> 2371</span>        u = uv[0]</div>
<div class="line"><span class="lineno"> 2372</span>        v = uv[1]</div>
<div class="line"><span class="lineno"> 2373</span>        z = np.ones(u.shape)</div>
<div class="line"><span class="lineno"> 2374</span>        xp = u / z <span class="comment"># z=1</span></div>
<div class="line"><span class="lineno"> 2375</span>        yp = v / z <span class="comment"># z=1</span></div>
<div class="line"><span class="lineno"> 2376</span> </div>
<div class="line"><span class="lineno"> 2377</span>        <span class="comment"># print(xp, yp)</span></div>
<div class="line"><span class="lineno"> 2378</span> </div>
<div class="line"><span class="lineno"> 2379</span>        r2 = xp ** 2 + yp ** 2</div>
<div class="line"><span class="lineno"> 2380</span>        r4 = r2 ** 2 </div>
<div class="line"><span class="lineno"> 2381</span>        r6 = r2 ** 3</div>
<div class="line"><span class="lineno"> 2382</span>        coef = (1 + k1*r2 + k2*r4 + k3*r6)/(1 + k4*r2 + k5*r4 + k6*r6)</div>
<div class="line"><span class="lineno"> 2383</span>        </div>
<div class="line"><span class="lineno"> 2384</span>        <span class="comment"># print(coef)</span></div>
<div class="line"><span class="lineno"> 2385</span> </div>
<div class="line"><span class="lineno"> 2386</span>        xpp = xp * coef + 2*p1*(xp*yp) + p2*(r2 + 2*xp**2) + s1*r2 + s2*r4</div>
<div class="line"><span class="lineno"> 2387</span>        ypp = yp * coef + p1*(r2 + 2*yp**2) + 2 * p2 * (xp * yp) + s1*r2 + s2*r4</div>
<div class="line"><span class="lineno"> 2388</span> </div>
<div class="line"><span class="lineno"> 2389</span>        x_radial_distortion = xp * (1 + k1*r2 + k2*r4 + k3*r6) <span class="comment"># xp</span></div>
<div class="line"><span class="lineno"> 2390</span>        y_radial_distortion = yp * (1 + k1*r2 + k2*r4 + k3*r6) <span class="comment"># yp</span></div>
<div class="line"><span class="lineno"> 2391</span> </div>
<div class="line"><span class="lineno"> 2392</span>        x_tangential_distortion = xp + (2*p1*xp*yp +p2*(r2 + 2*xp**2)) <span class="comment"># xpp</span></div>
<div class="line"><span class="lineno"> 2393</span>        y_tangential_distortion = yp + (p1*(r2 + 2*yp**2) + 2 * p2 * xp * yp) <span class="comment"># ypp</span></div>
<div class="line"><span class="lineno"> 2394</span> </div>
<div class="line"><span class="lineno"> 2395</span> </div>
<div class="line"><span class="lineno"> 2396</span>        u2 = fx * xpp + cx</div>
<div class="line"><span class="lineno"> 2397</span>        v2 = fy * ypp + cy</div>
<div class="line"><span class="lineno"> 2398</span> </div>
<div class="line"><span class="lineno"> 2399</span>        difference_u = u2[:] - u[:]</div>
<div class="line"><span class="lineno"> 2400</span>        difference_v = v2[:] - v[:]</div>
<div class="line"><span class="lineno"> 2401</span> </div>
<div class="line"><span class="lineno"> 2402</span>        <span class="comment"># du, dv = np.meshgrid(difference_u, difference_v)</span></div>
<div class="line"><span class="lineno"> 2403</span>        <span class="comment"># dr = np.reshape(np.hypot(difference_u,difference_v), xp.shape)</span></div>
<div class="line"><span class="lineno"> 2404</span>        dr = np.reshape(np.hypot(difference_u,difference_v), u.shape)</div>
<div class="line"><span class="lineno"> 2405</span>        <span class="comment"># print(dr)</span></div>
<div class="line"><span class="lineno"> 2406</span>        center = (width/2, height/2)</div>
<div class="line"><span class="lineno"> 2407</span>        principal_point = (cx, cy)</div>
<div class="line"><span class="lineno"> 2408</span> </div>
<div class="line"><span class="lineno"> 2409</span>        fix, ax = plt.subplots()</div>
<div class="line"><span class="lineno"> 2410</span>        ax.scatter(center[0], center[1], marker=<span class="stringliteral">&quot;o&quot;</span>)</div>
<div class="line"><span class="lineno"> 2411</span>        ax.scatter(principal_point[0], principal_point[1], marker=<span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><span class="lineno"> 2412</span>        CS = ax.contour(u[1,:]+1, v[:,1]+1, dr)</div>
<div class="line"><span class="lineno"> 2413</span>        <span class="comment"># ax.quiver(u[:]+1, v[:]+1, du, dv)</span></div>
<div class="line"><span class="lineno"> 2414</span>        ax.clabel(CS, fontsize=9, inline=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2415</span>        plt.show()</div>
<div class="line"><span class="lineno"> 2416</span>        <span class="comment"># dr = reshape(hypot(du,dv), size(u));</span></div>
<div class="line"><span class="lineno"> 2417</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00206.html#a2a5df656a4b4d07c05b290f8197c316f">room_estimation.save_room()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00206_a6c6c06bc8bbf8a0f9f7237a97ff9487e_icgraph.png" border="0" usemap="#aa00206_a6c6c06bc8bbf8a0f9f7237a97ff9487e_icgraph" alt=""/></div>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>K:/Github/PeopleTracker/src/<b>room_estimation.py</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>PeopleTracker</b></li><li class="navelem"><b>src</b></li><li class="navelem"><b>room_estimation</b></li><li class="navelem"><a class="el" href="a00206.html">room_estimation</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
