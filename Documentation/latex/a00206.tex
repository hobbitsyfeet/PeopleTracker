\doxysection{room\+\_\+estimation}
\hypertarget{a00206}{}\label{a00206}\index{room\_estimation@{room\_estimation}}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{a00206_a5fe35e96c37a5189461dc200d9860d4b}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, image=None, camera\+\_\+matrix=JUSTIN\+\_\+\+HERO4\+\_\+\+SILVER\+\_\+720\+\_\+\+MEDIUM\+\_\+\+FOV\+\_\+\+MTX, distortion\+\_\+matrix=JUSTIN\+\_\+\+HERO4\+\_\+\+SILVER\+\_\+720\+\_\+\+MEDIUM\+\_\+\+FOV\+\_\+\+DIST, rvecs=JUSTIN\+\_\+\+HERO4\+\_\+\+SILVER\+\_\+720\+\_\+\+MEDIUM\+\_\+\+FOV\+\_\+\+RVEC)
\item 
\mbox{\hyperlink{a00206_a5da847c11e206bbccbe29ec5e042462a}{set\+\_\+image}} (self, image)
\item 
\mbox{\hyperlink{a00206_a61a9f1d7c10c86838c5928c76bb2ca59}{display\+\_\+room}} (self, image=None, axis=True, box=True, show\+\_\+3d\+\_\+plot=True, with\+\_\+points=False)
\item 
\mbox{\hyperlink{a00206_a833c6efe94bd835b3ab82191c47f04fe}{set\+\_\+axis}} (self, x, y, z)
\item 
\mbox{\hyperlink{a00206_acfa65bf2973032f8d2e0e33872634b06}{set\+\_\+corners}} (self, p1=None, p2=None, p3=None, p4=None)
\item 
\mbox{\hyperlink{a00206_af380d3a1fe6a68080691e578d25937b1}{img\+\_\+copy}} (self)
\item 
\mbox{\hyperlink{a00206_a5b5abc31dfc859a8bd979479f51da933}{define\+\_\+sides}} (self, sides, lengths)
\item 
\mbox{\hyperlink{a00206_a84fbd0580af51d4905aeeb1b71889390}{define\+\_\+room}} (self, width=None, length=None, height=None, offset=\mbox{[}0, 0, 0, 0\mbox{]}, corners=None, room\+\_\+points=None, refine\+\_\+corners=False, image=None, stitch\+\_\+videos=None, calibration=None, extend=None)
\item 
\mbox{\hyperlink{a00206_ab0188ed983122bc7494460062c8ca22b}{clear\+\_\+corners}} (self)
\item 
\mbox{\hyperlink{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba}{get\+\_\+room\+\_\+corners}} (self, num\+\_\+points=4)
\item 
\mbox{\hyperlink{a00206_a5e02ad6d52be2fc94cd6f1663ecac18d}{edit\+\_\+room\+\_\+corner}} (self, index, new\+\_\+pixel)
\item 
\mbox{\hyperlink{a00206_ae2c8ef2eee13d8eb75d88c0559626fac}{connect\+\_\+points}} (self, points)
\item 
\mbox{\hyperlink{a00206_a7975986cd4d5ecccaadb6a9a0a521e1e}{get\+\_\+corners}} (self, event, x, y, flags, param)
\item 
\mbox{\hyperlink{a00206_a5f01474eaee314a7013feeaa49685bb9}{get\+\_\+corner\+\_\+with\+\_\+definition}} (self, event, x, y, flags, param)
\item 
\mbox{\hyperlink{a00206_a7bcf809e2d6ba963c04b331f5c53a3a8}{get\+\_\+cube\+\_\+side}} (self, cube, side)
\item 
\mbox{\hyperlink{a00206_a9d5c0b06be5dbf308587eac88c486612}{crop\+\_\+plain}} (self, points, plain\+\_\+width, plain\+\_\+length, image=None)
\item 
\mbox{\hyperlink{a00206_a671eb2401939cdbb1c91570e58d4f7c3}{project\+\_\+points}} (self, points=\mbox{[}$\,$\mbox{]})
\item 
\mbox{\hyperlink{a00206_ab8bb923e853aeed05b8e25def792f5e4}{plot\+\_\+points}} (event, x, y, flags, params)
\item 
\mbox{\hyperlink{a00206_a8277f150767e58ce0824de54928fb184}{get\+\_\+3d\+\_\+to\+\_\+2d}} (self, point, show=True)
\item 
\mbox{\hyperlink{a00206_a52e10ca5ff3f0e459f47e6ccaf82adeb}{get\+\_\+3d\+\_\+point}} (self, pixel, height=1500, camera\+\_\+matrix=None, rotation\+\_\+matrix=None, tvec=None, show\+\_\+point=True)
\item 
\mbox{\hyperlink{a00206_acd30d2c67d090d15947b3abde53e876f}{display\+\_\+3\+D\+\_\+\+Plot}} (points, shown)
\item 
\mbox{\hyperlink{a00206_a6b52f7921f3d60a3a6b7d2dc641aa44c}{draw\+\_\+axis}} (self)
\item 
\mbox{\hyperlink{a00206_aef4827bfb173a05c4794fb8b29ec8055}{draw\+\_\+cuboid}} (self, image=None, distortion=None, rvec=None, tvec=None)
\item 
\mbox{\hyperlink{a00206_a07baa9eba436c81cea0c49e0d5b5099f}{draw\+\_\+box}} (img, corners, imgpts)
\item 
\mbox{\hyperlink{a00206_a9efcb6eeef35186ade72c0bbc5c531fe}{draw\+\_\+point}} (self, img, front\+\_\+pt, back\+\_\+pt)
\item 
\mbox{\hyperlink{a00206_a557b4ac632e812552cc251f7b57b6a6e}{estimate\+\_\+plane}} (img, corners, points, calibration\+\_\+matrix, distortion\+\_\+matrix)
\item 
\mbox{\hyperlink{a00206_a77a48d83bb7e61c5a28680a2de16c11c}{draw\+\_\+vector}} (self, event, x, y, flags, params)
\item 
\mbox{\hyperlink{a00206_a68abc4d3a13c1374dfa93018a57b84be}{get\+\_\+room\+\_\+3d}} (self, limits, height, step, save\+\_\+filename=None)
\item 
\mbox{\hyperlink{a00206_acf8ba8f0370d5371ba8c5a28e3e3d587}{save\+\_\+room\+\_\+3d}} (self, path, filename, mapped)
\item 
\mbox{\hyperlink{a00206_ae66e446204a8676a532acab744601f10}{load\+\_\+room\+\_\+3d}} (self, filename)
\item 
\mbox{\hyperlink{a00206_a62767547824d2f147fc10c5b38f2c725}{get\+\_\+room\+\_\+points}} (self, width, length, height=0)
\item 
\mbox{\hyperlink{a00206_ae29c16a83d737f9e9f2b584ae560ad85}{get\+\_\+n\+\_\+room\+\_\+points}} (self, n\+\_\+locations=None, height=0)
\item 
\mbox{\hyperlink{a00206_a921523998615aa3555a3cb0ca2b36965}{assign\+\_\+non\+\_\+square\+\_\+corners}} (self, num\+\_\+points=inf)
\item 
\mbox{\hyperlink{a00206_a9f82d1ff05b9a54401f4749899cfedb5}{find\+\_\+3d\+\_\+limits}} (self, height=1000)
\item 
\mbox{\hyperlink{a00206_a4446e4e6d7e24976a0eb63a6d7970209}{project\+\_\+point}} (self, event, x, y, flags, params)
\item 
\mbox{\hyperlink{a00206_a8113e0511b9bcb908b6a9aee98cee69b}{get\+\_\+depth}} (self, event, x, y, p1, p2)
\item 
\mbox{\hyperlink{a00206_a3b5b618d6f1cc697a5191f0617a9200a}{estimate}} (self)
\item 
\mbox{\hyperlink{a00206_a0246e47740851d72979f6d5cdc76bf18}{get\+\_\+pixel\+\_\+location}} (self, pixel)
\item 
\mbox{\hyperlink{a00206_a9ddc57e65b6b90133dae37504451b764}{poly\+\_\+fit\+\_\+wall}} (self, samples, pixels\+\_\+past\+\_\+extent=100, horizontal\+\_\+extent=None, degree=2)
\item 
\mbox{\hyperlink{a00206_a54166ae0c7b7f8e5aadcc81eda56ce58}{find\+\_\+intersection}} (self, line\+\_\+equation1, line\+\_\+equation2)
\item 
\mbox{\hyperlink{a00206_a54ccab8062e8ce67319dcd81d75b6d4a}{make\+\_\+interpolater}} (left\+\_\+min, left\+\_\+max, right\+\_\+min, right\+\_\+max)
\item 
\mbox{\hyperlink{a00206_abeac4cbae89aef891cee148cbbbc6232}{superimpose\+\_\+checker}} (self, size=21)
\item 
\mbox{\hyperlink{a00206_ae4a382139afef48e3b930752120b4c35}{define\+\_\+perspective\+\_\+grid}} (self, division=10, extend=500)
\item 
\mbox{\hyperlink{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}{find\+\_\+wall\+\_\+intersection}} (self, number\+\_\+of\+\_\+walls=2, samples\+\_\+per\+\_\+wall=4, extent=10000, intersection\+\_\+pairs=\mbox{[}$\,$\mbox{]}, degree=1)
\item 
\mbox{\hyperlink{a00206_a7c5233bfe740d0250450332850fcad71}{get\+\_\+checkerboard\+\_\+shape}} (self, checkerboard\+\_\+images)
\item 
\mbox{\hyperlink{a00206_a0686ad347e6e14189cd0035e2ea7bd54}{fisheye\+\_\+calibrate}} (self, checkerboard\+\_\+images, checkerboard\+\_\+grid=None, out=None)
\item 
\mbox{\hyperlink{a00206_a770916344506672f541f976b5048555f}{checkerboard\+\_\+calibrate}} (self, checkerboard\+\_\+images, checkerboard\+\_\+grid=None, out=None)
\item 
\mbox{\hyperlink{a00206_ae36b88c1816fb4bd3fef0f9967aa3527}{save\+\_\+calibration}} (self, file, mtx, distortion, rvecs, tvecs, error\+\_\+list, resolution)
\item 
\mbox{\hyperlink{a00206_a14966b15146b30927e515a9b3c64328d}{load\+\_\+calibration}} (self, file)
\item 
\mbox{\hyperlink{a00206_a048722841bc8d71bae4a1e4a9eb9db00}{collect\+\_\+frames}} (self, video\+\_\+source, start\+\_\+frame=1, skip=15, total\+\_\+frames=None)
\item 
\mbox{\hyperlink{a00206_ad5f4b9a9b0ee17c82d3731e05dba3109}{get\+\_\+calibration\+\_\+ratio}} (self, video\+\_\+resolution, calibration\+\_\+resolution)
\item 
\mbox{\hyperlink{a00206_abd979a29c40c64a598514d7d165bb4a9}{undistort\+\_\+room}} (self, image=None, points\+\_\+data=None, camera\+\_\+matrix=None, distortion=None, show=False, fisheye=False, calibration\+\_\+resolution=None)
\item 
\mbox{\hyperlink{a00206_a66fa5cbb4e0e7ce0bfa08b4b5e14482f}{undistort\+\_\+tracker\+\_\+data}} (self, data, image=None, camera\+\_\+matrix=None, distortion=None)
\item 
\mbox{\hyperlink{a00206_a444510358faa06884318d1ebe94846ff}{load\+\_\+tracker}} (self, csv\+\_\+file)
\item 
\mbox{\hyperlink{a00206_ab870abde92556016846a09d5feb9e03c}{correct\+\_\+tracker\+\_\+points}} (self, df)
\item 
\mbox{\hyperlink{a00206_a0bd7f71bd75e917a01563ad8dce62565}{update\+\_\+tracker\+\_\+3D}} (self, index, df, mapped\+\_\+min, mapped\+\_\+max)
\item 
\mbox{\hyperlink{a00206_ab099905032ea6fd2a2e17e2414e58872}{show\+\_\+tracker\+\_\+3D}} (self, df, mapped\+\_\+min, mapped\+\_\+max)
\item 
\mbox{\hyperlink{a00206_a0a327e18a9cf669bab61d714980d73b0}{show\+\_\+tracker\+\_\+2D}} (self, df, image, data\+\_\+columns=\mbox{[}\textquotesingle{}Pixel\+\_\+\+Loc\+\_\+x\textquotesingle{}, \textquotesingle{}Pixel\+\_\+\+Loc\+\_\+y\textquotesingle{}\mbox{]}, window="{}Tracker2\+D"{}, colour=(255, 255, 0))
\item 
\mbox{\hyperlink{a00206_a2e21d867efbc8b743664f8b6f41d1b8e}{extend\+\_\+image\+\_\+to\+\_\+corners}} (self, image, corners)
\item 
\mbox{\hyperlink{a00206_aab76a3fa2901de336d5a1a3e1b707604}{get\+\_\+room\+\_\+dimensions}} (self, room\+\_\+points)
\item 
\mbox{\hyperlink{a00206_ad1eaebbb5317d01c6bbd133cf98a4d30}{evaluate\+\_\+calibration}} (self)
\item 
\mbox{\hyperlink{a00206_a6c6c06bc8bbf8a0f9f7237a97ff9487e}{visualize\+\_\+distortion}} (self, camera\+\_\+matrix, distiortion, image=None)
\item 
\mbox{\hyperlink{a00206_a2a5df656a4b4d07c05b290f8197c316f}{save\+\_\+room}} (self, filename)
\item 
\mbox{\hyperlink{a00206_a7fea1337eef39488e7f6b170151cf628}{load\+\_\+room}} (self, filename)
\item 
\mbox{\hyperlink{a00206_a3b7fb08f24516ed753d38cd1eccd73f6}{load\+\_\+and\+\_\+undistort\+\_\+calibration}} (self, video\+\_\+path, \mbox{\hyperlink{a00206_a6c6c06bc8bbf8a0f9f7237a97ff9487e}{visualize\+\_\+distortion}}=False, points\+\_\+data=None)
\item 
\mbox{\hyperlink{a00206_adbe2f98b84513775c3106191f2845ed3}{stitch\+\_\+rooms}} (self, video\+\_\+list, undistort=True, key\+\_\+index=None, show=False)
\item 
\mbox{\hyperlink{a00206_a75031a34aadd8c7847c479a17524e00e}{stitch\+\_\+trackers}} (self, video\+\_\+list, homography\+\_\+list, use\+\_\+csv=True, offsets=\mbox{[}0, 0, 0, 0\mbox{]})
\item 
\mbox{\hyperlink{a00206_ab20e46a19ec3f0b9c7fd04d2264ba8a1}{draw\+\_\+grid}} (self, grid\+\_\+shape=(20, 20), color=(255, 255, 255), thickness=2)
\item 
\mbox{\hyperlink{a00206_a6c3906082600df696b318ba028d67911}{get\+\_\+files\+\_\+from\+\_\+folder}} (self, folder, extension="{}MP4"{})
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{a00206_af1a464766317ca2878de63df2ec7c041}\label{a00206_af1a464766317ca2878de63df2ec7c041} 
{\bfseries window\+\_\+name}
\item 
\Hypertarget{a00206_a42cb5f5737262947250c709931232c69}\label{a00206_a42cb5f5737262947250c709931232c69} 
{\bfseries image}
\item 
\Hypertarget{a00206_ad0b8708ab613a74394c90970fd0abd21}\label{a00206_ad0b8708ab613a74394c90970fd0abd21} 
{\bfseries show\+\_\+img}
\item 
\Hypertarget{a00206_af9d23a302c24f0ec934688542ce94817}\label{a00206_af9d23a302c24f0ec934688542ce94817} 
{\bfseries corners}
\item 
\Hypertarget{a00206_a2d200e8176a8ed50871d138d8ac5d61d}\label{a00206_a2d200e8176a8ed50871d138d8ac5d61d} 
{\bfseries room\+\_\+points}
\item 
\Hypertarget{a00206_a4c3efb71d455de72ae4236dbcdae0acc}\label{a00206_a4c3efb71d455de72ae4236dbcdae0acc} 
{\bfseries real\+\_\+locations}
\item 
\Hypertarget{a00206_ad0c10237443ae47f40315a47f947ccfc}\label{a00206_ad0c10237443ae47f40315a47f947ccfc} 
{\bfseries camera\+\_\+matrix}
\item 
\Hypertarget{a00206_a8080a08b5711d0ac4df50eed1234b40f}\label{a00206_a8080a08b5711d0ac4df50eed1234b40f} 
{\bfseries distioriton\+\_\+matrix}
\item 
\Hypertarget{a00206_a37b0915b42b797dac08c9ca96a548212}\label{a00206_a37b0915b42b797dac08c9ca96a548212} 
{\bfseries calibration\+\_\+errors}
\item 
\Hypertarget{a00206_aae23222e1130f873ce9799eec51f7ae6}\label{a00206_aae23222e1130f873ce9799eec51f7ae6} 
{\bfseries calibration\+\_\+resolution}
\item 
\Hypertarget{a00206_acadb5519abbf736dc420142a91e7f0b5}\label{a00206_acadb5519abbf736dc420142a91e7f0b5} 
{\bfseries rotation\+\_\+vector}
\item 
\Hypertarget{a00206_a770476f7dd2d2628d33edf11f6498479}\label{a00206_a770476f7dd2d2628d33edf11f6498479} 
{\bfseries translation\+\_\+vector}
\item 
\Hypertarget{a00206_aff94c8cfdec3db9def9b56fb1d0681a4}\label{a00206_aff94c8cfdec3db9def9b56fb1d0681a4} 
{\bfseries room\+\_\+width}
\item 
\Hypertarget{a00206_a58cff685b88c5112830f468a43b50b3a}\label{a00206_a58cff685b88c5112830f468a43b50b3a} 
{\bfseries room\+\_\+length}
\item 
\Hypertarget{a00206_ac526d1e7e8928a97a3275d1c0bb4fb1e}\label{a00206_ac526d1e7e8928a97a3275d1c0bb4fb1e} 
{\bfseries room\+\_\+height}
\item 
\Hypertarget{a00206_a9feef5270e0e54f103868362df0cd27a}\label{a00206_a9feef5270e0e54f103868362df0cd27a} 
{\bfseries sample\+\_\+rate}
\item 
\Hypertarget{a00206_a792f6008e56b261c4df28ceaf113d908}\label{a00206_a792f6008e56b261c4df28ceaf113d908} 
{\bfseries mapped\+\_\+dictionary}
\item 
\Hypertarget{a00206_aa9862ac00cbd1fbcdd68a24d65bac005}\label{a00206_aa9862ac00cbd1fbcdd68a24d65bac005} 
{\bfseries mapped}
\item 
\Hypertarget{a00206_a2da155f5c1ba42a71b8fcc1e4d517476}\label{a00206_a2da155f5c1ba42a71b8fcc1e4d517476} 
{\bfseries points\+\_\+data}
\item 
\Hypertarget{a00206_a97ea70af4f4f5aa1943bc30f1bbdef81}\label{a00206_a97ea70af4f4f5aa1943bc30f1bbdef81} 
{\bfseries vector\+\_\+depth}
\item 
\Hypertarget{a00206_accc088009d44c521706aa98d6387ee21}\label{a00206_accc088009d44c521706aa98d6387ee21} 
{\bfseries axis}
\item 
\Hypertarget{a00206_a64aa603bc3c6c1587e7c6542452481ac}\label{a00206_a64aa603bc3c6c1587e7c6542452481ac} 
{\bfseries fig}
\item 
\Hypertarget{a00206_a269da524371d8ddf28357afd20e378ef}\label{a00206_a269da524371d8ddf28357afd20e378ef} 
{\bfseries stitch\+\_\+homographies}
\item 
\Hypertarget{a00206_af375124b5ef04d3b8bb534e9da5a59d0}\label{a00206_af375124b5ef04d3b8bb534e9da5a59d0} 
{\bfseries show\+\_\+3\+D\+\_\+plot}
\item 
\Hypertarget{a00206_a65225117e6365e16eec0b0fd2e1353e5}\label{a00206_a65225117e6365e16eec0b0fd2e1353e5} 
{\bfseries get\+\_\+corners}
\item 
\Hypertarget{a00206_a8fa675eb2fcec5b95d9d21c670da7f30}\label{a00206_a8fa675eb2fcec5b95d9d21c670da7f30} 
{\bfseries ax}
\item 
\Hypertarget{a00206_a6dedc2f4868ac1e98c70aa8a14a446ce}\label{a00206_a6dedc2f4868ac1e98c70aa8a14a446ce} 
{\bfseries front\+\_\+plt}
\item 
\Hypertarget{a00206_a1e6f90e673f1651f1546af9a598f18f2}\label{a00206_a1e6f90e673f1651f1546af9a598f18f2} 
{\bfseries back\+\_\+plt}
\item 
\Hypertarget{a00206_a6d42d479602ba7103d40854d696ef438}\label{a00206_a6d42d479602ba7103d40854d696ef438} 
{\bfseries float\+\_\+plt}
\item 
\Hypertarget{a00206_ad390bb5a59ecbedcd954e93c4112b95f}\label{a00206_ad390bb5a59ecbedcd954e93c4112b95f} 
{\bfseries line\+\_\+plt}
\item 
\Hypertarget{a00206_a944741645bb51634cd0cd79b0f5c880c}\label{a00206_a944741645bb51634cd0cd79b0f5c880c} 
{\bfseries points\+\_\+plt}
\item 
\Hypertarget{a00206_a23f49f701d2d2d1826da95278d96746f}\label{a00206_a23f49f701d2d2d1826da95278d96746f} 
{\bfseries quiver}
\item 
\Hypertarget{a00206_a437585bedd20447eb4ffe1ffa7770bcd}\label{a00206_a437585bedd20447eb4ffe1ffa7770bcd} 
{\bfseries get\+\_\+corner\+\_\+with\+\_\+definition}
\item 
\Hypertarget{a00206_a96dbb5c8baf443a0b757d117330d89b6}\label{a00206_a96dbb5c8baf443a0b757d117330d89b6} 
{\bfseries get\+\_\+depth}
\item 
\Hypertarget{a00206_a315556486e7e941c41eb072c7bd93b2e}\label{a00206_a315556486e7e941c41eb072c7bd93b2e} 
{\bfseries error\+\_\+list}
\item 
\Hypertarget{a00206_a087ba3f393340dc3e98e2f4b0717bf90}\label{a00206_a087ba3f393340dc3e98e2f4b0717bf90} 
{\bfseries invert\+\_\+y}
\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{a00206_a5fe35e96c37a5189461dc200d9860d4b}\label{a00206_a5fe35e96c37a5189461dc200d9860d4b} 
\index{room\_estimation@{room\_estimation}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily \+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image = {\ttfamily None},  }\item[{}]{camera\+\_\+matrix = {\ttfamily JUSTIN\+\_\+HERO4\+\_\+SILVER\+\_\+720\+\_\+MEDIUM\+\_\+FOV\+\_\+MTX},  }\item[{}]{distortion\+\_\+matrix = {\ttfamily JUSTIN\+\_\+HERO4\+\_\+SILVER\+\_\+720\+\_\+MEDIUM\+\_\+FOV\+\_\+DIST},  }\item[{}]{rvecs = {\ttfamily JUSTIN\+\_\+HERO4\+\_\+SILVER\+\_\+720\+\_\+MEDIUM\+\_\+FOV\+\_\+RVEC} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ image=None,\ camera\_matrix=JUSTIN\_HERO4\_SILVER\_720\_MEDIUM\_FOV\_MTX,\ distortion\_matrix=JUSTIN\_HERO4\_SILVER\_720\_MEDIUM\_FOV\_DIST,\ rvecs=JUSTIN\_HERO4\_SILVER\_720\_MEDIUM\_FOV\_RVEC): }
\DoxyCodeLine{00149\  }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ self.window\_name\ =\ \textcolor{stringliteral}{"{}Room\ Estimation"{}} }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ cv2.namedWindow(\textcolor{stringliteral}{"{}Room\ Estimation"{}}) }
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ self.image\ =\ image }
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ self.show\_img\ =\ self.img\_copy() }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ self.corners\ =\ [] }
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ self.room\_points\ =\ []\ \textcolor{comment}{\#\ The\ formatted\ real\_locations\ that\ is\ used\ in\ processing\ data }}
\DoxyCodeLine{00157\  }
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ self.real\_locations\ =\ []\ \textcolor{comment}{\#\ Raw\ input\ of\ points\ in\ 3D\ [(0,0,0),\ (1000,0\ ,0),\ (1000,\ 2000,\ 0),\ (0,\ 2000,0)] }}
\DoxyCodeLine{00159\  }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ self.camera\_matrix\ =\ camera\_matrix }
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ self.distioriton\_matrix\ =\ distortion\_matrix }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ self.calibration\_errors\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00163\  }
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ self.calibration\_resolution\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00165\  }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ self.rotation\_vector\ =\ rvecs }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ self.translation\_vector\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00168\  }
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Size\ are\ in\ millimeters }}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ self.room\_width\ =\ 3000\ \ \textcolor{comment}{\#\ X }}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ self.room\_length\ =\ 3000\ \textcolor{comment}{\#\ Depth\ (Z) }}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ self.room\_height\ =\ 3000\ \textcolor{comment}{\#\ Y }}
\DoxyCodeLine{00173\  }
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ self.sample\_rate\ =\ 5\ \ \ \textcolor{comment}{\#\ estimates\ position\ every\ 1cm }}
\DoxyCodeLine{00175\  }
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ self.mapped\_dictionary\ =\ \{\} }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ self.mapped\ =\ \{\} }
\DoxyCodeLine{00178\  }
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ self.points\_data\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00180\  }
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ self.vector\_depth\ =\ 0 }
\DoxyCodeLine{00182\  }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ self.axis\ =\ self.set\_axis(3000,1000,3000) }
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ self.fig\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ self.stitch\_homographies\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00186\  }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ img\ =\ self.draw\_axis() }}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.waitKey(1) }}
\DoxyCodeLine{00189\  }
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.mapped\_dictionary\ =\ self.map\_2d\_to\_3d((self.room\_width,\ self.room\_length,\ self.room\_height)) }}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ self.show\_3D\_plot\ =\ \textcolor{keyword}{True} }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ while\ True: }}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.imshow(self.window\_name,\ self.show\_img) }}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.waitKey(1) }}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.corner\_points\ =\ [] }}
\DoxyCodeLine{00197\  }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{a00206_a921523998615aa3555a3cb0ca2b36965}\label{a00206_a921523998615aa3555a3cb0ca2b36965} 
\index{room\_estimation@{room\_estimation}!assign\_non\_square\_corners@{assign\_non\_square\_corners}}
\index{assign\_non\_square\_corners@{assign\_non\_square\_corners}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{assign\_non\_square\_corners()}{assign\_non\_square\_corners()}}
{\footnotesize\ttfamily assign\+\_\+non\+\_\+square\+\_\+corners (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{num\+\_\+points = {\ttfamily inf} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Assigns points around the room with any number of known coordinates.

Assign point
Set width and length of known coordinate.
Origin should be 0,0
Sets the dimentions of the room to the largest dimensions
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01109\ \ \ \ \ \textcolor{keyword}{def\ }assign\_non\_square\_corners(self,\ num\_points=inf): }
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01111\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Assigns\ points\ around\ the\ room\ with\ any\ number\ of\ known\ coordinates. }}
\DoxyCodeLine{01112\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01113\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Assign\ point }}
\DoxyCodeLine{01114\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Set\ width\ and\ length\ of\ known\ coordinate. }}
\DoxyCodeLine{01115\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Origin\ should\ be\ 0,0 }}
\DoxyCodeLine{01116\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Sets\ the\ dimentions\ of\ the\ room\ to\ the\ largest\ dimensions }}
\DoxyCodeLine{01117\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01118\  }
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Assigning\ corners..."{}}) }
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#Initializes\ feedback\ to\ a\ function }}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ cv2.setMouseCallback(\textcolor{stringliteral}{"{}Room\ Estimation"{}},\ self.get\_corners) }
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ len(self.corners)\ <\ num\_points: }
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ len(self.corners)\ >=\ 4: }}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ print("{}SHOWING\ ROOM"{}) }}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ self.show\_img,\ cube,\ target\_cube\ =\ self.draw\_cuboid() }}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(len(self.corners)) }}
\DoxyCodeLine{01128\  }
\DoxyCodeLine{01129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ display\ the\ image\ and\ wait\ for\ a\ keypress }}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.setMouseCallback(\textcolor{stringliteral}{"{}Room\ Estimation"{}},\ self.get\_corner\_with\_definition) }
\DoxyCodeLine{01131\  }
\DoxyCodeLine{01132\  }
\DoxyCodeLine{01133\  }
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Room\ Estimation"{}},\ self.show\_img) }
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \ \ \ \ key\ =\ cv2.waitKey(1)\ \&\ 0xFF }
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \ \ \ \ self.connect\_points(self.corners) }
\DoxyCodeLine{01137\  }
\DoxyCodeLine{01138\  }
\DoxyCodeLine{01139\  }
\DoxyCodeLine{01140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{"{}c"{}}): }
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(self.corners)\ <\ 4: }
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}You\ need\ at\ least\ 4\ points"{}}) }
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ break }}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.corners\ =\ np.reshape(np.asfarray(self.corners),\ (len(self.corners),2,1)) }
\DoxyCodeLine{01146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_points\ =\ self.get\_n\_room\_points() }
\DoxyCodeLine{01147\  }
\DoxyCodeLine{01148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ set\ measurments\ to\ maximum\ sizes }}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_width\ =\ 0 }
\DoxyCodeLine{01150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_length\ =\ 0 }
\DoxyCodeLine{01151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ point\ \textcolor{keywordflow}{in}\ self.room\_points: }
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width\ =\ int(point[0][0]) }
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ length\ =\ int(point[1][0]) }
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ width\ >\ self.room\_width: }
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_width\ =\ width }
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ length\ >\ self.room\_length: }
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_length\ =\ length }
\DoxyCodeLine{01158\  }
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.room\_points,\ self.corners }
\DoxyCodeLine{01160\  }
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ self.connect\_points(self.corners) }
\DoxyCodeLine{01162\  }
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ set\ measurments\ to\ maximum\ sizes\  }}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ point\ \textcolor{keywordflow}{in}\ self.room\_points: }
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \ \ \ \ width\ =\ int(point[0][0]) }
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \ \ \ \ length\ =\ int(point[1][0]) }
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ width\ >\ self.room\_width: }
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_width\ =\ width }
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ length\ >\ self.room\_length: }
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_length\ =\ length }
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Set\ measurments\ to\ numpy\ arrays }}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ self.corners\ =\ np.reshape(np.asfarray(self.corners),\ (len(self.corners),2,1)) }
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ self.room\_points\ =\ self.get\_n\_room\_points() }
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.setMouseCallback("{}Room\ Estimation"{},\ self.draw\_vector) }}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.room\_points,\ self.corners }
\DoxyCodeLine{01177\  }

\end{DoxyCode}


References room\+\_\+estimation.\+camera\+\_\+matrix, room\+\_\+estimation.\+connect\+\_\+points(), room\+\_\+estimation.\+corners, room\+\_\+estimation.\+distioriton\+\_\+matrix, room\+\_\+estimation.\+get\+\_\+corner\+\_\+with\+\_\+definition(), room\+\_\+estimation.\+get\+\_\+corner\+\_\+with\+\_\+definition, room\+\_\+estimation.\+get\+\_\+corners, room\+\_\+estimation.\+get\+\_\+corners(), \mbox{\hyperlink{a00206_ae29c16a83d737f9e9f2b584ae560ad85}{room\+\_\+estimation.\+get\+\_\+n\+\_\+room\+\_\+points()}}, room\+\_\+estimation.\+room\+\_\+length, room\+\_\+estimation.\+room\+\_\+points, room\+\_\+estimation.\+room\+\_\+width, room\+\_\+estimation.\+rotation\+\_\+vector, room\+\_\+estimation.\+show\+\_\+img, and room\+\_\+estimation.\+translation\+\_\+vector.

Here is the call graph for this function\+:
% FIG 0
\Hypertarget{a00206_a770916344506672f541f976b5048555f}\label{a00206_a770916344506672f541f976b5048555f} 
\index{room\_estimation@{room\_estimation}!checkerboard\_calibrate@{checkerboard\_calibrate}}
\index{checkerboard\_calibrate@{checkerboard\_calibrate}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{checkerboard\_calibrate()}{checkerboard\_calibrate()}}
{\footnotesize\ttfamily checkerboard\+\_\+calibrate (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{checkerboard\+\_\+images,  }\item[{}]{checkerboard\+\_\+grid = {\ttfamily None},  }\item[{}]{out = {\ttfamily None} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01781\ \ \ \ \ \textcolor{keyword}{def\ }checkerboard\_calibrate(self,\ checkerboard\_images,\ checkerboard\_grid=None,\ out=None): }
\DoxyCodeLine{01782\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Will\ look\ at\ what\ this\ means\ after }}
\DoxyCodeLine{01783\ \ \ \ \ \ \ \ \ criteria\ =\ (cv2.TERM\_CRITERIA\_EPS\ +\ cv2.TERM\_CRITERIA\_MAX\_ITER,\ 30,\ 0.001) }
\DoxyCodeLine{01784\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ calibration\_flags\ =\ cv2.fisheye.CALIB\_RECOMPUTE\_EXTRINSIC+cv2.fisheye.CALIB\_CHECK\_COND+cv2.fisheye.CALIB\_FIX\_SKEW }}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ calibration\_flags\ =\ cv2.fisheye.CALIB\_RECOMPUTE\_EXTRINSIC\ +\ cv2.fisheye.CALIB\_CHECK\_COND\ +\ cv2.fisheye.CALIB\_FIX\_SKEW\ +\ cv2. }}
\DoxyCodeLine{01786\  }
\DoxyCodeLine{01787\ \ \ \ \ \ \ \ \ calibration\_flags\ =\ cv2.CALIB\_RATIONAL\_MODEL\ +\ cv2.CALIB\_FIX\_PRINCIPAL\_POINT }
\DoxyCodeLine{01788\  }
\DoxyCodeLine{01789\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Creating\ vector\ to\ store\ vectors\ of\ 3D\ points\ for\ each\ checkerboard\ image }}
\DoxyCodeLine{01790\ \ \ \ \ \ \ \ \ objpoints\ =\ [] }
\DoxyCodeLine{01791\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Creating\ vector\ to\ store\ vectors\ of\ 2D\ points\ for\ each\ checkerboard\ image }}
\DoxyCodeLine{01792\ \ \ \ \ \ \ \ \ imgpoints\ =\ []\  }
\DoxyCodeLine{01793\  }
\DoxyCodeLine{01794\ \ \ \ \ \ \ \ \ imgshape\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{01795\ \ \ \ \  }
\DoxyCodeLine{01796\ \ \ \ \ \ \ \ \ checkerboard\_grid\ =\ self.get\_checkerboard\_shape(checkerboard\_images) }
\DoxyCodeLine{01797\ \ \ \ \ \ \ \ \ height,\ width\ =\ checkerboard\_images[0].shape[:2] }
\DoxyCodeLine{01798\  }
\DoxyCodeLine{01799\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ image\ \textcolor{keywordflow}{in}\ checkerboard\_images: }
\DoxyCodeLine{01800\  }
\DoxyCodeLine{01801\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ cv2.cvtColor(image,cv2.COLOR\_BGR2GRAY) }
\DoxyCodeLine{01802\  }
\DoxyCodeLine{01803\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{'img'},image) }
\DoxyCodeLine{01804\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01805\ \ \ \ \ \ \ \ \ \ \ \ \ imgshape\ =\ image.shape }
\DoxyCodeLine{01806\ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ corners\ =\ cv2.findChessboardCorners(image,\ checkerboard\_grid) }
\DoxyCodeLine{01807\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.cornerSubPix(checkerboard\_image,\ corners) }}
\DoxyCodeLine{01808\  }
\DoxyCodeLine{01809\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ retval,\ cameraMatrix,\ distCoeffs,\ rvecs,\ tvecs\ =\ cv2.calibrateCamera(objectPoints,\ imagePoints,\ imageSize) }}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ \ \ \ \ objp\ =\ np.zeros((1,\ checkerboard\_grid[0]\ *\ checkerboard\_grid[1],\ 3),\ np.float32) }
\DoxyCodeLine{01811\ \ \ \ \ \ \ \ \ \ \ \ \ objp[0,:,:2]\ =\ np.mgrid[0:checkerboard\_grid[0],\ 0:checkerboard\_grid[1]].T.reshape(-\/1,\ 2) }
\DoxyCodeLine{01812\ \ \ \ \ \ \ \ \ \ \ \ \ prev\_img\_shape\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{01813\ \ \ \ \ \  }
\DoxyCodeLine{01814\  }
\DoxyCodeLine{01815\  }
\DoxyCodeLine{01816\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ retval\ ==\ \textcolor{keyword}{True}: }
\DoxyCodeLine{01817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ objpoints.append(objp) }
\DoxyCodeLine{01818\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ refining\ pixel\ coordinates\ for\ given\ 2d\ points. }}
\DoxyCodeLine{01819\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ corners2\ =\ cv2.cornerSubPix(image,\ corners,\ (11,11),(-\/1,-\/1),\ criteria)\ \  }
\DoxyCodeLine{01820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ imgpoints.append(corners2) }
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Draw\ and\ display\ the\ corners }}
\DoxyCodeLine{01822\  }
\DoxyCodeLine{01823\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ cv2.drawChessboardCorners(image,\ checkerboard\_grid,\ corners2,\ retval) }
\DoxyCodeLine{01824\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Calibration"{}},\ image) }
\DoxyCodeLine{01825\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01826\ \ \ \ \ \ \ \ \ cv2.destroyAllWindows() }
\DoxyCodeLine{01827\  }
\DoxyCodeLine{01828\  }
\DoxyCodeLine{01829\  }
\DoxyCodeLine{01830\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.calibrateCameraExtended() }}
\DoxyCodeLine{01831\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Calibrating...\ "{}},\ len(objpoints),\ \textcolor{stringliteral}{"{}\ images"{}}) }
\DoxyCodeLine{01832\ \ \ \ \ \ \ \ \ ret,\ mtx,\ dist,\ rvecs,\ tvecs\ =\ cv2.calibrateCamera(objpoints,\ imgpoints,\ imgshape[::-\/1],\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None},\ flags=calibration\_flags,\ criteria=criteria) }
\DoxyCodeLine{01833\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01834\ \ \ \ \ \ \ \ \ mean\_error\ =\ 0 }
\DoxyCodeLine{01835\ \ \ \ \ \ \ \ \ total\_error\ =\ 0 }
\DoxyCodeLine{01836\ \ \ \ \ \ \ \ \ error\_list\ =\ [] }
\DoxyCodeLine{01837\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(objpoints)): }
\DoxyCodeLine{01838\ \ \ \ \ \ \ \ \ \ \ \ \ imgpoints2,\ \_\ =\ cv2.projectPoints(objpoints[i],\ rvecs[i],\ tvecs[i],\ mtx,\ dist) }
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \ \ \ \ error\ =\ cv2.norm(imgpoints[i],imgpoints2,\ cv2.NORM\_L2)/len(imgpoints2) }
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \ \ \ \ total\_error\ +=\ error }
\DoxyCodeLine{01841\ \ \ \ \ \ \ \ \ \ \ \ \ error\_list.append(error) }
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ mean\_error\ =\ total\_error/len(objpoints) }
\DoxyCodeLine{01843\  }
\DoxyCodeLine{01844\ \ \ \ \ \ \ \ \ print(mean\_error) }
\DoxyCodeLine{01845\ \ \ \ \ \ \ \ \ self.camera\_matrix\ =\ mtx }
\DoxyCodeLine{01846\ \ \ \ \ \ \ \ \ self.distioriton\_matrix\ =\ dist }
\DoxyCodeLine{01847\ \ \ \ \ \ \ \ \ self.rotation\_vector\ =\ rvecs }
\DoxyCodeLine{01848\ \ \ \ \ \ \ \ \ self.translation\_vector\ =\ tvecs }
\DoxyCodeLine{01849\ \ \ \ \ \ \ \ \ self.error\_list\ =\ error\_list }
\DoxyCodeLine{01850\ \ \ \ \ \ \ \ \ self.calibration\_resolution\ =\ (width,\ height) }
\DoxyCodeLine{01851\ \ \ \ \ \ \ \ \ self.save\_calibration(out,\ mtx,\ dist,\ rvecs,\ tvecs,\ error\_list,\ self.calibration\_resolution) }
\DoxyCodeLine{01852\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Camera:"{}}\ ,mtx,\ \textcolor{stringliteral}{"{}Distoriton:"{}},\ dist) }
\DoxyCodeLine{01853\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mtx,\ dist,\ rvecs,\ tvecs,\ mean\_error }
\DoxyCodeLine{01854\  }

\end{DoxyCode}
\Hypertarget{a00206_ab0188ed983122bc7494460062c8ca22b}\label{a00206_ab0188ed983122bc7494460062c8ca22b} 
\index{room\_estimation@{room\_estimation}!clear\_corners@{clear\_corners}}
\index{clear\_corners@{clear\_corners}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{clear\_corners()}{clear\_corners()}}
{\footnotesize\ttfamily clear\+\_\+corners (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{keyword}{def\ }clear\_corners(self): }
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Clearing\ Corners!"{}}) }
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ self.corners\ =\ [] }
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.corners }
\DoxyCodeLine{00466\ \ \ \ \  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_ae4a382139afef48e3b930752120b4c35}{room\+\_\+estimation.\+define\+\_\+perspective\+\_\+grid()}}, \mbox{\hyperlink{a00206_a2e21d867efbc8b743664f8b6f41d1b8e}{room\+\_\+estimation.\+extend\+\_\+image\+\_\+to\+\_\+corners()}}, \mbox{\hyperlink{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}{room\+\_\+estimation.\+find\+\_\+wall\+\_\+intersection()}}, \mbox{\hyperlink{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba}{room\+\_\+estimation.\+get\+\_\+room\+\_\+corners()}}, and \mbox{\hyperlink{a00206_abeac4cbae89aef891cee148cbbbc6232}{room\+\_\+estimation.\+superimpose\+\_\+checker()}}.

Here is the caller graph for this function\+:
% FIG 1
\Hypertarget{a00206_a048722841bc8d71bae4a1e4a9eb9db00}\label{a00206_a048722841bc8d71bae4a1e4a9eb9db00} 
\index{room\_estimation@{room\_estimation}!collect\_frames@{collect\_frames}}
\index{collect\_frames@{collect\_frames}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{collect\_frames()}{collect\_frames()}}
{\footnotesize\ttfamily collect\+\_\+frames (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{video\+\_\+source,  }\item[{}]{start\+\_\+frame = {\ttfamily 1},  }\item[{}]{skip = {\ttfamily 15},  }\item[{}]{total\+\_\+frames = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Collects the images for stitching
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01893\ \ \ \ \ \textcolor{keyword}{def\ }collect\_frames(self,\ video\_source,\ start\_frame=1,\ skip=15,\ total\_frames=None): }
\DoxyCodeLine{01894\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{} }}
\DoxyCodeLine{01895\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Collects\ the\ images\ for\ stitching }}
\DoxyCodeLine{01896\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{01897\ \ \ \ \ \ \ \ \ print(video\_source) }
\DoxyCodeLine{01898\ \ \ \ \ \ \ \ \ cap\ =\ cv2.VideoCapture(video\_source) }
\DoxyCodeLine{01899\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01900\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ cap.isOpened(): }
\DoxyCodeLine{01901\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}Unable\ to\ open\ video\ source"{}},\ video\_source) }
\DoxyCodeLine{01902\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Collecting\ Frames..."{}}) }
\DoxyCodeLine{01903\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ total\_frames\ ==\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{01904\ \ \ \ \ \ \ \ \ \ \ \ \ total\_frames\ =\ int(cap.get(cv2.CAP\_PROP\_FRAME\_COUNT)) }
\DoxyCodeLine{01905\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#setup\ cv2\ capture\ from\ video }}
\DoxyCodeLine{01906\ \ \ \ \ \ \ \ \ cap\ =\ cv2.VideoCapture(video\_source) }
\DoxyCodeLine{01907\ \ \ \ \ \ \ \ \ frames\ =\ [] }
\DoxyCodeLine{01908\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#set\ the\ starting\ frame }}
\DoxyCodeLine{01909\ \ \ \ \ \ \ \ \ cap.set(cv2.CAP\_PROP\_POS\_FRAMES,\ start\_frame) }
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print("{}Starting\ at\ frame:\ "{}\ +\ str(cap.get(cv2.CAP\_PROP\_POS\_FRAMES))) }}
\DoxyCodeLine{01911\  }
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ last\ =\ 0 }
\DoxyCodeLine{01913\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (cap.get(cv2.CAP\_PROP\_POS\_FRAMES)+\ skip-\/1)\ <\ total\_frames: }
\DoxyCodeLine{01914\ \ \ \ \ \ \ \ \ \ \ \ \ print(cap.get(cv2.CAP\_PROP\_POS\_FRAMES),\ \textcolor{stringliteral}{"{}/"{}},\ total\_frames) }
\DoxyCodeLine{01915\ \ \ \ \ \ \ \ \ \ \ \ \ last\ =\ cap.get(cv2.CAP\_PROP\_POS\_FRAMES) }
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(frames) }}
\DoxyCodeLine{01917\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#read\ the\ image\ from\ that\ skipped\ frame }}
\DoxyCodeLine{01918\ \ \ \ \ \ \ \ \ \ \ \ \ ret,\ frame\ =\ cap.read() }
\DoxyCodeLine{01919\  }
\DoxyCodeLine{01920\ \ \ \ \ \ \ \ \ \ \ \ \ cap.set(cv2.CAP\_PROP\_POS\_FRAMES,\ cap.get(cv2.CAP\_PROP\_POS\_FRAMES)\ +\ skip-\/1) }
\DoxyCodeLine{01921\  }
\DoxyCodeLine{01922\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ last\ ==\ cap.get(cv2.CAP\_PROP\_POS\_FRAMES): }
\DoxyCodeLine{01923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print("{}NEXT"{}) }}
\DoxyCodeLine{01924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next=10 }
\DoxyCodeLine{01925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\ =\ cap.get(cv2.CAP\_PROP\_POS\_FRAMES) }
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ last\ ==\ cap.get(cv2.CAP\_PROP\_POS\_FRAMES): }
\DoxyCodeLine{01927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\ +=\ 10 }
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(next) }
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ret,\ frame\ =\ cap.read() }
\DoxyCodeLine{01930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cap.set(cv2.CAP\_PROP\_POS\_FRAMES,\ cap.get(cv2.CAP\_PROP\_POS\_FRAMES)\ +\ next\ +\ skip-\/1) }
\DoxyCodeLine{01931\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#set\ current\ frame\ to\ the\ next\ n-\/skipped\ frames }}
\DoxyCodeLine{01932\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(cap.get(cv2.CAP\_PROP\_POS\_FRAMES)) }}
\DoxyCodeLine{01933\  }
\DoxyCodeLine{01934\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ret: }
\DoxyCodeLine{01935\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(ret) }}
\DoxyCodeLine{01936\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ cv2.waitKey(30)\ \&\ 0xFF\ ==\ ord('q'): }}
\DoxyCodeLine{01937\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ break }}
\DoxyCodeLine{01938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.imshow('frame',\ frame) }}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#append\ the\ frames\ to\ be\ processed }}
\DoxyCodeLine{01940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ frames.append(frame) }
\DoxyCodeLine{01941\  }
\DoxyCodeLine{01942\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}FrameCollection"{}},\ frame) }
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01944\  }
\DoxyCodeLine{01945\ \ \ \ \ \ \ \ \ cv2.destroyAllWindows() }
\DoxyCodeLine{01946\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ frames }
\DoxyCodeLine{01947\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a2a5df656a4b4d07c05b290f8197c316f}{room\+\_\+estimation.\+save\+\_\+room()}}, \mbox{\hyperlink{a00206_adbe2f98b84513775c3106191f2845ed3}{room\+\_\+estimation.\+stitch\+\_\+rooms()}}, and \mbox{\hyperlink{a00206_a75031a34aadd8c7847c479a17524e00e}{room\+\_\+estimation.\+stitch\+\_\+trackers()}}.

Here is the caller graph for this function\+:
% FIG 2
\Hypertarget{a00206_ae2c8ef2eee13d8eb75d88c0559626fac}\label{a00206_ae2c8ef2eee13d8eb75d88c0559626fac} 
\index{room\_estimation@{room\_estimation}!connect\_points@{connect\_points}}
\index{connect\_points@{connect\_points}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{connect\_points()}{connect\_points()}}
{\footnotesize\ttfamily connect\+\_\+points (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{points }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{keyword}{def\ }connect\_points(self,\ points): }
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Helper\ functio\ nthat\ visualizes\ corners"{}} }
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ point\ \textcolor{keywordflow}{in}\ enumerate(points): }
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.room\_points: }
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ (int(points[index][0]),\ int(points[index][1])) }
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.putText(self.show\_img,\ str(self.room\_points[index]),\ p1,\ fontFace=cv2.FONT\_HERSHEY\_PLAIN,fontScale=1,\ color=(255,0,0),\ thickness=2) }
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ index+1\ ==\ len(points): }}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \#\ print("{}Last\ point"{}) }}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ p1\ =\ (int(points[index][0]),\ int(points[index][1])) }}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ p2\ =\ (int(points[0][0]),\ int(points[0][1])) }}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.line(self.show\_img,\ p1,\ p2,\ (255,0,0)) }}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(points)\ >\ 1\ \textcolor{keywordflow}{and}\ index+1\ <\ len(points): }
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ (int(points[index][0]),\ int(points[index][1])) }
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ (int(points[index+1][0]),\ int(points[index+1][1])) }
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img=cv2.line(self.show\_img,\ p1,\ p2,\ (255,0,0)) }
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00522\  }
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ cv2.imshow(self.window\_name,\ self.show\_img) }
\DoxyCodeLine{00524\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a921523998615aa3555a3cb0ca2b36965}{room\+\_\+estimation.\+assign\+\_\+non\+\_\+square\+\_\+corners()}}, \mbox{\hyperlink{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}{room\+\_\+estimation.\+find\+\_\+wall\+\_\+intersection()}}, and \mbox{\hyperlink{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba}{room\+\_\+estimation.\+get\+\_\+room\+\_\+corners()}}.

Here is the caller graph for this function\+:
% FIG 3
\Hypertarget{a00206_ab870abde92556016846a09d5feb9e03c}\label{a00206_ab870abde92556016846a09d5feb9e03c} 
\index{room\_estimation@{room\_estimation}!correct\_tracker\_points@{correct\_tracker\_points}}
\index{correct\_tracker\_points@{correct\_tracker\_points}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{correct\_tracker\_points()}{correct\_tracker\_points()}}
{\footnotesize\ttfamily correct\+\_\+tracker\+\_\+points (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{df }\end{DoxyParamCaption})}

\begin{DoxyVerb}ratios is the x,y|width,height ratios of the estimate to the ground truth.
Example: Estimates are recorded at 480x720 while ground truths are recorded at 720x1280. The ratio inputed would be (720/480, 1280/720) or (1.5, 1.777778)


invert_y is the height of the video. We record the data as if the origin is in the bottom left, but in other applications the origin is the top left.
This means we subtract the height of the video to inverse this effect.
If the height of the video is 720, invert_y=720. If the data being tested IS NOT inverted, leave it as 0 
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02115\ \ \ \ \ \textcolor{keyword}{def\ }correct\_tracker\_points(self,\ df): }
\DoxyCodeLine{02116\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{} }}
\DoxyCodeLine{02117\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ratios\ is\ the\ x,y|width,height\ ratios\ of\ the\ estimate\ to\ the\ ground\ truth. }}
\DoxyCodeLine{02118\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Example:\ Estimates\ are\ recorded\ at\ 480x720\ while\ ground\ truths\ are\ recorded\ at\ 720x1280.\ The\ ratio\ inputed\ would\ be\ (720/480,\ 1280/720)\ or\ (1.5,\ 1.777778) }}
\DoxyCodeLine{02119\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \  }}
\DoxyCodeLine{02120\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02121\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ invert\_y\ is\ the\ height\ of\ the\ video.\ We\ record\ the\ data\ as\ if\ the\ origin\ is\ in\ the\ bottom\ left,\ but\ in\ other\ applications\ the\ origin\ is\ the\ top\ left. }}
\DoxyCodeLine{02122\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ means\ we\ subtract\ the\ height\ of\ the\ video\ to\ inverse\ this\ effect. }}
\DoxyCodeLine{02123\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ the\ height\ of\ the\ video\ is\ 720,\ invert\_y=720.\ If\ the\ data\ being\ tested\ IS\ NOT\ inverted,\ leave\ it\ as\ 0\  }}
\DoxyCodeLine{02124\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{02125\ \ \ \ \ \ \ \ \ width\ =\ int(df.iloc[0][\textcolor{stringliteral}{'Width(px)'}]) }
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ height\ =\ int(df.iloc[0][\textcolor{stringliteral}{'Height(px)'}]) }
\DoxyCodeLine{02127\  }
\DoxyCodeLine{02128\ \ \ \ \ \ \ \ \ df\ =\ df.iloc[1:\ ,\ :]\ \textcolor{comment}{\#\ Drop\ first\ row }}
\DoxyCodeLine{02129\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02130\ \ \ \ \ \ \ \ \ df[\textcolor{stringliteral}{'Pixel\_Loc\_x'}]\ =\ df[\textcolor{stringliteral}{'Pixel\_Loc\_x'}].astype(int)\ *\ (width/df[\textcolor{stringliteral}{'Max\_Pixel\_x'}].astype(int)) }
\DoxyCodeLine{02131\ \ \ \ \ \ \ \ \ df[\textcolor{stringliteral}{'Pixel\_Loc\_y'}]\ =\ (df[\textcolor{stringliteral}{'Max\_Pixel\_y'}].astype(int)\ -\/\ df[\textcolor{stringliteral}{'Pixel\_Loc\_y'}].astype(int))\ *\ (height/df[\textcolor{stringliteral}{'Max\_Pixel\_y'}].astype(int)) }
\DoxyCodeLine{02132\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ point\ =\ (float(point['Pixel\_Loc\_x'])*ratios[0], }}
\DoxyCodeLine{02133\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (invert\_y-\/float(point['y2']))*ratios[1], }}
\DoxyCodeLine{02134\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ float(point['x2'])*ratios[0], }}
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (invert\_y-\/float(point['y1']))*ratios[1] }}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ) }}
\DoxyCodeLine{02137\ \ \ \ \ \ \ \ \ print(df) }
\DoxyCodeLine{02138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ df }
\DoxyCodeLine{02139\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a444510358faa06884318d1ebe94846ff}{room\+\_\+estimation.\+load\+\_\+tracker()}}.

Here is the caller graph for this function\+:
% FIG 4
\Hypertarget{a00206_a9d5c0b06be5dbf308587eac88c486612}\label{a00206_a9d5c0b06be5dbf308587eac88c486612} 
\index{room\_estimation@{room\_estimation}!crop\_plain@{crop\_plain}}
\index{crop\_plain@{crop\_plain}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{crop\_plain()}{crop\_plain()}}
{\footnotesize\ttfamily crop\+\_\+plain (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{points,  }\item[{}]{plain\+\_\+width,  }\item[{}]{plain\+\_\+length,  }\item[{}]{image = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Given 4 points the image will be cropped and reprojected as a rectangle.

NOTE: Use length and height synonymously

points = [(x1,y1), (x2,y2) ... (x4,y4)]
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{00580\ \ \ \ \ \textcolor{keyword}{def\ }crop\_plain(self,\ points,\ plain\_width,\ plain\_length,\ image=None): }
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{00582\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Given\ 4\ points\ the\ image\ will\ be\ cropped\ and\ reprojected\ as\ a\ rectangle. }}
\DoxyCodeLine{00583\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00584\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ NOTE:\ Use\ length\ and\ height\ synonymously }}
\DoxyCodeLine{00585\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00586\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ points\ =\ [(x1,y1),\ (x2,y2)\ ...\ (x4,y4)] }}
\DoxyCodeLine{00587\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ image\ ==\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ self.image }
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ h,\ w\ =\ image.shape[:2] }
\DoxyCodeLine{00592\  }
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ These\ are\ the\ physical\ dimensions\ of\ the\ wall\ and\ the\ ratio\ in\ order\ to\ calculate\ the\ perspective }}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ plane\_ratio\ =\ plain\_width/plain\_length }
\DoxyCodeLine{00595\  }
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Perspective\ points\ are\ the\ points\ labelled\ multiplied\ by\ the\ ratio\ to\ get\ the\ end\ values\ of\ the\ points }}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We\ start\ with\ the\ bottom\ left\ of\ the\ wall,\ which\ means\ we\ use\ max\_y\ of\ the\ wall\ room }}
\DoxyCodeLine{00598\  }
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{00600\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 2-\/-\/-\/3 }}
\DoxyCodeLine{00601\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ \ \ | }}
\DoxyCodeLine{00602\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1\ \ \ 4 }}
\DoxyCodeLine{00603\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{00604\  }
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ p1\ =\ (plain\_length,0) }
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ p2\ =\ (0,0) }
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ p3\ =\ (plain\_length,\ plain\_width) }
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ p4\ =\ (0,\ plain\_width) }
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ perspective\_points\ =\ np.array([p1,p2,p3,p4]) }
\DoxyCodeLine{00610\  }
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(points) }}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(perspective\_points) }}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00614\  }
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ points\ =\ np.array(points,\ dtype=np.float32) }
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ perspective\_points\ =\ np.array(perspective\_points,\ dtype=np.float32) }
\DoxyCodeLine{00617\  }
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ print(points.shape) }
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ print(perspective\_points.shape) }
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ use\ cv2.getPerspectiveTransform()\ to\ get\ M,\ the\ transform\ matrix,\ and\ Minv,\ the\ inverse }}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ M\ =\ cv2.getPerspectiveTransform(points,\ perspective\_points) }
\DoxyCodeLine{00622\  }
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ use\ cv2.warpPerspective()\ to\ warp\ your\ image\ to\ a\ top-\/down\ view }}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ warped\ =\ cv2.warpPerspective(image,\ M,\ (w,\ h),\ flags=cv2.INTER\_LINEAR) }
\DoxyCodeLine{00625\  }
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Wall\ Warped"{}},\ warped) }
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ cv2.waitKey(0) }
\DoxyCodeLine{00628\  }
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ warped }
\DoxyCodeLine{00630\  }
\DoxyCodeLine{00631\  }

\end{DoxyCode}


References App.\+image, room\+\_\+estimation.\+image, and person\+\_\+tab.\+image.

\Hypertarget{a00206_ae4a382139afef48e3b930752120b4c35}\label{a00206_ae4a382139afef48e3b930752120b4c35} 
\index{room\_estimation@{room\_estimation}!define\_perspective\_grid@{define\_perspective\_grid}}
\index{define\_perspective\_grid@{define\_perspective\_grid}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{define\_perspective\_grid()}{define\_perspective\_grid()}}
{\footnotesize\ttfamily define\+\_\+perspective\+\_\+grid (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{division = {\ttfamily 10},  }\item[{}]{extend = {\ttfamily 500} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Assign 4 corners on an image where a grid will be projected into that space. This only selects the points and draws the edges. This should be called before superimpose_checker.

See superimpose_checker for definition of the grid and how it works.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01568\ \ \ \ \ \textcolor{keyword}{def\ }define\_perspective\_grid(self,\ division=10,\ extend\ =\ 500): }
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01570\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Assign\ 4\ corners\ on\ an\ image\ where\ a\ grid\ will\ be\ projected\ into\ that\ space.\ This\ only\ selects\ the\ points\ and\ draws\ the\ edges.\ This\ should\ be\ called\ before\ superimpose\_checker. }}
\DoxyCodeLine{01571\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01572\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ See\ superimpose\_checker\ for\ definition\ of\ the\ grid\ and\ how\ it\ works. }}
\DoxyCodeLine{01573\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01574\ \ \ \ \ \ \ \ \ wall\ =\ self.get\_room\_corners() }
\DoxyCodeLine{01575\  }
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Describe\ a\ line\ with\ the\ two\ end\ points }}
\DoxyCodeLine{01577\ \ \ \ \ \ \ \ \ fit1,\ equation1\ =\ self.poly\_fit\_wall(wall,\ pixels\_past\_extent=1000,\ degree=1) }
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ line\_1\ =\ (fit1[0],\ fit1[-\/1]) }
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ self.clear\_corners() }
\DoxyCodeLine{01580\  }
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ wall\ =\ self.get\_room\_corners() }
\DoxyCodeLine{01582\ \ \ \ \ \ \ \ \ fit2,\ equation2\ =\ self.poly\_fit\_wall(wall,\ pixels\_past\_extent=1000,\ degree=1) }
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ line\_2\ =\ (fit2[0],\ fit2[-\/1]) }
\DoxyCodeLine{01584\  }
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ intersection\ =\ self.find\_intersection(equation1,\ equation2) }
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.circle(self.show\_img,\ (int(intersection[0]),\ int(intersection[1])),\ 1,(0,255,0),\ 5,\ 0) }
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ print(intersection) }
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.make\_interpolater() }}
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x1i\ =\ interpolate.interp1d(line\_1[0],line\_1[1]) }}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ y1i\ =\ interpolate.interp1d(line\_2[0],line\_2[1]) }}
\DoxyCodeLine{01592\  }
\DoxyCodeLine{01593\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x2i\ =\ interpolate.interp1d(line\_1[0],line\_2[0]) }}
\DoxyCodeLine{01594\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ y2i\ =\ interpolate.interp1d(line\_1[1],line\_2[1]) }}
\DoxyCodeLine{01595\  }
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ edge,\ step1\ =\ np.linspace(line\_1[0]\ -\/\ extend,\ line\_2[0]\ +\ extend,\ division,\ endpoint=\textcolor{keyword}{True},\ retstep=\textcolor{keyword}{True}) }
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ edge2,\ step2\ =\ np.linspace(line\_1[1]\ -\/\ extend,\ line\_2[1]\ +\ extend,\ division,\ endpoint=\textcolor{keyword}{True},\ retstep=\textcolor{keyword}{True}) }
\DoxyCodeLine{01598\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(edge)): }
\DoxyCodeLine{01600\ \ \ \ \ \ \ \ \ \ \ \ \ start\ =\ (int(edge[i][0]),int(edge[i][1])) }
\DoxyCodeLine{01601\ \ \ \ \ \ \ \ \ \ \ \ \ end\ =\ (int(intersection[0]),\ int(intersection[1])) }
\DoxyCodeLine{01602\ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.line(self.show\_img,\ start,\ end,\ (255,0,0)) }
\DoxyCodeLine{01603\  }
\DoxyCodeLine{01604\  }
\DoxyCodeLine{01605\ \ \ \ \ \ \ \ \ \ \ \ \ start\ =\ (int(edge2[i][0]),int(edge2[i][1])) }
\DoxyCodeLine{01606\ \ \ \ \ \ \ \ \ \ \ \ \ end\ =\ (int(intersection[0]),\ int(intersection[1])) }
\DoxyCodeLine{01607\  }
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.line(self.show\_img,\ start,\ end,\ (255,0,0)) }
\DoxyCodeLine{01609\  }
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ i\ \%\ 10\ ==\ 0: }
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.line(self.show\_img,\ start,\ end,\ (0,100,0),\ thickness=2) }
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}test\_interp"{}},\ self.show\_img) }
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01614\  }
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ self.clear\_corners() }
\DoxyCodeLine{01616\  }
\DoxyCodeLine{01617\  }

\end{DoxyCode}


References room\+\_\+estimation.\+clear\+\_\+corners(), \mbox{\hyperlink{a00206_a54166ae0c7b7f8e5aadcc81eda56ce58}{room\+\_\+estimation.\+find\+\_\+intersection()}}, \mbox{\hyperlink{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba}{room\+\_\+estimation.\+get\+\_\+room\+\_\+corners()}}, \mbox{\hyperlink{a00206_a9ddc57e65b6b90133dae37504451b764}{room\+\_\+estimation.\+poly\+\_\+fit\+\_\+wall()}}, and room\+\_\+estimation.\+show\+\_\+img.

Here is the call graph for this function\+:
% FIG 5
\Hypertarget{a00206_a84fbd0580af51d4905aeeb1b71889390}\label{a00206_a84fbd0580af51d4905aeeb1b71889390} 
\index{room\_estimation@{room\_estimation}!define\_room@{define\_room}}
\index{define\_room@{define\_room}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{define\_room()}{define\_room()}}
{\footnotesize\ttfamily define\+\_\+room (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{width = {\ttfamily None},  }\item[{}]{length = {\ttfamily None},  }\item[{}]{height = {\ttfamily None},  }\item[{}]{offset = {\ttfamily \mbox{[}0,0,0,0\mbox{]}},  }\item[{}]{corners = {\ttfamily None},  }\item[{}]{room\+\_\+points = {\ttfamily None},  }\item[{}]{refine\+\_\+corners = {\ttfamily False},  }\item[{}]{image = {\ttfamily None},  }\item[{}]{stitch\+\_\+videos = {\ttfamily None},  }\item[{}]{calibration = {\ttfamily None},  }\item[{}]{extend = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Takes variables and defines a room

- width: and length are in mm

- height: is the assumed height of all objects in the room

- offset: is used when we extend the image to get all of the corners.
NOTE: If arrows do not line up with lines you drew, the camera matrix or the distortion matrix are off

- room_points: are the real-world defined points in mm (if not defined points are the height and width of the room)

- refine_corners: is opencv's sub-pixel optimizer to better estimate corner locations. This is mostly used in checkerboard calibration but may be useful when manually selecting corners.

- calibration: is the calibration saved from a video (enter a video to calibrate, if calibration has been done save results in a pickle file)\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keyword}{def\ }define\_room(self,\ width=None,\ length=None,\ height=None,\ offset=[0,0,0,0],\ corners=None,\ room\_points=None,\ refine\_corners=False,\ image=None,\ stitch\_videos=None,\ calibration=None,\ extend=None): }
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{00250\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Takes\ variables\ and\ defines\ a\ room }}
\DoxyCodeLine{00251\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ width:\ and\ length\ are\ in\ mm }}
\DoxyCodeLine{00253\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00254\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ height:\ is\ the\ assumed\ height\ of\ all\ objects\ in\ the\ room }}
\DoxyCodeLine{00255\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00256\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ offset:\ is\ used\ when\ we\ extend\ the\ image\ to\ get\ all\ of\ the\ corners. }}
\DoxyCodeLine{00257\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ NOTE:\ If\ arrows\ do\ not\ line\ up\ with\ lines\ you\ drew,\ the\ camera\ matrix\ or\ the\ distortion\ matrix\ are\ off }}
\DoxyCodeLine{00258\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ room\_points:\ are\ the\ real-\/world\ defined\ points\ in\ mm\ (if\ not\ defined\ points\ are\ the\ height\ and\ width\ of\ the\ room) }}
\DoxyCodeLine{00260\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ refine\_corners:\ is\ opencv's\ sub-\/pixel\ optimizer\ to\ better\ estimate\ corner\ locations.\ This\ is\ mostly\ used\ in\ checkerboard\ calibration\ but\ may\ be\ useful\ when\ manually\ selecting\ corners. }}
\DoxyCodeLine{00262\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ calibration:\ is\ the\ calibration\ saved\ from\ a\ video\ (enter\ a\ video\ to\ calibrate,\ if\ calibration\ has\ been\ done\ save\ results\ in\ a\ pickle\ file) }}
\DoxyCodeLine{00264\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{00266\  }
\DoxyCodeLine{00267\  }
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ width\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_width\ =\ width }
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ length\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_length\ =\ length }
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ height\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_height\ =\ height }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ calibration\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ calibration\_path\ =\ calibration[:-\/3]\ +\ \textcolor{stringliteral}{"{}pickle"{}} }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ self.load\_calibration(calibration\_path) }
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00280\  }
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Stitch\ images\ takes\ care\ of\ undistortion\ based\ on\ calibration }}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ stitch\_videos\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00283\  }
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ self.image,\ self.stitch\_homographies\ =\ self.stitch\_rooms(stitch\_videos,\ key\_index=3) }
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ deepcopy(self.image) }
\DoxyCodeLine{00286\  }
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Undistort\ images }}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ self.undistort\_room() }
\DoxyCodeLine{00290\  }
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ find\ extention\ before\ selecting\ points\ so\ you\ do\ not\ have\ to\ calculate\ offset }}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ extend\ is\ the\ number\ of\ walls\ you\ want\ to\ extend.\ Each\ wall\ intersection/extention\ requires\ 2\ walls,\ 4\ estimates\ each. }}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ offsets\ =\ [0,0,0,0] }
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ extend\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(extend): }
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intersection\ =\ self.find\_wall\_intersection(degree=1) }
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ offset\ =\ [top,\ left,\ bottom,\ right]\ in\ pixels }}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.image,\ offset\ =\ self.extend\_image\_to\_corners(self.image,\ intersection) }
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =self.image }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Offsets\ are\ the\ maximum\ offset\ values\ between\ all\ edges }}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ value\ \textcolor{keywordflow}{in}\ enumerate(offset): }
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ offsets[index]\ <\ value: }
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ offsets[index]\ =\ offset[index] }
\DoxyCodeLine{00304\  }
\DoxyCodeLine{00305\  }
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ self.image\ =\ self.superimpose\_checker() }
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ self.show\_img\ =self.image }
\DoxyCodeLine{00308\  }
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ stitch\_videos\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ self.stitch\_trackers(stitch\_videos,\ self.stitch\_homographies,\ offsets) }
\DoxyCodeLine{00311\  }
\DoxyCodeLine{00312\  }
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ creates\ a\ 4\ corner\ room\ in\ real\ coordinates }}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ room\_points\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Choose\ your\ points\ for\ the\ defined\ corners\ (in\ order)"{}}) }
\DoxyCodeLine{00316\  }
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Assign\ real\ world\ coordinates }}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_points\ =\ room\_points }
\DoxyCodeLine{00319\  }
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Assign\ a\ rectangular\ shape\ given\ room\ points\ (width\ and\ length) }}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_width,\ self.room\_length\ =\ self.get\_room\_dimensions(room\_points) }
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ get\ 2D\ locations\ which\ will\ map\ to\ real\ world\ room\ points }}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ self.corners\ =\ self.get\_room\_corners(len(room\_points)) }
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ room\_points\ =\ np.reshape(np.asfarray(room\_points),\ (len(room\_points),3,1)) }
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_points\ =\ room\_points }
\DoxyCodeLine{00327\  }
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\  }}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ corners\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ width\ ==\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{or}\ length\ ==\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ room\_points,\ self.corners\ =\ self.assign\_non\_square\_corners() }
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ room\_points\ =\ self.get\_room\_points(self.room\_width,\ self.room\_length) }
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.corners\ =\ self.get\_room\_corners() }
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ print(self.corners) }
\DoxyCodeLine{00339\  }
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ''' }}
\DoxyCodeLine{00341\  }
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ refine\_corners: }
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ assert(image\ !=\ None) }}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ image\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ self.image }
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Refer\ to\ https://docs.opencv.org/3.4/dd/d1a/group\_\_imgproc\_\_feature.html\#ga354e0d7c86d0d9da75de9b9701a9a87e }}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{00348\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ W\ FORSTNER.\ A\ fast\ operator\ for\ detection\ and\ precise\ location\ of\ distincs\ points,\ corners\ and\ center\ of\ circular\ features.\ In\ Proc.\ of\ the\ Intercommission\ Conference\ on\ Fast\ Processing\ of\ Photogrammetric\ Data,\ Interlaken,\ Switzerland,\ 1987,\ pages\ 281–305,\ 1987. }}
\DoxyCodeLine{00349\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ maxCorners\ =\ max(5000,\ 1) }}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \#\ Parameters\ for\ Shi-\/Tomasi\ algorithm }}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ qualityLevel\ =\ 0.01 }}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ minDistance\ =\ 10 }}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ blockSize\ =\ 3 }}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ gradientSize\ =\ 3 }}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ useHarrisDetector\ =\ False }}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ k\ =\ 0.05 }}
\DoxyCodeLine{00358\  }
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ src\_gray\ =\ cv2.cvtColor(image,\ cv2.COLOR\_BGR2GRAY) }
\DoxyCodeLine{00360\  }
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Apply\ corner\ detection }}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ corners\ =\ cv2.goodFeaturesToTrack(src\_gray,\ maxCorners,\ qualityLevel,\ minDistance,\ None,\ \(\backslash\) }}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ blockSize=blockSize,\ gradientSize=gradientSize,\ useHarrisDetector=useHarrisDetector,\ k=k) }}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Draw\ corners\ detected }}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print('**\ Number\ of\ corners\ detected:',\ self.corners.shape[0]) }}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ radius\ =\ 4 }}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ i\ in\ range(corners.shape[0]): }}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.circle(src\_gray,\ (int(corners[i,0,0]),\ int(corners[i,0,1])),\ radius,\ (rng.randint(0,256),\ rng.randint(0,256),\ rng.randint(0,256)),\ cv2.FILLED) }}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Set\ the\ needed\ parameters\ to\ find\ the\ refined\ corners }}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ winSize\ =\ (5,\ 5) }
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ zeroZone\ =\ (-\/1,\ -\/1) }
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ criteria\ =\ (cv2.TERM\_CRITERIA\_EPS\ +\ cv2.TermCriteria\_COUNT,\ 40,\ 0.001) }
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Calculate\ the\ refined\ corner\ locations }}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ src\_gray\ =\ cv2.cvtColor(image,\ cv2.COLOR\_BGR2GRAY) }
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ self.corners\ =\ cv2.cornerSubPix(src\_gray,\ self.corners,\ winSize,\ zeroZone,\ criteria) }
\DoxyCodeLine{00377\  }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Corner\ Detection"{}},\ src\_gray) }
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(0) }
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00381\  }
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(room\_points) }}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.corners,\ room\_points\ =\ self.assign\_non\_square\_corners() }}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \#\ Correct\ for\ offsets\ with\ exteneded\ image }}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ offset\ =\ [top,\ left,\ bottom,\ right] }}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ index,\ corner\ in\ enumerate(self.corners): }}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ x,y\ =self.corners[index] }}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ self.corners[index]\ =\ ((x\ -\/\ offset[1]),\ (y\ -\/\ offset[0])) }}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(room\_points) }}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(self.corners) }}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ key\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}: }
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ test\_image\ =\ deepcopy(self.image) }
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Room\ Dimensions"{}},\ self.room\_width,\ self.room\_length) }
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ room\_points\ =\ self.get\_room\_points(self.room\_width,\ self.room\_length) }
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#NOTE\ This\ is\ calculated\ after\ distortion\ is\ corrected }}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Because\ we\ correct\ for\ this,\ distortion\ should\ be\ "{}None"{}\ as\ we\ undistort\ already.\  }}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ retval,\ rvecs,\ tvecs\ =\ cv2.solvePnP(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ self.distioriton\_matrix) }}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ retval,\ rvecs,\ tvecs\ =\ cv2.solvePnP(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ None) }}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ r1,\ t1\ =\ cv2.solvePnP(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ \textcolor{keywordtype}{None},\ cv2.SOLVEPNP\_IPPE,\ useExtrinsicGuess=\textcolor{keyword}{False}) }
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ r2,\ t2\ =\ cv2.solvePnP(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ \textcolor{keywordtype}{None},\ cv2.SOLVEPNP\_EPNP,\ useExtrinsicGuess=\textcolor{keyword}{False}) }
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ r3,\ t3\ =\ cv2.solvePnP(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ \textcolor{keywordtype}{None},\ cv2.SOLVEPNP\_ITERATIVE,\ useExtrinsicGuess=\textcolor{keyword}{False}) }
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ r4,\ t4\ =\ cv2.solvePnP(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ \textcolor{keywordtype}{None},\ cv2.SOLVEPNP\_MAX\_COUNT,\ useExtrinsicGuess=\textcolor{keyword}{False}) }
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ r5,\ t5\ =\ cv2.solvePnP(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ \textcolor{keywordtype}{None},\ cv2.SOLVEPNP\_UPNP,\ useExtrinsicGuess=\textcolor{keyword}{False}) }
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ r1,\ t1,\ inliers\ =\ cv2.solvePnPRansac(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ \textcolor{keywordtype}{None}) }
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ img1,\ cube,\ target\_cube\ =\ self.draw\_cuboid(image=test\_image,\ rvec=r1,\ tvec=t1) }
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Iterative\ Default"{}},\ img1) }
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(0) }
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Returns\ all\ solutions }}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ retval,\ rall,\ tall,\ error\ =\ cv2.solvePnPGeneric(room\_points.astype(np.float64),\ self.corners.astype(np.float64),\ self.camera\_matrix,\ None) }}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ i\ in\ range(len(rall)): }}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ img1,\ cube,\ target\_cube\ =\ self.draw\_cuboid(image=test\_image,\ rvec=rall[i],\ tvec=tall[i]) }}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.imshow("{}Iterative\ Default"{},\ img1) }}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.waitKey(0) }}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \#\ self.rotation\_vector\ =\ rvecs }}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.translation\_vector\ =\ tvecs }}
\DoxyCodeLine{00420\  }
\DoxyCodeLine{00421\  }
\DoxyCodeLine{00422\  }
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'q'}): }
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'='}): }
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_width\ +=\ 100 }
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'-\/'}): }
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_width\ -\/=\ 100 }
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'0'}): }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_length\ +=\ 100 }
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'9'}): }
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_length\ -\/=\ 100 }
\DoxyCodeLine{00434\  }
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ point\ =\ 0 }
\DoxyCodeLine{00436\  }
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'1'}): }
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ point\ =\ 1 }
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'2'}): }
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ point\ =\ 2 }
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'3'}): }
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ point\ =\ 3 }
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'4'}): }
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ point\ =\ 4 }
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00446\  }
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ self.set\_axis(self.room\_width,\ self.room\_height,\ self.room\_length) }
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ img1,\ cube,\ target\_cube\ =\ self.draw\_cuboid(image=test\_image,\ rvec=r1,\ tvec=t1) }
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ img2,\ cube,\ target\_cube\ =\ self.draw\_cuboid(image=test\_image,\ rvec=r2,\ tvec=t2) }
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ img3,\ cube,\ target\_cube\ =\ self.draw\_cuboid(image=test\_image,\ rvec=r3,\ tvec=t3) }
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ img4,\ cube,\ target\_cube\ =\ self.draw\_cuboid(image=test\_image,\ rvec=r4,\ tvec=t4) }
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ img5,\ cube,\ target\_cube\ =\ self.draw\_cuboid(image=test\_image,\ rvec=r5,\ tvec=t5) }
\DoxyCodeLine{00453\  }
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}IPPE"{}},\ img1) }
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}EPNP"{}},\ img2) }
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}ITERATIVE"{}},\ img3) }
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}MAX\_COUNT"{}},\ img4) }
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}UPNP"{}},\ img5) }
\DoxyCodeLine{00459\  }
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ key\ =\ cv2.waitKey(1) }
\DoxyCodeLine{00461\  }

\end{DoxyCode}
\Hypertarget{a00206_a5b5abc31dfc859a8bd979479f51da933}\label{a00206_a5b5abc31dfc859a8bd979479f51da933} 
\index{room\_estimation@{room\_estimation}!define\_sides@{define\_sides}}
\index{define\_sides@{define\_sides}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{define\_sides()}{define\_sides()}}
{\footnotesize\ttfamily define\+\_\+sides (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{sides,  }\item[{}]{lengths }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{keyword}{def\ }define\_sides(self,\ sides,\ lengths): }
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass} }
\DoxyCodeLine{00247\  }

\end{DoxyCode}
\Hypertarget{a00206_acd30d2c67d090d15947b3abde53e876f}\label{a00206_acd30d2c67d090d15947b3abde53e876f} 
\index{room\_estimation@{room\_estimation}!display\_3D\_Plot@{display\_3D\_Plot}}
\index{display\_3D\_Plot@{display\_3D\_Plot}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{display\_3D\_Plot()}{display\_3D\_Plot()}}
{\footnotesize\ttfamily display\+\_\+3\+D\+\_\+\+Plot (\begin{DoxyParamCaption}\item[{}]{points,  }\item[{}]{shown }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00755\ \ \ \ \ \textcolor{keyword}{def\ }display\_3D\_Plot(points,\ shown): }
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ fig\ =\ plt.figure() }
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ ax\ =\ plt.axes(projection=\textcolor{stringliteral}{'3d'}) }
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ x\_data\ =\ points[0] }
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ y\_data\ =\ points[1] }
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ z\_data\ =\ points[2] }
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ scatter\ =\ ax.scatter3D(x\_data,\ y\_data,z\_data,\ cmap=\textcolor{stringliteral}{'Greens'}) }
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ shown: }
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ fig.canvas.draw() }
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ fig.canvas.flush\_events() }
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ fig.show() }
\DoxyCodeLine{00768\  }
\DoxyCodeLine{00769\  }

\end{DoxyCode}
\Hypertarget{a00206_a61a9f1d7c10c86838c5928c76bb2ca59}\label{a00206_a61a9f1d7c10c86838c5928c76bb2ca59} 
\index{room\_estimation@{room\_estimation}!display\_room@{display\_room}}
\index{display\_room@{display\_room}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{display\_room()}{display\_room()}}
{\footnotesize\ttfamily display\+\_\+room (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image = {\ttfamily None},  }\item[{}]{axis = {\ttfamily True},  }\item[{}]{box = {\ttfamily True},  }\item[{}]{show\+\_\+3d\+\_\+plot = {\ttfamily True},  }\item[{}]{with\+\_\+points = {\ttfamily False} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keyword}{def\ }display\_room(self,\ image=None,\ axis=True,\ box=True,\ show\_3d\_plot=True,\ \ with\_points=False): }
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}: }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.draw\_vector() }}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ axis: }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.draw\_axis() }
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ box: }
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}: }
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.draw\_box() }
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}: }
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass} }
\DoxyCodeLine{00213\  }
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ show\_3d\_plot: }}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ self.show\_3D\_plot() }}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ image\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Show\ img"{}}) }
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(self.window\_name,\ image) }
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(self.window\_name,\ self.show\_img) }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ key\ =\ cv2.waitKey(1) }
\DoxyCodeLine{00222\  }
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{'c'}): }
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{00225\  }

\end{DoxyCode}
\Hypertarget{a00206_a6b52f7921f3d60a3a6b7d2dc641aa44c}\label{a00206_a6b52f7921f3d60a3a6b7d2dc641aa44c} 
\index{room\_estimation@{room\_estimation}!draw\_axis@{draw\_axis}}
\index{draw\_axis@{draw\_axis}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{draw\_axis()}{draw\_axis()}}
{\footnotesize\ttfamily draw\+\_\+axis (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00770\ \ \ \ \ \textcolor{keyword}{def\ }draw\_axis(self): }
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ projected,\ jac\ =\ cv2.projectPoints(self.axis,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ corner\ =\ tuple(self.corners[0].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ corner2\ =\ tuple(projected[0].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ corner3\ =\ tuple(projected[1].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ corner4\ =\ tuple(projected[2].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ cv2.putText(self.show\_img,\textcolor{stringliteral}{"{}x"{}},corner2,fontFace=cv2.FONT\_HERSHEY\_PLAIN,fontScale=2,\ color=(255,0,0)) }
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ cv2.putText(self.show\_img,\textcolor{stringliteral}{"{}y"{}},corner4,fontFace=cv2.FONT\_HERSHEY\_PLAIN,fontScale=2,\ color=(0,255,0)) }
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ cv2.putText(self.show\_img,\textcolor{stringliteral}{"{}z"{}},corner3,fontFace=cv2.FONT\_HERSHEY\_PLAIN,fontScale=2,\ color=(0,0,255)) }
\DoxyCodeLine{00781\  }
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.arrowedLine(self.show\_img,\ corner,\ corner2,\ (255,0,0),\ 2) }
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.arrowedLine(self.show\_img,\ corner,\ corner4,\ (0,255,0),\ 2) }
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.arrowedLine(self.show\_img,\ corner,\ corner3,\ (0,0,255),\ 2) }
\DoxyCodeLine{00785\  }
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.show\_img }
\DoxyCodeLine{00787\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a8277f150767e58ce0824de54928fb184}{room\+\_\+estimation.\+get\+\_\+3d\+\_\+to\+\_\+2d()}}.

Here is the caller graph for this function\+:
% FIG 6
\Hypertarget{a00206_a07baa9eba436c81cea0c49e0d5b5099f}\label{a00206_a07baa9eba436c81cea0c49e0d5b5099f} 
\index{room\_estimation@{room\_estimation}!draw\_box@{draw\_box}}
\index{draw\_box@{draw\_box}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{draw\_box()}{draw\_box()}}
{\footnotesize\ttfamily draw\+\_\+box (\begin{DoxyParamCaption}\item[{}]{img,  }\item[{}]{corners,  }\item[{}]{imgpts }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00874\ \ \ \ \ \textcolor{keyword}{def\ }draw\_box(img,\ corners,\ imgpts): }
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ imgpts\ =\ np.int32(imgpts).reshape(-\/1,2) }
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ draw\ ground\ floor\ in\ green }}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ img\ =\ cv2.drawContours(img,\ [imgpts[:4]],-\/1,(0,255,0),-\/3) }
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ draw\ pillars\ in\ blue\ color }}
\DoxyCodeLine{00879\  }
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i,j\ \textcolor{keywordflow}{in}\ zip(range(4),range(4,8)): }
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ \ \ img\ =\ cv2.line(img,\ tuple(imgpts[i]),\ tuple(imgpts[j]),(255),3) }
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ draw\ top\ layer\ in\ red\ color }}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ img\ =\ cv2.drawContours(img,\ [imgpts[4:]],-\/1,(0,0,255),3) }
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ img }
\DoxyCodeLine{00885\  }

\end{DoxyCode}
\Hypertarget{a00206_aef4827bfb173a05c4794fb8b29ec8055}\label{a00206_aef4827bfb173a05c4794fb8b29ec8055} 
\index{room\_estimation@{room\_estimation}!draw\_cuboid@{draw\_cuboid}}
\index{draw\_cuboid@{draw\_cuboid}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{draw\_cuboid()}{draw\_cuboid()}}
{\footnotesize\ttfamily draw\+\_\+cuboid (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image = {\ttfamily None},  }\item[{}]{distortion = {\ttfamily None},  }\item[{}]{rvec = {\ttfamily None},  }\item[{}]{tvec = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}    Distortion is removed if image is undistorted.
    Rvec and Tvec are transformation vectors calculated by previous SolvePNP, so we use that if we have alerady done so.
    6        7
   *--------*
 / |       /|
2 *---------*3|
|  * 5    | *8
| /       |/
1 *---------*4\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keyword}{def\ }draw\_cuboid(self,\ image=None,\ distortion=None,\ rvec=None,\ tvec=None): }
\DoxyCodeLine{00789\  }
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''\ \  }}
\DoxyCodeLine{00791\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Distortion\ is\ removed\ if\ image\ is\ undistorted. }}
\DoxyCodeLine{00792\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Rvec\ and\ Tvec\ are\ transformation\ vectors\ calculated\ by\ previous\ SolvePNP,\ so\ we\ use\ that\ if\ we\ have\ alerady\ done\ so. }}
\DoxyCodeLine{00793\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 6\ \ \ \ \ \ \ \ 7 }}
\DoxyCodeLine{00794\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ *-\/-\/-\/-\/-\/-\/-\/-\/* }}
\DoxyCodeLine{00795\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ /\ |\ \ \ \ \ \ \ /| }}
\DoxyCodeLine{00796\ \textcolor{stringliteral}{\ \ \ \ \ \ 2\ *-\/-\/-\/-\/-\/-\/-\/-\/-\/*3| }}
\DoxyCodeLine{00797\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ \ *\ 5\ \ \ \ |\ *8 }}
\DoxyCodeLine{00798\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ /\ \ \ \ \ \ \ |/ }}
\DoxyCodeLine{00799\ \textcolor{stringliteral}{\ \ \ \ \ \ 1\ *-\/-\/-\/-\/-\/-\/-\/-\/-\/*4 }}
\DoxyCodeLine{00800\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00801\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{00802\  }
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ cube\ =\ np.float32([\ [0,0,0],\ \textcolor{comment}{\#1 }}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,0,self.room\_height],\ \textcolor{comment}{\#2\ Y }}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [self.room\_width,0,self.room\_height],\ \textcolor{comment}{\#\ 3 }}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [self.room\_width,0,0],\ \textcolor{comment}{\#4\ X }}
\DoxyCodeLine{00807\  }
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,self.room\_length,0], }
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,self.room\_length,self.room\_height], }
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [self.room\_width,self.room\_length,self.room\_height], }
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [self.room\_width,self.room\_length,0] }
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]).reshape(-\/1,3) }
\DoxyCodeLine{00814\  }
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ retval,\ rvecs,\ tvecs,\ inliers\ =\ cv2.solvePnPRansac(cube.astype(np.float64),\ selected\_2d.astype(np.float64),\ self.camera\_matrix,\ distortion,\ rvec=rvec,\ tvec=tvec) }}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ rvecs,\ tvecs\ =\ [None,\ None] }}
\DoxyCodeLine{00817\  }
\DoxyCodeLine{00818\  }
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ try: }}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ if\ distortion: }}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ retval,\ rvecs,\ tvecs\ =\ cv2.solvePnP(points.astype(np.float64),\ corners.astype(np.float64),\ self.camera\_matrix,\ self.distioriton\_matrix) }}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ else: }}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ retval,\ rvecs,\ tvecs\ =cv2.solvePnP(points.astype(np.float64),\ corners.astype(np.float64),\ self.camera\_matrix,\ self.distioriton\_matrix) }}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ except: }}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ try: }}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ corners\ =\ np.reshape(np.asfarray(self.corners),\ (len(self.corners),2,1)) }}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ retval,\ rvecs,\ tvecs\ =\ cv2.solvePnP(self.room\_points.astype(np.float64),\ corners.astype(np.float64),\ self.camera\_matrix,\ self.distioriton\_matrix) }}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ except: }}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ corners\ =\ np.reshape(np.asfarray(self.corners),\ (len(self.corners),2,1)) }}
\DoxyCodeLine{00830\  }
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ points\ =\ self.get\_n\_room\_points(self.room\_points[:corners.shape[0]]) }}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ retval,\ rvecs,\ tvecs\ =\ cv2.solvePnP(points.astype(np.float64),\ corners.astype(np.float64),\ self.camera\_matrix,\ self.distioriton\_matrix) }}
\DoxyCodeLine{00833\  }
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ projected,\ jac\ =\ cv2.projectPoints(cube,\ rvec,\ tvec,\ self.camera\_matrix,\ distortion) }
\DoxyCodeLine{00836\  }
\DoxyCodeLine{00837\  }
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ corner1\ =\ tuple(projected[0].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ corner2\ =\ tuple(projected[1].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ corner3\ =\ tuple(projected[2].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ corner4\ =\ tuple(projected[3].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ corner5\ =\ tuple(projected[4].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ corner6\ =\ tuple(projected[5].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ corner7\ =\ tuple(projected[6].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ corner8\ =\ tuple(projected[7].ravel().astype(\textcolor{stringliteral}{'int32'})) }
\DoxyCodeLine{00847\  }
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ projected\_cube\ =\ [corner1,\ corner2,\ corner3,\ corner4,\ corner5,\ corner6,\ corner7,\ corner8] }
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ image\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ self.show\_img }
\DoxyCodeLine{00852\  }
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ cv2.putText(image,\textcolor{stringliteral}{"{}x"{}},corner4,fontFace=cv2.FONT\_HERSHEY\_PLAIN,fontScale=2,\ color=(255,25,200)) }
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ cv2.putText(image,\textcolor{stringliteral}{"{}y"{}},corner2,fontFace=cv2.FONT\_HERSHEY\_PLAIN,fontScale=2,\ color=(0,255,0)) }
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ cv2.putText(image,\textcolor{stringliteral}{"{}z"{}},corner5,fontFace=cv2.FONT\_HERSHEY\_PLAIN,fontScale=2,\ color=(0,0,255)) }
\DoxyCodeLine{00856\  }
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner1,\ corner2,\ (0,255,0),\ 2)\ \textcolor{comment}{\#\ Y }}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner2,\ corner3,\ (255,0,0),\ 2) }
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner3,\ corner4,\ (255,0,0),\ 2) }
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner1,\ corner4,\ (255,25,200),\ 2)\ \textcolor{comment}{\#X }}
\DoxyCodeLine{00861\  }
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner5,\ corner6,\ (255,0,0),\ 2) }
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner6,\ corner7,\ (255,0,0),\ 2) }
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner7,\ corner8,\ (255,0,0),\ 2) }
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner8,\ corner5,\ (255,0,0),\ 2) }
\DoxyCodeLine{00866\  }
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner1,\ corner5,\ (0,0,255),\ 2)\ \textcolor{comment}{\#Z }}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner2,\ corner6,\ (255,0,0),\ 2) }
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner3,\ corner7,\ (255,0,0),\ 2) }
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ corner4,\ corner8,\ (255,0,0),\ 2) }
\DoxyCodeLine{00871\  }
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ image,\ cube,\ projected\_cube }
\DoxyCodeLine{00873\  }

\end{DoxyCode}


References room\+\_\+estimation.\+ax, room\+\_\+estimation.\+back\+\_\+plt, room\+\_\+estimation.\+camera\+\_\+matrix, room\+\_\+estimation.\+distioriton\+\_\+matrix, room\+\_\+estimation.\+fig, room\+\_\+estimation.\+float\+\_\+plt, room\+\_\+estimation.\+front\+\_\+plt, room\+\_\+estimation.\+line\+\_\+plt, room\+\_\+estimation.\+mapped, room\+\_\+estimation.\+mapped\+\_\+dictionary, room\+\_\+estimation.\+points\+\_\+plt, room\+\_\+estimation.\+quiver, room\+\_\+estimation.\+room\+\_\+height, room\+\_\+estimation.\+room\+\_\+length, room\+\_\+estimation.\+room\+\_\+width, room\+\_\+estimation.\+rotation\+\_\+vector, room\+\_\+estimation.\+show\+\_\+3\+D\+\_\+plot, room\+\_\+estimation.\+show\+\_\+img, room\+\_\+estimation.\+translation\+\_\+vector, room\+\_\+estimation.\+vector\+\_\+depth, and room\+\_\+estimation.\+window\+\_\+name.

\Hypertarget{a00206_ab20e46a19ec3f0b9c7fd04d2264ba8a1}\label{a00206_ab20e46a19ec3f0b9c7fd04d2264ba8a1} 
\index{room\_estimation@{room\_estimation}!draw\_grid@{draw\_grid}}
\index{draw\_grid@{draw\_grid}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{draw\_grid()}{draw\_grid()}}
{\footnotesize\ttfamily draw\+\_\+grid (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{grid\+\_\+shape = {\ttfamily (20,20)},  }\item[{}]{color = {\ttfamily (255,~255,~255)},  }\item[{}]{thickness = {\ttfamily 2} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02704\ \ \ \ \ \textcolor{keyword}{def\ }draw\_grid(self,\ grid\_shape=(20,20),\ color=(255,\ 255,\ 255),\ thickness=2): }
\DoxyCodeLine{02705\ \ \ \ \ \ \ \ \ h\ =\ 1080 }
\DoxyCodeLine{02706\ \ \ \ \ \ \ \ \ w\ =\ 1080 }
\DoxyCodeLine{02707\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ h,\ w,\ \_\ =\ img.shape }}
\DoxyCodeLine{02708\ \ \ \ \ \ \ \ \ img\ =\ np.zeros((h,\ w,\ 3),\ dtype\ =\ \textcolor{stringliteral}{"{}uint8"{}}) }
\DoxyCodeLine{02709\ \ \ \ \ \ \ \ \ rows,\ cols\ =\ grid\_shape }
\DoxyCodeLine{02710\ \ \ \ \ \ \ \ \ dy,\ dx\ =\ h\ /\ rows,\ w\ /\ cols }
\DoxyCodeLine{02711\  }
\DoxyCodeLine{02712\  }
\DoxyCodeLine{02713\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ draw\ vertical\ lines }}
\DoxyCodeLine{02714\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ x\ \textcolor{keywordflow}{in}\ enumerate(np.linspace(start=dx,\ stop=w-\/dx,\ num=cols-\/1)): }
\DoxyCodeLine{02715\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ index\ ==\ (cols-\/1)/2: }
\DoxyCodeLine{02716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ int(round(x)) }
\DoxyCodeLine{02717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ img\ =\ cv2.line(img,\ (x,\ 0),\ (x,\ h),\ color=(255,0,255),\ thickness=7) }
\DoxyCodeLine{02718\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{02719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ int(round(x)) }
\DoxyCodeLine{02720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ img\ =\ cv2.line(img,\ (x,\ 0),\ (x,\ h),\ color=color,\ thickness=thickness) }
\DoxyCodeLine{02721\  }
\DoxyCodeLine{02722\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ draw\ horizontal\ lines }}
\DoxyCodeLine{02723\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ y\ \textcolor{keywordflow}{in}\ enumerate(np.linspace(start=dy,\ stop=h-\/dy,\ num=rows-\/1)): }
\DoxyCodeLine{02724\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ index\ ==\ (rows-\/1)/2: }
\DoxyCodeLine{02725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ int(round(y)) }
\DoxyCodeLine{02726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ img\ =\ cv2.line(img,\ (0,\ y),\ (w,\ y),\ color=(255,0,255),\ thickness=7) }
\DoxyCodeLine{02727\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{02728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ int(round(y)) }
\DoxyCodeLine{02729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ img\ =\ cv2.line(img,\ (0,\ y),\ (w,\ y),\ color=color,\ thickness=thickness) }
\DoxyCodeLine{02730\  }
\DoxyCodeLine{02731\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ img }
\DoxyCodeLine{02732\  }
\DoxyCodeLine{02733\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_abeac4cbae89aef891cee148cbbbc6232}{room\+\_\+estimation.\+superimpose\+\_\+checker()}}.

Here is the caller graph for this function\+:
% FIG 7
\Hypertarget{a00206_a9efcb6eeef35186ade72c0bbc5c531fe}\label{a00206_a9efcb6eeef35186ade72c0bbc5c531fe} 
\index{room\_estimation@{room\_estimation}!draw\_point@{draw\_point}}
\index{draw\_point@{draw\_point}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{draw\_point()}{draw\_point()}}
{\footnotesize\ttfamily draw\+\_\+point (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{img,  }\item[{}]{front\+\_\+pt,  }\item[{}]{back\+\_\+pt }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00886\ \ \ \ \ \textcolor{keyword}{def\ }draw\_point(self,\ img,\ front\_pt,\ back\_pt): }
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ img\ =\ cv2.circle(img,\ front\_pt,\ 8,(125,0,125),2,0) }
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ img\ =\ cv2.drawMarker(img,\ back\_pt,\ color=(255,255,0),markerType=1) }
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ img\ =\ cv2.line(img,front\_pt,\ back\_pt,\ (100,100,0),\ 2) }
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ img\ =\ cv2.circle(img,\ front\_pt,\ 8,(255,255,0),2,0) }
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ img }
\DoxyCodeLine{00892\  }

\end{DoxyCode}
\Hypertarget{a00206_a77a48d83bb7e61c5a28680a2de16c11c}\label{a00206_a77a48d83bb7e61c5a28680a2de16c11c} 
\index{room\_estimation@{room\_estimation}!draw\_vector@{draw\_vector}}
\index{draw\_vector@{draw\_vector}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{draw\_vector()}{draw\_vector()}}
{\footnotesize\ttfamily draw\+\_\+vector (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{event,  }\item[{}]{x,  }\item[{}]{y,  }\item[{}]{flags,  }\item[{}]{params }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{keyword}{def\ }draw\_vector(self,event,x,y,flags,params): }
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.show\_img\ =\ self.img\_copy() }}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ values\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ x\_list\ =\ [] }
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ y\_list\ =\ [] }
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ z\_list\ =\ [] }
\DoxyCodeLine{00918\  }
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ event\ ==\ 10: }
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#sign\ of\ the\ flag\ shows\ direction\ of\ mousewheel }}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ flags\ >\ 0: }
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.vector\_depth\ +=\ 10 }
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.vector\_depth\ -\/=\ 10 }
\DoxyCodeLine{00925\  }
\DoxyCodeLine{00926\  }
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ front\_point\ =\ np.float32([[x,0,y]]) }
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ front,\ jac\ =\ cv2.projectPoints(front\_point,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{00930\  }
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ back\_point\ =\ np.float32([[x,self.room\_length,y]]) }
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ back,\ jac\ =\ cv2.projectPoints(back\_point,self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{00933\  }
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ floater\_point\ =\ np.float32([[x,\ self.vector\_depth,\ y]]) }
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ floater,\ jac\ =\ cv2.projectPoints(floater\_point,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{00936\  }
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(x,y) }}
\DoxyCodeLine{00938\  }
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ front\_point\ =\ (front[0][0][0],front[0][0][1]) }
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ back\_point\ =\ (back[0][0][0],back[0][0][1]) }
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ floater\_point\ =\ (floater[0][0][0],floater[0][0][1]) }
\DoxyCodeLine{00942\  }
\DoxyCodeLine{00943\  }
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.circle(self.show\_img,\ front\_point,\ 8,(125,0,125),2,0) }
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.drawMarker(self.show\_img,\ back\_point,\ color=(255,255,0),markerType=1) }
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.line(self.show\_img,front\_point,\ back\_point,\ (100,100,0),\ 2) }
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.circle(self.show\_img,\ front\_point,\ 8,(255,255,0),2,0) }
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.circle(self.show\_img,\ floater\_point,\ 8,(255,0,0),2,0) }
\DoxyCodeLine{00949\  }
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ ifp\ =\ (int(front\_point[0]),\ int(front\_point[1])) }
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x,y)\ \textcolor{keywordflow}{in}\ self.mapped\_dictionary.keys(): }
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \ \ values\ =\ self.mapped\_dictionary[(x,y)] }
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ v\ \textcolor{keywordflow}{in}\ values: }
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.drawMarker(self.show\_img,\ (x,y),\ color=(0,0,255),markerType=3) }
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_list\ =\ [] }
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\_list\ =\ [] }
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\_list\ =\ [] }
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ v\ \textcolor{keywordflow}{in}\ values: }
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_list.append(v[0]) }
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\_list.append(v[2]) }
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\_list.append(v[1]) }
\DoxyCodeLine{00962\  }
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ cv2.imshow(self.window\_name,self.show\_img) }
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.show\_3D\_plot\ ==\ \textcolor{keyword}{True}: }
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \ \ \ \ plt.ion }
\DoxyCodeLine{00967\  }
\DoxyCodeLine{00968\  }
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.fig\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.fig\ =\ plt.figure(1) }
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax\ =\ ax\ =\ plt.axes(projection=\textcolor{stringliteral}{'3d'}) }
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.front\_plt\ =\ ax.scatter3D(front\_point[0],\ front\_point[1],\ 0) }
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.back\_plt\ =\ ax.scatter3D(back\_point[0],back\_point[1],\ self.vector\_depth) }
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.float\_plt\ =\ ax.scatter3D(floater\_point[0],floater\_point[1],self.vector\_depth) }
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.line\_plt\ =\ ax.plot3D([front\_point[0],back\_point[0]],\ [front\_point[1],back\_point[1]],\ [0,self.room\_length],\ color=\textcolor{stringliteral}{'teal'}) }
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ plt.quiver(*origin,\ V[:,0],\ V[:,1],\ color=['r','b','g'],\ scale=21) }}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_xlim(-\/self.room\_width,self.room\_width) }
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_ylim(-\/self.room\_height,self.room\_width) }
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_zlim(-\/self.room\_length,self.room\_width) }
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.fig.canvas.draw() }
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.fig.canvas.flush\_events() }
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.fig.show() }
\DoxyCodeLine{00984\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00985\  }
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.cla() }
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ values: }
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.points\_plt\ =\ self.ax.scatter3D(x\_list,y\_list,z\_list,\ marker=\textcolor{stringliteral}{"{}D"{}},\ color=\textcolor{stringliteral}{"{}red"{}}) }
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ plt.quiver((0,0,0),\ (0,1,0),\ ,\ color=['r','b','g'],\ scale=21) }}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_xlim(-\/self.room\_width,self.room\_width) }
\DoxyCodeLine{00993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_ylim(-\/self.room\_height,self.room\_width) }
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_zlim(-\/self.room\_length,self.room\_width) }
\DoxyCodeLine{00995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_xlabel(\textcolor{stringliteral}{"{}X"{}}) }
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_ylabel(\textcolor{stringliteral}{"{}Y"{}}) }
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_zlabel(\textcolor{stringliteral}{"{}Z"{}}) }
\DoxyCodeLine{00998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.float\_plt\ =\ self.ax.scatter3D(floater\_point[0],floater\_point[1],self.vector\_depth,\ marker=\textcolor{stringliteral}{"{}o"{}},\ color=\textcolor{stringliteral}{"{}blue"{}}) }
\DoxyCodeLine{00999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.front\_plt\ =\ self.ax.scatter3D(front\_point[0],\ front\_point[1],\ 0,\ marker=(\textcolor{stringliteral}{"{}o"{}}),\ color=\textcolor{stringliteral}{"{}cyan"{}}) }
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.back\_plt\ =\ self.ax.scatter3D(back\_point[0],back\_point[1],\ self.room\_length,\ marker=\textcolor{stringliteral}{"{}x"{}},\ color=\textcolor{stringliteral}{"{}cyan"{}}) }
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.line\_plt\ =\ self.ax.plot3D([front\_point[0],back\_point[0]],\ [front\_point[1],back\_point[1]],\ [0,self.room\_length],\ color=\textcolor{stringliteral}{'teal'}) }
\DoxyCodeLine{01002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.quiver\ =\ self.ax.quiver([0,0,0],\ [0,0,0],\ [0,0,0],\ [self.room\_width,0,0],\ [0,self.room\_height,0],\ [0,0,self.room\_length],\ length=0.1,\ normalize=\textcolor{keyword}{False}) }
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.fig.canvas.draw() }
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.fig.canvas.flush\_events() }
\DoxyCodeLine{01005\  }
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.show\_img }
\DoxyCodeLine{01007\  }
\DoxyCodeLine{01008\  }

\end{DoxyCode}
\Hypertarget{a00206_a5e02ad6d52be2fc94cd6f1663ecac18d}\label{a00206_a5e02ad6d52be2fc94cd6f1663ecac18d} 
\index{room\_estimation@{room\_estimation}!edit\_room\_corner@{edit\_room\_corner}}
\index{edit\_room\_corner@{edit\_room\_corner}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{edit\_room\_corner()}{edit\_room\_corner()}}
{\footnotesize\ttfamily edit\+\_\+room\+\_\+corner (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{index,  }\item[{}]{new\+\_\+pixel }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{keyword}{def\ }edit\_room\_corner(self,\ index,\ new\_pixel): }
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ self.corners[index][0]\ =\ new\_pixel[0] }
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ self.corners[index][1]\ =\ new\_pixel[1] }
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.corners }
\DoxyCodeLine{00505\  }

\end{DoxyCode}
\Hypertarget{a00206_a3b5b618d6f1cc697a5191f0617a9200a}\label{a00206_a3b5b618d6f1cc697a5191f0617a9200a} 
\index{room\_estimation@{room\_estimation}!estimate@{estimate}}
\index{estimate@{estimate}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{estimate()}{estimate()}}
{\footnotesize\ttfamily estimate (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Depreciated...

NOTE: define room first

This defines room limits and projects 3D points onto the screen
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01432\ \ \ \ \ \textcolor{keyword}{def\ }estimate(self): }
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01434\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Depreciated... }}
\DoxyCodeLine{01435\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01436\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ NOTE:\ define\ room\ first }}
\DoxyCodeLine{01437\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \  }}
\DoxyCodeLine{01438\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ defines\ room\ limits\ and\ projects\ 3D\ points\ onto\ the\ screen }}
\DoxyCodeLine{01439\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Finding\ Limits..."{}}) }
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ limits,\ \_\ =\ self.find\_3d\_limits() }
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Limits\ found..."{}}) }
\DoxyCodeLine{01443\  }
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Estimating\ 3D\ space\ within\ limits..."{}}) }
\DoxyCodeLine{01445\ \ \ \ \ \ \ \ \ self.get\_room\_3d(limits,\ height=self.room\_height,\ step=2) }
\DoxyCodeLine{01446\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Estimation\ complete.."{}}) }
\DoxyCodeLine{01447\  }
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Points"{}},\ self.show\_img) }
\DoxyCodeLine{01449\ \ \ \ \ \ \ \ \ cv2.setMouseCallback(\textcolor{stringliteral}{'Points'},\ self.get\_depth) }
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ cv2.waitKey(0) }
\DoxyCodeLine{01451\ \ \ \ \  }

\end{DoxyCode}


References room\+\_\+estimation.\+find\+\_\+3d\+\_\+limits(), \mbox{\hyperlink{a00206_a8113e0511b9bcb908b6a9aee98cee69b}{room\+\_\+estimation.\+get\+\_\+depth()}}, room\+\_\+estimation.\+get\+\_\+depth, room\+\_\+estimation.\+get\+\_\+room\+\_\+3d(), room\+\_\+estimation.\+room\+\_\+height, and room\+\_\+estimation.\+show\+\_\+img.

Here is the call graph for this function\+:
% FIG 8
\Hypertarget{a00206_a557b4ac632e812552cc251f7b57b6a6e}\label{a00206_a557b4ac632e812552cc251f7b57b6a6e} 
\index{room\_estimation@{room\_estimation}!estimate\_plane@{estimate\_plane}}
\index{estimate\_plane@{estimate\_plane}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{estimate\_plane()}{estimate\_plane()}}
{\footnotesize\ttfamily estimate\+\_\+plane (\begin{DoxyParamCaption}\item[{}]{img,  }\item[{}]{corners,  }\item[{}]{points,  }\item[{}]{calibration\+\_\+matrix,  }\item[{}]{distortion\+\_\+matrix }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00893\ \ \ \ \ \textcolor{keyword}{def\ }estimate\_plane(img,\ corners,\ points,\ calibration\_matrix,\ distortion\_matrix): }
\DoxyCodeLine{00894\  }
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ criteria\ =\ (cv2.TERM\_CRITERIA\_EPS\ +\ cv2.TERM\_CRITERIA\_MAX\_ITER,\ 30,\ 0.001) }
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ objp\ =\ np.zeros((6*7,3),\ np.float32) }
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ objp[:,:2]\ =\ np.mgrid[0:7,0:6].T.reshape(-\/1,2) }
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ axis\ =\ np.array([[3,0,0],\ [0,3,0],\ [0,0,-\/3]],dtype=np.float32).reshape(-\/1,3) }
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ corners2\ =\ cv2.cornerSubPix(img,corners,(11,11),(-\/1,-\/1),criteria) }
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ the\ rotation\ and\ translation\ vectors. }}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ ret,\ rvecs,\ tvecs\ =\ cv2.solvePnPRansac(objp,\ corners2,\ calibration\_matrix,\ distortion\_matrix) }
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00905\  }
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}CalibRVEC:"{}},\ rvecs,\ \textcolor{stringliteral}{"{}CALIBTVEC"{}},\ tvecs) }
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ project\ 3D\ points\ to\ image\ plane }}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ imgpts,\ jac\ =\ cv2.projectPoints(axis,\ rvecs,\ tvecs,\ calibration\_matrix,\ distortion\_matrix) }
\DoxyCodeLine{00909\  }
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ imgpts,\ jac }
\DoxyCodeLine{00911\  }

\end{DoxyCode}
\Hypertarget{a00206_ad1eaebbb5317d01c6bbd133cf98a4d30}\label{a00206_ad1eaebbb5317d01c6bbd133cf98a4d30} 
\index{room\_estimation@{room\_estimation}!evaluate\_calibration@{evaluate\_calibration}}
\index{evaluate\_calibration@{evaluate\_calibration}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{evaluate\_calibration()}{evaluate\_calibration()}}
{\footnotesize\ttfamily evaluate\+\_\+calibration (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02324\ \ \ \ \ \textcolor{keyword}{def\ }evaluate\_calibration(self): }
\DoxyCodeLine{02325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass} }
\DoxyCodeLine{02326\  }

\end{DoxyCode}
\Hypertarget{a00206_a2e21d867efbc8b743664f8b6f41d1b8e}\label{a00206_a2e21d867efbc8b743664f8b6f41d1b8e} 
\index{room\_estimation@{room\_estimation}!extend\_image\_to\_corners@{extend\_image\_to\_corners}}
\index{extend\_image\_to\_corners@{extend\_image\_to\_corners}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{extend\_image\_to\_corners()}{extend\_image\_to\_corners()}}
{\footnotesize\ttfamily extend\+\_\+image\+\_\+to\+\_\+corners (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image,  }\item[{}]{corners }\end{DoxyParamCaption})}

\begin{DoxyVerb}extends the image with black until corners are visible.

Returns new image as well as the amount extended and on which sides. This is useful for transforming datapoints.

offset = [top, left, bottom, right] in pixels
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02263\ \ \ \ \ \textcolor{keyword}{def\ }extend\_image\_to\_corners(self,\ image,\ corners): }
\DoxyCodeLine{02264\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{02265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ extends\ the\ image\ with\ black\ until\ corners\ are\ visible. }}
\DoxyCodeLine{02266\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02267\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ new\ image\ as\ well\ as\ the\ amount\ extended\ and\ on\ which\ sides.\ This\ is\ useful\ for\ transforming\ datapoints. }}
\DoxyCodeLine{02268\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02269\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ offset\ =\ [top,\ left,\ bottom,\ right]\ in\ pixels }}
\DoxyCodeLine{02270\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{02271\ \ \ \ \ \ \ \ \ min\_x\ =\ 0 }
\DoxyCodeLine{02272\ \ \ \ \ \ \ \ \ min\_y\ =\ 0 }
\DoxyCodeLine{02273\ \ \ \ \ \ \ \ \ max\_x\ =\ 0 }
\DoxyCodeLine{02274\ \ \ \ \ \ \ \ \ max\_y\ =\ 0 }
\DoxyCodeLine{02275\  }
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ corner\ \textcolor{keywordflow}{in}\ corners: }
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ corner[0]\ <\ min\_x: }
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_x\ =\ corner[0] }
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ corner[1]\ <\ min\_y: }
\DoxyCodeLine{02280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_y\ =\ corner[1] }
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ corner[0]\ >\ max\_x: }
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_x\ =\ corner[0] }
\DoxyCodeLine{02283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ corner[1]\ >\ max\_y: }
\DoxyCodeLine{02284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_y\ =\ corner[1] }
\DoxyCodeLine{02285\  }
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ max\_y\ <\ image.shape[0]: }
\DoxyCodeLine{02287\ \ \ \ \ \ \ \ \ \ \ \ \ max\_y\ =\ image.shape[0] }
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ max\_x\ <\ image.shape[1]: }
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \ \ \ \ max\_x\ =\ image.shape[1] }
\DoxyCodeLine{02290\  }
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ offset\ =\ (abs(int(min\_y)),\ abs(int(min\_x)),\ abs(int(max\_y\ -\/\ image.shape[0])),\ abs(int(max\_x\ -\/\ image.shape[1]))) }
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ image\ =\ cv2.copyMakeBorder(image,\ top=offset[0],\ left=offset[1],\ bottom=offset[2],\ right=offset[3],\ borderType=0) }
\DoxyCodeLine{02293\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02294\  }
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ corner\_1\ \textcolor{keywordflow}{in}\ corners: }
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ (int(corner\_1[0]\ +\ offset[1]),\ int(corner\_1[1]\ +\ offset[0])) }
\DoxyCodeLine{02297\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ image\ =\ cv2.circle(image,\ p1,\ 2,\ (255,255,0),\ 2) }
\DoxyCodeLine{02298\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ corner\_2\ \textcolor{keywordflow}{in}\ corners: }
\DoxyCodeLine{02299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ (int(corner\_1[0]\ +\ offset[1]),\ int(corner\_1[1]\ +\ offset[0])) }
\DoxyCodeLine{02300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ (int(corner\_2[0]\ +\ offset[1]),\ int(corner\_2[1]\ +\ offset[0])) }
\DoxyCodeLine{02301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ cv2.line(image,\ p1,\ p2,\ (255,0,0)) }
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#Resets\ corners\ for\ future\ assignment }}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ self.clear\_corners() }
\DoxyCodeLine{02305\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ image,\ offset }
\DoxyCodeLine{02306\  }

\end{DoxyCode}


References room\+\_\+estimation.\+clear\+\_\+corners().

Here is the call graph for this function\+:
% FIG 9
\Hypertarget{a00206_a9f82d1ff05b9a54401f4749899cfedb5}\label{a00206_a9f82d1ff05b9a54401f4749899cfedb5} 
\index{room\_estimation@{room\_estimation}!find\_3d\_limits@{find\_3d\_limits}}
\index{find\_3d\_limits@{find\_3d\_limits}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{find\_3d\_limits()}{find\_3d\_limits()}}
{\footnotesize\ttfamily find\+\_\+3d\+\_\+limits (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{height = {\ttfamily 1000} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01204\ \ \ \ \ \textcolor{keyword}{def\ }find\_3d\_limits(self,\ height=1000): }
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Finding\ Limits..."{}}) }
\DoxyCodeLine{01206\  }
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ edge\_buffer\ =\ 5 }
\DoxyCodeLine{01208\  }
\DoxyCodeLine{01209\ \ \ \ \ \ \ \ \ x\_limit\ =\ self.show\_img.shape[1]\ -\/\ edge\_buffer }
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ y\_limit\ =\ self.show\_img.shape[0]\ -\/\ edge\_buffer }
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ x\_min\ =\ 5 }
\DoxyCodeLine{01212\ \ \ \ \ \ \ \ \ y\_min\ =\ 5 }
\DoxyCodeLine{01213\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ bottom\_left\ =\ (0,0,height) }
\DoxyCodeLine{01215\ \ \ \ \ \ \ \ \ top\_left\ =\ (0,self.room\_length,height) }
\DoxyCodeLine{01216\ \ \ \ \ \ \ \ \ top\_right\ =\ (self.room\_width,self.room\_length,height) }
\DoxyCodeLine{01217\ \ \ \ \ \ \ \ \ bottom\_right\ =\ (self.room\_width,0,height) }
\DoxyCodeLine{01218\  }
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ test\_step\ =\ 100\ \textcolor{comment}{\#\ 10cm }}
\DoxyCodeLine{01220\ \ \ \ \ \ \ \ \ max\_distance\_test\ =\ 12000\ \textcolor{comment}{\#\ 12m\ max }}
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01222\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Get\ top\ left }}
\DoxyCodeLine{01223\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#test\ left\ limits }}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ pixel\_y\ =\ inf }
\DoxyCodeLine{01226\ \ \ \ \ \ \ \ \ pixel\_x\ =\ inf }
\DoxyCodeLine{01227\  }
\DoxyCodeLine{01228\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\_top\ left }}
\DoxyCodeLine{01229\ \ \ \ \ \ \ \ \ x\_lim\ =\ top\_left[0] }
\DoxyCodeLine{01230\ \ \ \ \ \ \ \ \ y\_lim\ =\ top\_left[1] }
\DoxyCodeLine{01231\ \ \ \ \ \ \ \ \ z\_lim\ =\ 0 }
\DoxyCodeLine{01232\  }
\DoxyCodeLine{01233\  }
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ abs(x\_lim)\ <=\ float(max\_distance\_test)\ \textcolor{keywordflow}{and}\ abs(y\_lim)\ <=\ float(max\_distance\_test)\ \textcolor{keywordflow}{and}\ abs(z\_lim): }
\DoxyCodeLine{01236\ \ \ \ \ \ \ \ \ \ \ \ \ print(x\_lim,\ y\_lim,\ z\_lim,\ max\_distance\_test) }
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ grab\ x\ and\ y\ of\  }}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \ \ \ \ \ \ x\_lim\ =\ top\_left[0] }
\DoxyCodeLine{01239\ \ \ \ \ \ \ \ \ \ \ \ \ y\_lim\ =\ top\_left[1] }
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \ \ \ \ z\_lim\ =\ top\_left[2] }
\DoxyCodeLine{01241\  }
\DoxyCodeLine{01242\  }
\DoxyCodeLine{01243\ \ \ \ \ \ \ \ \ \ \ \ \ point\_lim\ =\ np.float32([x\_lim,\ y\_lim\ ,\ height]) }
\DoxyCodeLine{01244\  }
\DoxyCodeLine{01245\ \ \ \ \ \ \ \ \ \ \ \ \ mapped\_point,\ jac\ =\ cv2.projectPoints(point\_lim,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \ \ \ \ pixel\_y\ =\ mapped\_point[0][0][1] }
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \ \ \ \ pixel\_x\ =\ mapped\_point[0][0][0] }
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_x\ >=\ edge\_buffer: }
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top\_left\ =\ (top\_left[0]\ -\/\ test\_step,\ top\_left[1],\ top\_left[2]) }
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top\_left\ =\ (top\_left[0]\ +\ test\_step/2,\ top\_left[1],\ top\_left[2]) }
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ pixel\_x\ <\ 10: }}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ print("{}X\ reached"{}) }}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01255\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_y\ >=\ edge\_buffer: }
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top\_left\ =\ (top\_left[0],\ top\_left[1]\ +\ test\_step,\ top\_left[2]) }
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top\_left\ =\ (top\_left[0],\ top\_left[1]\ -\/\ test\_step/2,\ top\_left[2]) }
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ pixel\_y\ <\ 10: }}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ print("{}Y\ reached"{}) }}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}: }
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.circle(self.show\_img,\ (mapped\_point[0][0][0],\ mapped\_point[0][0][1]),\ 1,(255,0,0),1,0) }
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{'Points'},\ self.show\_img) }
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}: }
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass} }
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(pixel\_x,\ pixel\_y,top\_left) }}
\DoxyCodeLine{01269\  }
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_x\ <\ edge\_buffer\ \textcolor{keywordflow}{and}\ pixel\_y\ <\ edge\_buffer: }
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Top\ Left:"{}},\ top\_left) }
\DoxyCodeLine{01273\  }
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Get\ top\ right }}
\DoxyCodeLine{01276\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ pixel\_y\ =\ inf }
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ pixel\_x\ =\ -\/inf }
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ x\_lim\ =\ top\_right[0] }
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ y\_lim\ =\ top\_right[1] }
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ z\_lim\ =\ top\_right[2] }
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ top\_right\ =\ top\_left }}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ abs(x\_lim)\ <=\ max\_distance\_test\ \textcolor{keywordflow}{and}\ abs(y\_lim)\ <=\ max\_distance\_test\ \textcolor{keywordflow}{and}\ abs(z\_lim)\ <=\ max\_distance\_test: }
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \ \ \ \ print(x\_lim,\ y\_lim) }
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ grab\ x\ and\ y\ of\  }}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \ \ \ \ x\_lim\ =\ top\_right[0] }
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \ \ \ \ y\_lim\ =\ top\_right[1] }
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \ \ \ \ z\_lim\ =\ top\_right[2] }
\DoxyCodeLine{01289\  }
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ x\_lim\ <=\ max\_distance\_test\ \textcolor{keywordflow}{or}\ y\_lim\ <=\ max\_distance\_test\ \textcolor{keywordflow}{or}\ abs(z\_lim)\ <=\ max\_distance\_test: }
\DoxyCodeLine{01291\  }
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ point\_lim\ =\ np.float32([x\_lim,\ y\_lim\ ,\ height]) }
\DoxyCodeLine{01293\  }
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mapped\_point,\ jac\ =\ cv2.projectPoints(point\_lim,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pixel\_y\ =\ mapped\_point[0][0][1] }
\DoxyCodeLine{01296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pixel\_x\ =\ mapped\_point[0][0][0] }
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_x\ <=\ x\_limit: }
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top\_right\ =\ (top\_right[0]\ +\ test\_step,\ top\_right[1],\ top\_right[2]) }
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top\_right\ =\ (top\_right[0]\ -\/\ test\_step/2,\ top\_right[1],\ top\_right[2]) }
\DoxyCodeLine{01301\  }
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_y\ >=\ edge\_buffer: }
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top\_right\ =\ (top\_right[0],\ top\_right[1]\ +\ test\_step,\ top\_right[2]) }
\DoxyCodeLine{01304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top\_right\ =\ (top\_right[0],\ top\_right[1]\ -\/\ test\_step/2,\ top\_right[2]) }
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ pixel\_y\ >\ y\_limit: }}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ print("{}Y\ reached"{}) }}
\DoxyCodeLine{01308\  }
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}: }
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.circle(self.show\_img,\ (mapped\_point[0][0][0],\ mapped\_point[0][0][1]),\ 1,(255,0,0),1,0) }
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{'Points'},\ self.show\_img) }
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}: }
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass} }
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_x\ >=\ x\_limit\ \textcolor{keywordflow}{and}\ pixel\_y\ <\ edge\_buffer: }
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{01318\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Top\ Right"{}},\ top\_right) }
\DoxyCodeLine{01319\  }
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Get\ bottom\ left }}
\DoxyCodeLine{01322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01323\ \ \ \ \ \ \ \ \ pixel\_y\ =\ -\/inf }
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ pixel\_x\ =\ -\/inf }
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ x\_lim\ =\ bottom\_left[0] }
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ y\_lim\ =\ bottom\_left[1] }
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ z\_lim\ =\ bottom\_left[2] }
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bottom\_left\ =\ top\_left }}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ abs(x\_lim)\ <=\ max\_distance\_test\ \textcolor{keywordflow}{and}\ abs(y\_lim)\ <=\ max\_distance\_test\ \textcolor{keywordflow}{and}\ abs(z\_lim)\ <=\ max\_distance\_test: }
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ grab\ x\ and\ y\ of\  }}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \ \ \ \ x\_lim\ =\ bottom\_left[0] }
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \ \ \ \ y\_lim\ =\ bottom\_left[1] }
\DoxyCodeLine{01333\  }
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ \ \ \ \ point\_lim\ =\ np.float32([x\_lim,\ y\_lim\ ,\ height]) }
\DoxyCodeLine{01335\  }
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ \ \ mapped\_point,\ jac\ =\ cv2.projectPoints(point\_lim,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \ \ \ \ pixel\_y\ =\ mapped\_point[0][0][1] }
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \ \ \ \ pixel\_x\ =\ mapped\_point[0][0][0] }
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_x\ >=\ edge\_buffer: }
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom\_left\ =\ (bottom\_left[0]\ -\/\ test\_step,\ bottom\_left[1],\ bottom\_left[2]) }
\DoxyCodeLine{01341\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom\_left\ =\ (bottom\_left[0]\ +\ test\_step/2,\ bottom\_left[1],\ bottom\_left[2]) }
\DoxyCodeLine{01343\  }
\DoxyCodeLine{01344\  }
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_y\ <=\ y\_limit: }
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom\_left\ =\ (bottom\_left[0],\ bottom\_left[1]\ -\/\ test\_step,\ bottom\_left[2]) }
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom\_left\ =\ (bottom\_left[0],\ bottom\_left[1]\ +\ test\_step/2,\ bottom\_left[2]) }
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ pixel\_y\ >\ y\_limit: }}
\DoxyCodeLine{01351\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ print("{}Y\ reached"{}) }}
\DoxyCodeLine{01352\  }
\DoxyCodeLine{01353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}: }
\DoxyCodeLine{01354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.circle(self.show\_img,\ (mapped\_point[0][0][0],\ mapped\_point[0][0][1]),\ 1,(255,0,0),1,0) }
\DoxyCodeLine{01355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{'Points'},\ self.show\_img) }
\DoxyCodeLine{01356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01357\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}: }
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass} }
\DoxyCodeLine{01359\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(pixel\_x,\ pixel\_y,bottom\_left) }}
\DoxyCodeLine{01360\  }
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_x\ <\ edge\_buffer\ \textcolor{keywordflow}{and}\ pixel\_y\ >\ y\_limit: }
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{01363\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Bottom\ Left:"{}},\ bottom\_left) }
\DoxyCodeLine{01364\  }
\DoxyCodeLine{01365\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01366\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Get\ bottom\ right }}
\DoxyCodeLine{01367\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ pixel\_y\ =\ -\/inf }
\DoxyCodeLine{01369\ \ \ \ \ \ \ \ \ pixel\_x\ =\ -\/inf }
\DoxyCodeLine{01370\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bottom\_right\ =\ bottom\_left }}
\DoxyCodeLine{01371\ \ \ \ \ \ \ \ \ x\_lim\ =\ bottom\_right[0] }
\DoxyCodeLine{01372\ \ \ \ \ \ \ \ \ y\_lim\ =\ bottom\_right[1] }
\DoxyCodeLine{01373\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ abs(x\_lim)\ <=\ max\_distance\_test\ \textcolor{keywordflow}{and}\ abs(y\_lim)\ <=\ max\_distance\_test\ \textcolor{keywordflow}{and}\ abs(z\_lim)\ <=\ max\_distance\_test: }
\DoxyCodeLine{01374\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ grab\ x\ and\ y\ of\  }}
\DoxyCodeLine{01375\ \ \ \ \ \ \ \ \ \ \ \ \ x\_lim\ =\ bottom\_right[0] }
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ \ \ \ \ y\_lim\ =\ bottom\_right[1] }
\DoxyCodeLine{01377\  }
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ \ \ \ \ point\_lim\ =\ np.float32([x\_lim,\ y\_lim\ ,\ height]) }
\DoxyCodeLine{01379\  }
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ \ \ \ \ mapped\_point,\ jac\ =\ cv2.projectPoints(point\_lim,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{01381\ \ \ \ \ \ \ \ \ \ \ \ \ pixel\_y\ =\ mapped\_point[0][0][1] }
\DoxyCodeLine{01382\ \ \ \ \ \ \ \ \ \ \ \ \ pixel\_x\ =\ mapped\_point[0][0][0] }
\DoxyCodeLine{01383\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_x\ <=\ x\_limit: }
\DoxyCodeLine{01384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom\_right\ =\ (bottom\_right[0]\ +\ test\_step,\ bottom\_right[1],\ bottom\_right[2]) }
\DoxyCodeLine{01385\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom\_right\ =\ (bottom\_right[0]\ -\/\ test\_step/2,\ bottom\_right[1],\ bottom\_right[2]) }
\DoxyCodeLine{01387\ \ \ \  }
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_y\ <=\ y\_limit: }
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom\_right\ =\ (bottom\_right[0],\ bottom\_right[1]\ -\/\ test\_step,\ bottom\_right[2]) }
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom\_right\ =\ (bottom\_right[0],\ bottom\_right[1]\ +\ test\_step/2,\ bottom\_right[2]) }
\DoxyCodeLine{01392\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ pixel\_y\ >\ y\_limit: }}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ print("{}Y\ reached"{}) }}
\DoxyCodeLine{01394\  }
\DoxyCodeLine{01395\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}: }
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.circle(self.show\_img,\ (mapped\_point[0][0][0],\ mapped\_point[0][0][1]),\ 1,(255,0,0),1,0) }
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{'Points'},\ self.show\_img) }
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}: }
\DoxyCodeLine{01400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass} }
\DoxyCodeLine{01401\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(pixel\_x,\ pixel\_y,bottom\_right) }}
\DoxyCodeLine{01402\  }
\DoxyCodeLine{01403\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\_x\ >=\ x\_limit\ \textcolor{keywordflow}{and}\ pixel\_y\ >=\ y\_limit: }
\DoxyCodeLine{01404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Bottom\ Right:"{}},\ bottom\_right) }
\DoxyCodeLine{01406\ \ \ \ \ \ \ \ \ min\ =\ np.array((top\_left,\ bottom\_left,\ top\_right,\ bottom\_right)) }
\DoxyCodeLine{01407\ \ \ \ \ \ \ \ \ min\ =\ np.amin(min,\ 0) }
\DoxyCodeLine{01408\  }
\DoxyCodeLine{01409\ \ \ \ \ \ \ \ \ max\ =\ np.array((top\_left,\ bottom\_left,\ top\_right,\ bottom\_right)) }
\DoxyCodeLine{01410\ \ \ \ \ \ \ \ \ max\ =\ np.amax(max,\ 0) }
\DoxyCodeLine{01411\  }
\DoxyCodeLine{01412\ \ \ \ \ \ \ \ \ print(min,\ max) }
\DoxyCodeLine{01413\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (min,\ max),\ (top\_left,\ bottom\_left,\ top\_right,\ bottom\_right) }
\DoxyCodeLine{01414\  }
\DoxyCodeLine{01415\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a3b5b618d6f1cc697a5191f0617a9200a}{room\+\_\+estimation.\+estimate()}}.

Here is the caller graph for this function\+:
% FIG 10
\Hypertarget{a00206_a54166ae0c7b7f8e5aadcc81eda56ce58}\label{a00206_a54166ae0c7b7f8e5aadcc81eda56ce58} 
\index{room\_estimation@{room\_estimation}!find\_intersection@{find\_intersection}}
\index{find\_intersection@{find\_intersection}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{find\_intersection()}{find\_intersection()}}
{\footnotesize\ttfamily find\+\_\+intersection (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{line\+\_\+equation1,  }\item[{}]{line\+\_\+equation2 }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns the (x,y) location of the intersection of 2 lines given m and b of both lines from slope intercept form (m*x + b)
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01487\ \ \ \ \ \textcolor{keyword}{def\ }find\_intersection(self,\ line\_equation1,\ line\_equation2): }
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{} }}
\DoxyCodeLine{01489\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ the\ (x,y)\ location\ of\ the\ intersection\ of\ 2\ lines\ given\ m\ and\ b\ of\ both\ lines\ from\ slope\ intercept\ form\ (m*x\ +\ b) }}
\DoxyCodeLine{01490\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ m1\ =\ line\_equation1.coef[0] }
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ b1\ =\ line\_equation1.coef[1] }
\DoxyCodeLine{01493\  }
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ m2\ =\ line\_equation2.coef[0] }
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ b2\ =\ line\_equation2.coef[1] }
\DoxyCodeLine{01496\  }
\DoxyCodeLine{01497\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x\ intersection }}
\DoxyCodeLine{01498\ \ \ \ \ \ \ \ \ xi\ =\ (b1-\/b2)\ /\ (m2-\/m1) }
\DoxyCodeLine{01499\  }
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#y\ intersection }}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ yi\ =\ m1\ *\ xi\ +\ b1 }
\DoxyCodeLine{01502\  }
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}INTERSECTION"{}},\ xi,\ yi) }
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (xi,\ yi) }
\DoxyCodeLine{01505\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_ae4a382139afef48e3b930752120b4c35}{room\+\_\+estimation.\+define\+\_\+perspective\+\_\+grid()}}, and \mbox{\hyperlink{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}{room\+\_\+estimation.\+find\+\_\+wall\+\_\+intersection()}}.

Here is the caller graph for this function\+:
% FIG 11
\Hypertarget{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}\label{a00206_af69d43ebb2e1d46a4e6313f41860c4fb} 
\index{room\_estimation@{room\_estimation}!find\_wall\_intersection@{find\_wall\_intersection}}
\index{find\_wall\_intersection@{find\_wall\_intersection}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{find\_wall\_intersection()}{find\_wall\_intersection()}}
{\footnotesize\ttfamily find\+\_\+wall\+\_\+intersection (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{number\+\_\+of\+\_\+walls = {\ttfamily 2},  }\item[{}]{samples\+\_\+per\+\_\+wall = {\ttfamily 4},  }\item[{}]{extent = {\ttfamily 10000},  }\item[{}]{intersection\+\_\+pairs = {\ttfamily \mbox{[}\mbox{]}},  }\item[{}]{degree = {\ttfamily 1} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Using samples along visible parts of walls, it is possible to fit the curve and extend the visible location of the wall


intersection_pairs is a list of pairs of lines which are to be checked for intersections
Because we only check the current, previous and beginning and last, we leave out all other instances so a specification of which pairs are desired is optional
[(0,3), (1,3)] 
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01618\ \ \ \ \ \textcolor{keyword}{def\ }find\_wall\_intersection(self,\ number\_of\_walls=2,\ samples\_per\_wall=4,\ extent=10000,\ intersection\_pairs=[],\ degree=1): }
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01620\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Using\ samples\ along\ visible\ parts\ of\ walls,\ it\ is\ possible\ to\ fit\ the\ curve\ and\ extend\ the\ visible\ location\ of\ the\ wall }}
\DoxyCodeLine{01621\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01622\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01623\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ intersection\_pairs\ is\ a\ list\ of\ pairs\ of\ lines\ which\ are\ to\ be\ checked\ for\ intersections }}
\DoxyCodeLine{01624\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Because\ we\ only\ check\ the\ current,\ previous\ and\ beginning\ and\ last,\ we\ leave\ out\ all\ other\ instances\ so\ a\ specification\ of\ which\ pairs\ are\ desired\ is\ optional }}
\DoxyCodeLine{01625\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [(0,3),\ (1,3)]\  }}
\DoxyCodeLine{01626\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ fit\_list\ =\ [] }
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ corners\ =\ [] }
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ while\ True: }}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ wall\ \textcolor{keywordflow}{in}\ range(number\_of\_walls): }
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Press\ C\ when\ done,\ 4\ points\ per\ wall"{}}) }
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ \ \ \ \ self.clear\_corners() }
\DoxyCodeLine{01633\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Finding\ Wall\ intersection"{}}) }
\DoxyCodeLine{01634\  }
\DoxyCodeLine{01635\  }
\DoxyCodeLine{01636\ \ \ \ \ \ \ \ \ \ \ \ \ wall\ =\ self.get\_room\_corners() }
\DoxyCodeLine{01637\  }
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ \ \ \ \ fit,\ equation\ =\ self.poly\_fit\_wall(wall,\ pixels\_past\_extent=extent,\ degree=degree) }
\DoxyCodeLine{01639\ \ \ \ \ \ \ \ \ \ \ \ \ fit\_list.append(equation) }
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(fit\_list)\ >=\ 2: }
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ f1\ \textcolor{keywordflow}{in}\ enumerate(fit\_list): }
\DoxyCodeLine{01642\  }
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ only\ when\ multiple\ lines\ exist }}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ index\ >\ 0: }
\DoxyCodeLine{01645\  }
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#look\ for\ intersection\ between\ current\ and\ previous }}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intersection\ =\ self.find\_intersection(fit\_list[index],fit\_list[index-\/1]) }
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ math.isnan(intersection[0]): }
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ corners.append(intersection) }
\DoxyCodeLine{01650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.circle(self.show\_img,\ (int(intersection[0]),\ int(intersection[1])),\ 1,(0,255,0),\ 5,\ 0) }
\DoxyCodeLine{01651\  }
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ between\ the\ beginning\ and\ end }}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ index+1\ ==\ len(fit\_list): }
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intersection\ =\ self.find\_intersection(fit\_list[index],fit\_list[0]) }
\DoxyCodeLine{01655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ math.isnan(intersection[0]): }
\DoxyCodeLine{01656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ corners.append(intersection) }
\DoxyCodeLine{01657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.circle(self.show\_img,\ (int(intersection[0]),\ int(intersection[1])),\ 1,(0,255,0),\ 5,\ 0) }
\DoxyCodeLine{01658\  }
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ \ \ \ \ end\_1\ =\ fit[0] }
\DoxyCodeLine{01660\ \ \ \ \ \ \ \ \ \ \ \ \ end\_2\ =\ fit[-\/1] }
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ \ \ \ \ print(end\_1,\ end\_2) }
\DoxyCodeLine{01662\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(fit.tolist()) }}
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \ \ \ \ self.connect\_points(list(fit.astype(np.int).tolist())) }
\DoxyCodeLine{01665\ \ \ \ \ \ \ \ \ \ \ \ \ key\ =\ cv2.waitKey(1)\ \&\ 0xFF }
\DoxyCodeLine{01666\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{"{}d"{}}): }
\DoxyCodeLine{01667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01669\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Add\ all\ of\ intersection\_pairs\ that\ are\ specified }}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ intersection\ \textcolor{keywordflow}{in}\ intersection\_pairs: }
\DoxyCodeLine{01671\ \ \ \ \ \ \ \ \ \ \ \ \ intersection\ =\ self.find\_intersection(fit\_list[index],fit\_list[0]) }
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \ \ \ \ corners.append(intersection) }
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.circle(self.show\_img,\ (int(intersection[0]),\ int(intersection[1])),\ 1,(0,255,0),\ 5,\ 0) }
\DoxyCodeLine{01674\  }
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.display\_room() }}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ corners }
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.connect\_points(fit) }}
\DoxyCodeLine{01678\  }

\end{DoxyCode}


References room\+\_\+estimation.\+calibration\+\_\+resolution, room\+\_\+estimation.\+camera\+\_\+matrix, room\+\_\+estimation.\+clear\+\_\+corners(), room\+\_\+estimation.\+connect\+\_\+points(), room\+\_\+estimation.\+distioriton\+\_\+matrix, room\+\_\+estimation.\+error\+\_\+list, \mbox{\hyperlink{a00206_a54166ae0c7b7f8e5aadcc81eda56ce58}{room\+\_\+estimation.\+find\+\_\+intersection()}}, room\+\_\+estimation.\+get\+\_\+checkerboard\+\_\+shape(), \mbox{\hyperlink{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba}{room\+\_\+estimation.\+get\+\_\+room\+\_\+corners()}}, \mbox{\hyperlink{a00206_a9ddc57e65b6b90133dae37504451b764}{room\+\_\+estimation.\+poly\+\_\+fit\+\_\+wall()}}, room\+\_\+estimation.\+rotation\+\_\+vector, room\+\_\+estimation.\+save\+\_\+calibration(), room\+\_\+estimation.\+show\+\_\+img, and room\+\_\+estimation.\+translation\+\_\+vector.

Here is the call graph for this function\+:
% FIG 12
\Hypertarget{a00206_a0686ad347e6e14189cd0035e2ea7bd54}\label{a00206_a0686ad347e6e14189cd0035e2ea7bd54} 
\index{room\_estimation@{room\_estimation}!fisheye\_calibrate@{fisheye\_calibrate}}
\index{fisheye\_calibrate@{fisheye\_calibrate}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{fisheye\_calibrate()}{fisheye\_calibrate()}}
{\footnotesize\ttfamily fisheye\+\_\+calibrate (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{checkerboard\+\_\+images,  }\item[{}]{checkerboard\+\_\+grid = {\ttfamily None},  }\item[{}]{out = {\ttfamily None} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01699\ \ \ \ \ \textcolor{keyword}{def\ }fisheye\_calibrate(self,\ checkerboard\_images,\ checkerboard\_grid=None,\ out=None): }
\DoxyCodeLine{01700\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Checkboard\ dimensions }}
\DoxyCodeLine{01701\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ checkerboard\_grid\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{01702\ \ \ \ \ \ \ \ \ \ \ \ \ CHECKERBOARD\ =\ self.get\_checkerboard\_shape(checkerboard\_images) }
\DoxyCodeLine{01703\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01704\ \ \ \ \ \ \ \ \ \ \ \ \ CHECKERBOARD\ =\ checkerboard\_grid }
\DoxyCodeLine{01705\  }
\DoxyCodeLine{01706\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01707\ \ \ \ \ \ \ \ \ subpix\_criteria\ =\ (cv2.TERM\_CRITERIA\_EPS\ +\ cv2.TERM\_CRITERIA\_MAX\_ITER,\ 30,\ 0.1) }
\DoxyCodeLine{01708\ \ \ \ \ \ \ \ \ criteria\ =\ (cv2.TERM\_CRITERIA\_EPS\ +\ cv2.TERM\_CRITERIA\_MAX\_ITER,\ 30,\ 0.1) }
\DoxyCodeLine{01709\ \ \ \ \ \ \ \ \ calibration\_flags\ =\ cv2.fisheye.CALIB\_RECOMPUTE\_EXTRINSIC\ +\ cv2.fisheye.CALIB\_CHECK\_COND\ +\ cv2.fisheye.CALIB\_FIX\_SKEW }
\DoxyCodeLine{01710\ \ \ \ \ \ \ \ \ objp\ =\ np.zeros((1,\ CHECKERBOARD[0]*CHECKERBOARD[1],\ 3),\ np.float32) }
\DoxyCodeLine{01711\ \ \ \ \ \ \ \ \ objp[0,:,:2]\ =\ np.mgrid[0:CHECKERBOARD[0],\ 0:CHECKERBOARD[1]].T.reshape(-\/1,\ 2) }
\DoxyCodeLine{01712\  }
\DoxyCodeLine{01713\ \ \ \ \ \ \ \ \ objpoints\ =\ []\ \textcolor{comment}{\#\ 3d\ point\ in\ real\ world\ space }}
\DoxyCodeLine{01714\ \ \ \ \ \ \ \ \ imgpoints\ =\ []\ \textcolor{comment}{\#\ 2d\ points\ in\ image\ plane. }}
\DoxyCodeLine{01715\  }
\DoxyCodeLine{01716\ \ \ \ \ \ \ \ \ imgshape\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{01717\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ image\ \textcolor{keywordflow}{in}\ checkerboard\_images: }
\DoxyCodeLine{01718\  }
\DoxyCodeLine{01719\ \ \ \ \ \ \ \ \ \ \ \ \ height,\ width\ =\ image.shape[:2] }
\DoxyCodeLine{01720\  }
\DoxyCodeLine{01721\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ cv2.cvtColor(image,cv2.COLOR\_BGR2GRAY) }
\DoxyCodeLine{01722\  }
\DoxyCodeLine{01723\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{'img'},image) }
\DoxyCodeLine{01724\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \ \ \ \ imgshape\ =\ image.shape }
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ corners\ =\ cv2.findChessboardCorners(image,\ CHECKERBOARD) }
\DoxyCodeLine{01727\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.cornerSubPix(checkerboard\_image,\ corners) }}
\DoxyCodeLine{01728\  }
\DoxyCodeLine{01729\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ retval,\ cameraMatrix,\ distCoeffs,\ rvecs,\ tvecs\ =\ cv2.calibrateCamera(objectPoints,\ imagePoints,\ imageSize) }}
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \ \ \ \ objp\ =\ np.zeros((1,\ CHECKERBOARD[0]\ *\ CHECKERBOARD[1],\ 3),\ np.float32) }
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \ \ \ \ objp[0,:,:2]\ =\ np.mgrid[0:CHECKERBOARD[0],\ 0:CHECKERBOARD[1]].T.reshape(-\/1,\ 2) }
\DoxyCodeLine{01732\ \ \ \ \ \ \ \ \ \ \ \ \ prev\_img\_shape\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{01733\ \ \ \ \ \  }
\DoxyCodeLine{01734\  }
\DoxyCodeLine{01735\  }
\DoxyCodeLine{01736\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ retval\ ==\ \textcolor{keyword}{True}: }
\DoxyCodeLine{01737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ objpoints.append(objp) }
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ refining\ pixel\ coordinates\ for\ given\ 2d\ points. }}
\DoxyCodeLine{01739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ corners2\ =\ cv2.cornerSubPix(image,\ corners,\ (11,11),(-\/1,-\/1),\ subpix\_criteria)\ \  }
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ imgpoints.append(corners2) }
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Draw\ and\ display\ the\ corners }}
\DoxyCodeLine{01742\  }
\DoxyCodeLine{01743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ cv2.drawChessboardCorners(image,\ CHECKERBOARD,\ corners2,\ retval) }
\DoxyCodeLine{01744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Calibration"{}},\ image) }
\DoxyCodeLine{01745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{01746\  }
\DoxyCodeLine{01747\ \ \ \ \ \ \ \ \ mean\_error\ =\ 0 }
\DoxyCodeLine{01748\ \ \ \ \ \ \ \ \ total\_error\ =\ 0 }
\DoxyCodeLine{01749\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(objpoints)): }
\DoxyCodeLine{01750\ \ \ \ \ \ \ \ \ \ \ \ \ imgpoints2,\ \_\ =\ cv2.projectPoints(objpoints[i],\ rvecs[i],\ tvecs[i],\ mtx,\ dist) }
\DoxyCodeLine{01751\ \ \ \ \ \ \ \ \ \ \ \ \ error\ =\ cv2.norm(imgpoints[i],imgpoints2,\ cv2.NORM\_L2)/len(imgpoints2) }
\DoxyCodeLine{01752\ \ \ \ \ \ \ \ \ \ \ \ \ total\_error\ +=\ error }
\DoxyCodeLine{01753\ \ \ \ \ \ \ \ \ mean\_error\ =\ total\_error/len(objpoints) }
\DoxyCodeLine{01754\  }
\DoxyCodeLine{01755\ \ \ \ \ \ \ \ \ print(mean\_error) }
\DoxyCodeLine{01756\ \ \ \ \ \ \ \ \ cv2.destroyAllWindows() }
\DoxyCodeLine{01757\  }
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ calculate\ K\ \&\ D }}
\DoxyCodeLine{01759\ \ \ \ \ \ \ \ \ N\_imm\ =\ len(checkerboard\_images) }
\DoxyCodeLine{01760\ \ \ \ \ \ \ \ \ K\ =\ np.zeros((3,\ 3)) }
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ D\ =\ np.zeros((4,\ 1)) }
\DoxyCodeLine{01762\ \ \ \ \ \ \ \ \ rvecs\ =\ [np.zeros((1,\ 1,\ 3),\ dtype=np.float64)\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(N\_imm)] }
\DoxyCodeLine{01763\ \ \ \ \ \ \ \ \ tvecs\ =\ [np.zeros((1,\ 1,\ 3),\ dtype=np.float64)\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(N\_imm)] }
\DoxyCodeLine{01764\ \ \ \ \ \ \ \ \ retval,\ K,\ D,\ rvecs,\ tvecs\ =\ cv2.fisheye.calibrate(objpoints,\ imgpoints,\ imgshape[::-\/1],\ K,\ D,\ flags=calibration\_flags,\ criteria=criteria) }
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ self.camera\_matrix\ =\ K }
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ self.distioriton\_matrix\ =\ D }
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ self.rotation\_vector\ =\ rvecs }
\DoxyCodeLine{01768\ \ \ \ \ \ \ \ \ self.translation\_vector\ =\ tvecs }
\DoxyCodeLine{01769\  }
\DoxyCodeLine{01770\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ out\ : }
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(out,\ \textcolor{stringliteral}{'wb'})\ \textcolor{keyword}{as}\ f: }
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(K,\ f) }
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(D,\ f) }
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(rvecs,\ f) }
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(tvecs,\ f) }
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(error,\ f) }
\DoxyCodeLine{01777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f.close() }
\DoxyCodeLine{01778\  }
\DoxyCodeLine{01779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01780\  }

\end{DoxyCode}
\Hypertarget{a00206_a52e10ca5ff3f0e459f47e6ccaf82adeb}\label{a00206_a52e10ca5ff3f0e459f47e6ccaf82adeb} 
\index{room\_estimation@{room\_estimation}!get\_3d\_point@{get\_3d\_point}}
\index{get\_3d\_point@{get\_3d\_point}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_3d\_point()}{get\_3d\_point()}}
{\footnotesize\ttfamily get\+\_\+3d\+\_\+point (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{pixel,  }\item[{}]{height = {\ttfamily 1500},  }\item[{}]{camera\+\_\+matrix = {\ttfamily None},  }\item[{}]{rotation\+\_\+matrix = {\ttfamily None},  }\item[{}]{tvec = {\ttfamily None},  }\item[{}]{show\+\_\+point = {\ttfamily True} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keyword}{def\ }get\_3d\_point(self,\ pixel,\ height=1500,\ camera\_matrix=None,\ rotation\_matrix=None,\ tvec=None,\ show\_point=True): }
\DoxyCodeLine{00731\  }
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ camera\_matrix: }
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ camera\_matrix\ =\ self.camera\_matrix }
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ rotation\_matrix: }
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \ \ \ \ rotation\_matrix\ =\ self.camera\_matrix }
\DoxyCodeLine{00737\  }
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ tvec: }
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ tvec\ =\ self.translation\_vector }
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ show\_point: }
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.circle(self.show\_img,\ pixel,\ 1,\ (255,255,0)) }
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(self.window\_name,\ self.show\_img) }
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(0) }
\DoxyCodeLine{00745\  }
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ uv\_point\ =\ np.array([pixel[0],\ pixel[1],\ 1]) }
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ left\_side\ =\ np.linalg.inv(rotation\_matrix\ *\ np.identity(3)\ )\ *\ np.linalg.inv(camera\_matrix\ *\ np.identity(3)\ )\ *\ uv\_point }
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ right\_side\ =\ np.linalg.inv(rotation\_matrix\ *\ np.identity(3))\ *\ tvec }
\DoxyCodeLine{00749\  }
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ s\ =\ height\ +\ right\_side[2][2]/left\_side[2][2] }
\DoxyCodeLine{00751\  }
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ point\ =\ np.linalg.inv(rotation\_matrix\ *\ np.identity(3))\ *\ (s*np.linalg.inv(camera\_matrix*\ np.identity(3))\ *\ uv\_point\ -\/\ tvec) }
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ point }
\DoxyCodeLine{00754\  }

\end{DoxyCode}
\Hypertarget{a00206_a8277f150767e58ce0824de54928fb184}\label{a00206_a8277f150767e58ce0824de54928fb184} 
\index{room\_estimation@{room\_estimation}!get\_3d\_to\_2d@{get\_3d\_to\_2d}}
\index{get\_3d\_to\_2d@{get\_3d\_to\_2d}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_3d\_to\_2d()}{get\_3d\_to\_2d()}}
{\footnotesize\ttfamily get\+\_\+3d\+\_\+to\+\_\+2d (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{point,  }\item[{}]{show = {\ttfamily True} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Point = (X, Z, Y) in mm (NOT PIXELS)
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{00671\ \ \ \ \ \textcolor{keyword}{def\ }get\_3d\_to\_2d(self,\ point,\ show=True): }
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{00673\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Point\ =\ (X,\ Z,\ Y)\ in\ mm\ (NOT\ PIXELS) }}
\DoxyCodeLine{00674\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ np.ndarray((len(points),\ 3)) }}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ =\ np.array(point[0],\ point[1],\ point[2],\ point[0],\ point[1],\ point[2],\ point[0],\ point[1],\ point[2]) }}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ points\ =\ np.float32(np.ndarray(points)) }}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ point\ =\ np.float32([[point[0],\ point[1],\ point[2]]]) }
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(point.shape) }}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ mapped\_point,\ jac\ =\ cv2.projectPoints(point,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ mapped\_point\ =\ (int(mapped\_point[0][0][0]),int(mapped\_point[0][0][1])) }
\DoxyCodeLine{00682\  }
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ show\ \textcolor{keywordflow}{is}\ \textcolor{keyword}{True}: }
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ \ \ self.draw\_axis() }
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.circle(self.show\_img,\ mapped\_point,\ 6,\ (0,\ 255,\ 255)) }
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(self.window\_name,\ self.show\_img) }
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(0) }
\DoxyCodeLine{00688\  }
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mapped\_point }
\DoxyCodeLine{00690\  }
\DoxyCodeLine{00691\  }
\DoxyCodeLine{00692\  }

\end{DoxyCode}


References room\+\_\+estimation.\+axis, room\+\_\+estimation.\+camera\+\_\+matrix, room\+\_\+estimation.\+corners, room\+\_\+estimation.\+distioriton\+\_\+matrix, room\+\_\+estimation.\+draw\+\_\+axis(), room\+\_\+estimation.\+rotation\+\_\+vector, room\+\_\+estimation.\+show\+\_\+img, room\+\_\+estimation.\+translation\+\_\+vector, and room\+\_\+estimation.\+window\+\_\+name.

Here is the call graph for this function\+:
% FIG 13
\Hypertarget{a00206_ad5f4b9a9b0ee17c82d3731e05dba3109}\label{a00206_ad5f4b9a9b0ee17c82d3731e05dba3109} 
\index{room\_estimation@{room\_estimation}!get\_calibration\_ratio@{get\_calibration\_ratio}}
\index{get\_calibration\_ratio@{get\_calibration\_ratio}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_calibration\_ratio()}{get\_calibration\_ratio()}}
{\footnotesize\ttfamily get\+\_\+calibration\+\_\+ratio (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{video\+\_\+resolution,  }\item[{}]{calibration\+\_\+resolution }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01948\ \ \ \ \ \textcolor{keyword}{def\ }get\_calibration\_ratio(self,\ video\_resolution,\ calibration\_resolution): }
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ w\_ratio\ =\ video\_resolution[0]/calibration\_resolution[0] }
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ h\_ratio\ =\ video\_resolution[1]/calibration\_resolution[1] }
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ w\_ratio,\ h\_ratio }
\DoxyCodeLine{01952\  }

\end{DoxyCode}
\Hypertarget{a00206_a7c5233bfe740d0250450332850fcad71}\label{a00206_a7c5233bfe740d0250450332850fcad71} 
\index{room\_estimation@{room\_estimation}!get\_checkerboard\_shape@{get\_checkerboard\_shape}}
\index{get\_checkerboard\_shape@{get\_checkerboard\_shape}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_checkerboard\_shape()}{get\_checkerboard\_shape()}}
{\footnotesize\ttfamily get\+\_\+checkerboard\+\_\+shape (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{checkerboard\+\_\+images }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01679\ \ \ \ \ \textcolor{keyword}{def\ }get\_checkerboard\_shape(self,\ checkerboard\_images): }
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}detecting\ checkerboard\ shape..."{}}) }
\DoxyCodeLine{01681\ \ \ \ \ \ \ \ \ found\ =\ \textcolor{keyword}{False} }
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(4,10): }
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ found: }
\DoxyCodeLine{01685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{01686\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(4,10): }
\DoxyCodeLine{01687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(i,j) }
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}: }
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ retval,\ corners\ =\ cv2.findChessboardCorners(checkerboard\_images[0],\ (i,j)) }
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ found\ =\ retval }
\DoxyCodeLine{01691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}: }
\DoxyCodeLine{01692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ found=\textcolor{keyword}{False} }
\DoxyCodeLine{01693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ found: }
\DoxyCodeLine{01694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checkerboard\_grid\ =\ (i,j) }
\DoxyCodeLine{01695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ break }}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Checkerboard\ shape:"{}},\ checkerboard\_grid) }
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ checkerboard\_grid }
\DoxyCodeLine{01698\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}{room\+\_\+estimation.\+find\+\_\+wall\+\_\+intersection()}}.

Here is the caller graph for this function\+:
% FIG 14
\Hypertarget{a00206_a5f01474eaee314a7013feeaa49685bb9}\label{a00206_a5f01474eaee314a7013feeaa49685bb9} 
\index{room\_estimation@{room\_estimation}!get\_corner\_with\_definition@{get\_corner\_with\_definition}}
\index{get\_corner\_with\_definition@{get\_corner\_with\_definition}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_corner\_with\_definition()}{get\_corner\_with\_definition()}}
{\footnotesize\ttfamily get\+\_\+corner\+\_\+with\+\_\+definition (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{event,  }\item[{}]{x,  }\item[{}]{y,  }\item[{}]{flags,  }\item[{}]{param }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{keyword}{def\ }get\_corner\_with\_definition(self,\ event,\ x,\ y,\ flags,\ param): }
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ event\ ==\ cv2.EVENT\_LBUTTONDOWN: }
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ self.corners.append((x,y)) }
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.circle(self.show\_img,\ (x,y),\ 1,(0,0,255),\ 5,\ 0) }
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ width\ =\ input(\textcolor{stringliteral}{"{}Width"{}}) }
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ length\ =\ input(\textcolor{stringliteral}{"{}Length"{}}) }
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_points.append((int(width),\ int(length))) }
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ self.connect\_points(self.corners) }
\DoxyCodeLine{00545\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a921523998615aa3555a3cb0ca2b36965}{room\+\_\+estimation.\+assign\+\_\+non\+\_\+square\+\_\+corners()}}.

Here is the caller graph for this function\+:
% FIG 15
\Hypertarget{a00206_a7975986cd4d5ecccaadb6a9a0a521e1e}\label{a00206_a7975986cd4d5ecccaadb6a9a0a521e1e} 
\index{room\_estimation@{room\_estimation}!get\_corners@{get\_corners}}
\index{get\_corners@{get\_corners}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_corners()}{get\_corners()}}
{\footnotesize\ttfamily get\+\_\+corners (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{event,  }\item[{}]{x,  }\item[{}]{y,  }\item[{}]{flags,  }\item[{}]{param }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00525\ \ \ \ \ \textcolor{keyword}{def\ }get\_corners(self,\ event,\ x,\ y,\ flags,\ param): }
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ grab\ references\ to\ the\ global\ variables }}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ global\ refPt,\ cropping,\ corner\_count,\ corner\_np }}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ the\ left\ mouse\ button\ was\ clicked,\ record\ the\ starting }}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (x,\ y)\ coordinates\ and\ indicate\ that\ cropping\ is\ being }}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ performed }}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ event\ ==\ cv2.EVENT\_LBUTTONDOWN: }
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ self.corners.append((x,y)) }
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.circle(self.show\_img,\ (x,y),\ 1,(0,0,255),\ 5,\ 0) }
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}CORNER\ !!!"{}}) }
\DoxyCodeLine{00535\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a921523998615aa3555a3cb0ca2b36965}{room\+\_\+estimation.\+assign\+\_\+non\+\_\+square\+\_\+corners()}}, and \mbox{\hyperlink{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba}{room\+\_\+estimation.\+get\+\_\+room\+\_\+corners()}}.

Here is the caller graph for this function\+:
% FIG 16
\Hypertarget{a00206_a7bcf809e2d6ba963c04b331f5c53a3a8}\label{a00206_a7bcf809e2d6ba963c04b331f5c53a3a8} 
\index{room\_estimation@{room\_estimation}!get\_cube\_side@{get\_cube\_side}}
\index{get\_cube\_side@{get\_cube\_side}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_cube\_side()}{get\_cube\_side()}}
{\footnotesize\ttfamily get\+\_\+cube\+\_\+side (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{cube,  }\item[{}]{side }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns the point set of each side of the cube in 
Start at bottom left of the plane on the opened cube displayed, in clockwise order  (or, the perspective from the center)
This function is to be paired before crop_plain() and the points returned from requested side should be passed on
Example: Side 1 contains points 1,2,6,5

                                    |   5   |   
   5        6                       |_______|
   *--------*                       |       |
 / |       /|                       |   4   |
1 *---------*2|                _______|_______|_______
|  * 4    | *7              |       |       |       |
| /       |/                |   1   |   2   |   3   |
0 *---------*3                |_______|_______|_______|
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{keyword}{def\ }get\_cube\_side(self,\ cube,\ side): }
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }}
\DoxyCodeLine{00548\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00549\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ the\ point\ set\ of\ each\ side\ of\ the\ cube\ in\  }}
\DoxyCodeLine{00550\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Start\ at\ bottom\ left\ of\ the\ plane\ on\ the\ opened\ cube\ displayed,\ in\ clockwise\ order\ \ (or,\ the\ perspective\ from\ the\ center) }}
\DoxyCodeLine{00551\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ function\ is\ to\ be\ paired\ before\ crop\_plain()\ and\ the\ points\ returned\ from\ requested\ side\ should\ be\ passed\ on }}
\DoxyCodeLine{00552\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Example:\ Side\ 1\ contains\ points\ 1,2,6,5 }}
\DoxyCodeLine{00553\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00554\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ 5\ \ \ |\ \ \  }}
\DoxyCodeLine{00555\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ 5\ \ \ \ \ \ \ \ 6\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\_\_\_\_\_\_\_| }}
\DoxyCodeLine{00556\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ *-\/-\/-\/-\/-\/-\/-\/-\/*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ | }}
\DoxyCodeLine{00557\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ /\ |\ \ \ \ \ \ \ /|\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ 4\ \ \ | }}
\DoxyCodeLine{00558\ \textcolor{stringliteral}{\ \ \ \ \ \ 1\ *-\/-\/-\/-\/-\/-\/-\/-\/-\/*2|\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_\_\_\_\_\_|\_\_\_\_\_\_\_|\_\_\_\_\_\_\_ }}
\DoxyCodeLine{00559\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ \ *\ 4\ \ \ \ |\ *7\ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ |\ \ \ \ \ \ \ |\ \ \ \ \ \ \ | }}
\DoxyCodeLine{00560\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ /\ \ \ \ \ \ \ |/\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ 1\ \ \ |\ \ \ 2\ \ \ |\ \ \ 3\ \ \ | }}
\DoxyCodeLine{00561\ \textcolor{stringliteral}{\ \ \ \ \ \ 0\ *-\/-\/-\/-\/-\/-\/-\/-\/-\/*3\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\_\_\_\_\_\_\_|\_\_\_\_\_\_\_|\_\_\_\_\_\_\_| }}
\DoxyCodeLine{00562\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ points\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00564\  }
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ side\ ==\ 1:\ \textcolor{comment}{\#\ Left\ Wall }}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ points\ =\ [cube[0],\ cube[1],\ cube[5],\ cube[4]] }
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ side\ ==\ 2:\ \textcolor{comment}{\#\ Floor }}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ points\ =\ [cube[0],\ cube[4],\ cube[7],\ cube[3]] }
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ side\ ==\ 3:\ \textcolor{comment}{\#\ Right\ Wall }}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ points\ =\ [cube[7],\ cube[6],\ cube[2],\ cube[3]] }
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ side\ ==\ 4:\ \textcolor{comment}{\#\ Back\ wall }}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ points\ =\ [cube[4],\ cube[5],\ cube[6],\ cube[7]] }
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ side\ ==\ 5:\ \textcolor{comment}{\#\ Ceiling }}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ points\ =\ [cube[5],\ cube[1],\ cube[2],\ cube[6]] }
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ print(points) }
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ print(np.array(points)) }
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ points }
\DoxyCodeLine{00579\  }

\end{DoxyCode}
\Hypertarget{a00206_a8113e0511b9bcb908b6a9aee98cee69b}\label{a00206_a8113e0511b9bcb908b6a9aee98cee69b} 
\index{room\_estimation@{room\_estimation}!get\_depth@{get\_depth}}
\index{get\_depth@{get\_depth}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_depth()}{get\_depth()}}
{\footnotesize\ttfamily get\+\_\+depth (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{event,  }\item[{}]{x,  }\item[{}]{y,  }\item[{}]{p1,  }\item[{}]{p2 }\end{DoxyParamCaption})}

\begin{DoxyVerb}get z position given x and y.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01419\ \ \ \ \ \textcolor{keyword}{def\ }get\_depth(self,\ event,\ x,\ y,\ p1,\ p2): }
\DoxyCodeLine{01420\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{} }}
\DoxyCodeLine{01421\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ get\ z\ position\ given\ x\ and\ y. }}
\DoxyCodeLine{01422\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{01423\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ event\ ==\ cv2.EVENT\_LBUTTONDOWN: }}
\DoxyCodeLine{01424\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ resets\ the\ image\ so\ display\ does\ not\ accumulate }}
\DoxyCodeLine{01425\ \ \ \ \ \ \ \ \ self.show\_img\ =\ self.img\_copy() }
\DoxyCodeLine{01426\ \ \ \ \ \ \ \ \ min\ =\ np.amin(np.array(self.mapped[(x,y)]),\ 0) }
\DoxyCodeLine{01427\ \ \ \ \ \ \ \ \ max\ =\ np.amax(np.array(self.mapped[(x,y)]),\ 0) }
\DoxyCodeLine{01428\ \ \ \ \ \ \ \ \ self.show\_img\ =\ cv2.putText(self.show\_img,\ str((min,\ max)),\ (x,y),\ fontFace=cv2.FONT\_HERSHEY\_PLAIN,fontScale=1,\ color=(255,0,0),\ thickness=2) }
\DoxyCodeLine{01429\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01430\ \ \ \ \ \ \ \ \ print(x,y,\ \textcolor{stringliteral}{"{}-\/>"{}},\ min[:2],\ max[:2]) }
\DoxyCodeLine{01431\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a3b5b618d6f1cc697a5191f0617a9200a}{room\+\_\+estimation.\+estimate()}}.

Here is the caller graph for this function\+:
% FIG 17
\Hypertarget{a00206_a6c3906082600df696b318ba028d67911}\label{a00206_a6c3906082600df696b318ba028d67911} 
\index{room\_estimation@{room\_estimation}!get\_files\_from\_folder@{get\_files\_from\_folder}}
\index{get\_files\_from\_folder@{get\_files\_from\_folder}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_files\_from\_folder()}{get\_files\_from\_folder()}}
{\footnotesize\ttfamily get\+\_\+files\+\_\+from\+\_\+folder (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{folder,  }\item[{}]{extension = {\ttfamily "{}MP4"{}} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02734\ \ \ \ \ \textcolor{keyword}{def\ }get\_files\_from\_folder(self,\ folder,\ extension="{}MP4"{}): }
\DoxyCodeLine{02735\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02736\ \ \ \ \ \ \ \ \ files\ =\ [] }
\DoxyCodeLine{02737\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ file\ \textcolor{keywordflow}{in}\ os.listdir(folder): }
\DoxyCodeLine{02738\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ only\ text\ files }}
\DoxyCodeLine{02739\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ file.endswith((\textcolor{stringliteral}{'.'}\ +\ extension)): }
\DoxyCodeLine{02740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ files.append((folder\ +\ file)) }
\DoxyCodeLine{02741\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ files }
\DoxyCodeLine{02742\  }

\end{DoxyCode}
\Hypertarget{a00206_ae29c16a83d737f9e9f2b584ae560ad85}\label{a00206_ae29c16a83d737f9e9f2b584ae560ad85} 
\index{room\_estimation@{room\_estimation}!get\_n\_room\_points@{get\_n\_room\_points}}
\index{get\_n\_room\_points@{get\_n\_room\_points}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_n\_room\_points()}{get\_n\_room\_points()}}
{\footnotesize\ttfamily get\+\_\+n\+\_\+room\+\_\+points (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{n\+\_\+locations = {\ttfamily None},  }\item[{}]{height = {\ttfamily 0} }\end{DoxyParamCaption})}

\begin{DoxyVerb}N_locations are known locations along the floor (Non-square rooms)
    5000mm
--------------  
       3-----4  
       |     |
       |     |
1------2     | 5000mm  (Length)
|            |
|            |
0------------5
    (Width)
Where (width,length) in mm
0 = (0,0)
1 = (0, 2500)
2 = (2500, 2500)
3 = (2500, 5000)
4 = (5000, 5000)
5 = (5000, 0)
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01074\ \ \ \ \ \textcolor{keyword}{def\ }get\_n\_room\_points(self,\ n\_locations=None,\ height=0): }
\DoxyCodeLine{01075\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ N\_locations\ are\ known\ locations\ along\ the\ floor\ (Non-\/square\ rooms) }}
\DoxyCodeLine{01077\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 5000mm }}
\DoxyCodeLine{01078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ \  }}
\DoxyCodeLine{01079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 3-\/-\/-\/-\/-\/4\ \  }}
\DoxyCodeLine{01080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ | }}
\DoxyCodeLine{01081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ | }}
\DoxyCodeLine{01082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1-\/-\/-\/-\/-\/-\/2\ \ \ \ \ |\ 5000mm\ \ (Length) }}
\DoxyCodeLine{01083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ | }}
\DoxyCodeLine{01084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ | }}
\DoxyCodeLine{01085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 0-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/5 }}
\DoxyCodeLine{01086\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ (Width) }}
\DoxyCodeLine{01087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Where\ (width,length)\ in\ mm }}
\DoxyCodeLine{01088\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 0\ =\ (0,0) }}
\DoxyCodeLine{01089\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1\ =\ (0,\ 2500) }}
\DoxyCodeLine{01090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 2\ =\ (2500,\ 2500) }}
\DoxyCodeLine{01091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 3\ =\ (2500,\ 5000) }}
\DoxyCodeLine{01092\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 4\ =\ (5000,\ 5000) }}
\DoxyCodeLine{01093\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 5\ =\ (5000,\ 0) }}
\DoxyCodeLine{01094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ n\_locations\ ==\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \ \ \ \ n\_locations\ =\ self.room\_points }
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ objectPoints\ =\ np.reshape(np.asfarray(n\_locations),\ (len(n\_locations),3,1)) }}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \ \ objectPoints\ =\ np.ndarray((len(n\_locations),\ 3,\ 1)) }
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ location\ \textcolor{keywordflow}{in}\ enumerate(n\_locations): }
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ index2,\ dim\ in\ enumerate(location): }}
\DoxyCodeLine{01101\ \ \ \ \ \ \ \ \ \ \ \ \ print(location) }
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ \ \ \ \ objectPoints[index][0][0]\ =\ location[0]\ \textcolor{comment}{\#\ X\  }}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \ \ \ \ \ \ objectPoints[index][1][0]\ =\ location[1]\ \textcolor{comment}{\#\ Z }}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ \ \ \ \ objectPoints[index][2][0]\ =\ height\ \ \ \ \ \ \textcolor{comment}{\#\ Y }}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(objectPoints[index][:]) }}
\DoxyCodeLine{01106\ \ \ \ \ \ \ \ \ print(objectPoints) }
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ objectPoints }
\DoxyCodeLine{01108\  }

\end{DoxyCode}


References room\+\_\+estimation.\+room\+\_\+points.



Referenced by \mbox{\hyperlink{a00206_a921523998615aa3555a3cb0ca2b36965}{room\+\_\+estimation.\+assign\+\_\+non\+\_\+square\+\_\+corners()}}.

Here is the caller graph for this function\+:
% FIG 18
\Hypertarget{a00206_a0246e47740851d72979f6d5cdc76bf18}\label{a00206_a0246e47740851d72979f6d5cdc76bf18} 
\index{room\_estimation@{room\_estimation}!get\_pixel\_location@{get\_pixel\_location}}
\index{get\_pixel\_location@{get\_pixel\_location}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_pixel\_location()}{get\_pixel\_location()}}
{\footnotesize\ttfamily get\+\_\+pixel\+\_\+location (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{pixel }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns the pixel location in 3D
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01452\ \ \ \ \ \textcolor{keyword}{def\ }get\_pixel\_location(self,\ pixel): }
\DoxyCodeLine{01453\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01454\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ the\ pixel\ location\ in\ 3D }}
\DoxyCodeLine{01455\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01456\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.mapped[pixel] }
\DoxyCodeLine{01457\  }
\DoxyCodeLine{01458\  }

\end{DoxyCode}


References room\+\_\+estimation.\+mapped.

\Hypertarget{a00206_a68abc4d3a13c1374dfa93018a57b84be}\label{a00206_a68abc4d3a13c1374dfa93018a57b84be} 
\index{room\_estimation@{room\_estimation}!get\_room\_3d@{get\_room\_3d}}
\index{get\_room\_3d@{get\_room\_3d}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_room\_3d()}{get\_room\_3d()}}
{\footnotesize\ttfamily get\+\_\+room\+\_\+3d (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{limits,  }\item[{}]{height,  }\item[{}]{step,  }\item[{}]{save\+\_\+filename = {\ttfamily None} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01010\ \ \ \ \ \textcolor{keyword}{def\ }get\_room\_3d(self,\ limits,\ height,\ step,\ save\_filename=None): }
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ min,\ max\ =\ limits }
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ points\ =\ np.mgrid[min[0]:max[0]:step,\ min[1]:max[1]:step,\ height:height+1:1].reshape(3,-\/1).T.astype(np.float)\ \textcolor{comment}{\#\ all\ 40\ inches }}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Projecting\ points\ with\ size"{}},\ points.shape) }
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ mapped\_pixels,\ jac\ =\ cv2.projectPoints(points,\ self.rotation\_vector,\ self.translation\_vector,\ self.camera\_matrix,\ self.distioriton\_matrix) }
\DoxyCodeLine{01016\  }
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Mapping..."{}}) }
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ mapped\ =\ \{\} }
\DoxyCodeLine{01019\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ pixel\ \textcolor{keywordflow}{in}\ enumerate(mapped\_pixels): }
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \ \ \ \ point\ =\ points[index] }
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \ \ \ \ pixel\ =\ (int(pixel[0][0]),\ int(pixel[0][1])) }
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ image\ =\ cv2.circle(image,\ pixel,\ 1,\ (1,1,1)) }}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pixel\ \textcolor{keywordflow}{in}\ mapped.keys(): }
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mapped[pixel].append(point) }
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mapped[pixel]\ =\ [point] }
\DoxyCodeLine{01028\ \ \ \ \ \ \ \ \ self.mapped\ =\ mapped }
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Mapping\ Complete."{}}) }
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mapped }
\DoxyCodeLine{01031\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a3b5b618d6f1cc697a5191f0617a9200a}{room\+\_\+estimation.\+estimate()}}.

Here is the caller graph for this function\+:
% FIG 19
\Hypertarget{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba}\label{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba} 
\index{room\_estimation@{room\_estimation}!get\_room\_corners@{get\_room\_corners}}
\index{get\_room\_corners@{get\_room\_corners}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_room\_corners()}{get\_room\_corners()}}
{\footnotesize\ttfamily get\+\_\+room\+\_\+corners (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{num\+\_\+points = {\ttfamily 4} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Assigns 2D Room corners which will map to the real world 3D.

This function is a loop for the number of room points (real world) and lets you select the location they should exist in the video.

Each point should be respective to the order that room points exist. For example, consistently clockwise starting from the bottom left.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{keyword}{def\ }get\_room\_corners(self,\ num\_points=4): }
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{00469\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Assigns\ 2D\ Room\ corners\ which\ will\ map\ to\ the\ real\ world\ 3D. }}
\DoxyCodeLine{00470\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00471\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ function\ is\ a\ loop\ for\ the\ number\ of\ room\ points\ (real\ world)\ and\ lets\ you\ select\ the\ location\ they\ should\ exist\ in\ the\ video. }}
\DoxyCodeLine{00472\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{00473\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Each\ point\ should\ be\ respective\ to\ the\ order\ that\ room\ points\ exist.\ For\ example,\ consistently\ clockwise\ starting\ from\ the\ bottom\ left. }}
\DoxyCodeLine{00474\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ self.clear\_corners() }
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Assigning\ corners..."{}}) }
\DoxyCodeLine{00477\  }
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#Initializes\ feedback\ to\ a\ function }}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ cv2.setMouseCallback(\textcolor{stringliteral}{"{}Room\ Estimation"{}},\ self.get\_corners) }
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Setting\ Callback"{}}) }
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ len(self.corners)\ <\ num\_points: }
\DoxyCodeLine{00482\  }
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ display\ the\ image\ and\ wait\ for\ a\ keypress }}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Room\ Estimation"{}},\ self.show\_img) }
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.setMouseCallback(\textcolor{stringliteral}{"{}Room\ Estimation"{}},\ self.get\_corners) }
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ key\ =\ cv2.waitKey(1)\ \&\ 0xFF }
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ self.connect\_points(self.corners) }
\DoxyCodeLine{00488\  }
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ len(self.corners)\ >=\ 4: }}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ self.show\_img,\ cube,\ target\_cube\ =\ self.draw\_cuboid() }}
\DoxyCodeLine{00491\  }
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\ ==\ ord(\textcolor{stringliteral}{"{}c"{}}): }
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.connect\_points(self.corners) }
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ self.connect\_points(self.corners) }
\DoxyCodeLine{00496\ \ \ \ \  }
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ self.corners\ =\ np.reshape(np.asfarray(self.corners),\ (num\_points,2,1)) }
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.setMouseCallback("{}Room\ Estimation"{},\ self.draw\_vector) }}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.corners }
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \  }

\end{DoxyCode}


References room\+\_\+estimation.\+clear\+\_\+corners(), room\+\_\+estimation.\+connect\+\_\+points(), room\+\_\+estimation.\+corners, room\+\_\+estimation.\+get\+\_\+corners, room\+\_\+estimation.\+get\+\_\+corners(), room\+\_\+estimation.\+room\+\_\+points, room\+\_\+estimation.\+show\+\_\+img, and room\+\_\+estimation.\+window\+\_\+name.



Referenced by \mbox{\hyperlink{a00206_ae4a382139afef48e3b930752120b4c35}{room\+\_\+estimation.\+define\+\_\+perspective\+\_\+grid()}}, \mbox{\hyperlink{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}{room\+\_\+estimation.\+find\+\_\+wall\+\_\+intersection()}}, and \mbox{\hyperlink{a00206_abeac4cbae89aef891cee148cbbbc6232}{room\+\_\+estimation.\+superimpose\+\_\+checker()}}.

Here is the call graph for this function\+:
% FIG 20
Here is the caller graph for this function\+:
% FIG 21
\Hypertarget{a00206_aab76a3fa2901de336d5a1a3e1b707604}\label{a00206_aab76a3fa2901de336d5a1a3e1b707604} 
\index{room\_estimation@{room\_estimation}!get\_room\_dimensions@{get\_room\_dimensions}}
\index{get\_room\_dimensions@{get\_room\_dimensions}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_room\_dimensions()}{get\_room\_dimensions()}}
{\footnotesize\ttfamily get\+\_\+room\+\_\+dimensions (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{room\+\_\+points }\end{DoxyParamCaption})}

\begin{DoxyVerb}Given room points returns the width and length of the room given the farthest points.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02307\ \ \ \ \ \textcolor{keyword}{def\ }get\_room\_dimensions(self,\ room\_points): }
\DoxyCodeLine{02308\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{02309\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Given\ room\ points\ returns\ the\ width\ and\ length\ of\ the\ room\ given\ the\ farthest\ points. }}
\DoxyCodeLine{02310\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{02311\  }
\DoxyCodeLine{02312\ \ \ \ \ \ \ \ \ max\_width\ =\ 0 }
\DoxyCodeLine{02313\ \ \ \ \ \ \ \ \ max\_length\ =\ 0 }
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02315\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ point\ \textcolor{keywordflow}{in}\ room\_points: }
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \ \ \ \ x,\ z,\ y\ =\ point }
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ x\ >\ max\_width: }
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_width\ =\ x }
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ z\ >\ max\_length: }
\DoxyCodeLine{02320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_length\ =\ z }
\DoxyCodeLine{02321\  }
\DoxyCodeLine{02322\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ max\_width,\ max\_length }
\DoxyCodeLine{02323\  }

\end{DoxyCode}
\Hypertarget{a00206_a62767547824d2f147fc10c5b38f2c725}\label{a00206_a62767547824d2f147fc10c5b38f2c725} 
\index{room\_estimation@{room\_estimation}!get\_room\_points@{get\_room\_points}}
\index{get\_room\_points@{get\_room\_points}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{get\_room\_points()}{get\_room\_points()}}
{\footnotesize\ttfamily get\+\_\+room\+\_\+points (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{width,  }\item[{}]{length,  }\item[{}]{height = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01046\ \ \ \ \ \textcolor{keyword}{def\ }get\_room\_points(self,\ width,\ length,\ height=0): }
\DoxyCodeLine{01047\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Creating\ room\ points"{}}) }
\DoxyCodeLine{01048\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{} }}
\DoxyCodeLine{01049\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ a\ matrix\ for\ real\ world\ points. }}
\DoxyCodeLine{01050\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ These\ points\ start\ on\ the\ bottom\ left\ and\ are\ assigned\ as\ a\ rectangle\ in\ a\ clockwise\ direction }}
\DoxyCodeLine{01051\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \  }}
\DoxyCodeLine{01052\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (width) }}
\DoxyCodeLine{01053\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1-\/-\/-\/-\/-\/-\/2\  }}
\DoxyCodeLine{01054\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ \ \ \ \ \ | }}
\DoxyCodeLine{01055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ |\ \ \ \ \ \ |\ (length) }}
\DoxyCodeLine{01056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 0\ \ \ \ \ \ 3 }}
\DoxyCodeLine{01057\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01058\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ We\ may\ include\ Height,\ but\ this\ is\ not\ included. }}
\DoxyCodeLine{01059\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01060\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Format\ of\ points\ (X,Z,Y) }}
\DoxyCodeLine{01061\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{01062\  }
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ objectPoints\ =\ np.array( }
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \ \ \ \ [ }
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[0.0],[0.0],[float(height)]], }
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[0.0],[float(length)],[float(height)]], }
\DoxyCodeLine{01067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[float(width)],[float(length)],[float(height)]], }
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[float(width)],[0.0],[float(height)]], }
\DoxyCodeLine{01069\ \ \ \ \ \ \ \ \ \ \ \ \ ] }
\DoxyCodeLine{01070\ \ \ \ \ \ \ \ \ )\  }
\DoxyCodeLine{01071\ \ \ \ \ \ \ \ \ print(objectPoints.shape) }
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ objectPoints }
\DoxyCodeLine{01073\ \ \ \ \  }

\end{DoxyCode}
\Hypertarget{a00206_af380d3a1fe6a68080691e578d25937b1}\label{a00206_af380d3a1fe6a68080691e578d25937b1} 
\index{room\_estimation@{room\_estimation}!img\_copy@{img\_copy}}
\index{img\_copy@{img\_copy}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{img\_copy()}{img\_copy()}}
{\footnotesize\ttfamily img\+\_\+copy (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keyword}{def\ }img\_copy(self): }
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ deepcopy(self.image) }
\DoxyCodeLine{00244\  }

\end{DoxyCode}
\Hypertarget{a00206_a3b7fb08f24516ed753d38cd1eccd73f6}\label{a00206_a3b7fb08f24516ed753d38cd1eccd73f6} 
\index{room\_estimation@{room\_estimation}!load\_and\_undistort\_calibration@{load\_and\_undistort\_calibration}}
\index{load\_and\_undistort\_calibration@{load\_and\_undistort\_calibration}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{load\_and\_undistort\_calibration()}{load\_and\_undistort\_calibration()}}
{\footnotesize\ttfamily load\+\_\+and\+\_\+undistort\+\_\+calibration (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{video\+\_\+path,  }\item[{}]{visualize\+\_\+distortion = {\ttfamily False},  }\item[{}]{points\+\_\+data = {\ttfamily None} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02478\ \ \ \ \ \textcolor{keyword}{def\ }load\_and\_undistort\_calibration(self,\ video\_path,\ visualize\_distortion=False,\ points\_data=None): }
\DoxyCodeLine{02479\ \ \ \ \ \ \ \ \ calibration\_path\ =\ video\_path[:-\/3]\ +\ \textcolor{stringliteral}{"{}pickle"{}} }
\DoxyCodeLine{02480\ \ \ \ \ \ \ \ \ checkerboard\_image\ =\ self.collect\_frames(video\_path,1,1,2)[0] }
\DoxyCodeLine{02481\  }
\DoxyCodeLine{02482\ \ \ \ \ \ \ \ \ self.calibration\_resolution\ =\ (checkerboard\_image.shape[1],\ checkerboard\_image.shape[0]) }
\DoxyCodeLine{02483\  }
\DoxyCodeLine{02484\ \ \ \ \ \ \ \ \ c,\ d,\ r,\ t,\ error,\ resolution\ =\ self.load\_calibration(calibration\_path) }
\DoxyCodeLine{02485\ \ \ \ \ \ \ \ \ checkerboard\ =\ self.undistort\_room(image=checkerboard\_image,\ points\_data=points\_data) }
\DoxyCodeLine{02486\ \ \ \ \ \ \ \ \ visroom\ =\ self.undistort\_room() }
\DoxyCodeLine{02487\ \ \ \ \ \ \ \ \ cv2.imshow(video\_path,\ visroom) }
\DoxyCodeLine{02488\ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}checkerboard"{}},\ checkerboard) }
\DoxyCodeLine{02489\  }
\DoxyCodeLine{02490\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ visualize\_distortion: }
\DoxyCodeLine{02491\ \ \ \ \ \ \ \ \ \ \ \ \ self.visualize\_distortion(c,\ d) }
\DoxyCodeLine{02492\  }
\DoxyCodeLine{02493\ \ \ \ \ \ \ \ \ cv2.waitKey(0) }
\DoxyCodeLine{02494\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ visroom,\ checkerboard,\ c,\ d\ ,r\ ,t,\ error,\ resolution }
\DoxyCodeLine{02495\  }

\end{DoxyCode}
\Hypertarget{a00206_a14966b15146b30927e515a9b3c64328d}\label{a00206_a14966b15146b30927e515a9b3c64328d} 
\index{room\_estimation@{room\_estimation}!load\_calibration@{load\_calibration}}
\index{load\_calibration@{load\_calibration}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{load\_calibration()}{load\_calibration()}}
{\footnotesize\ttfamily load\+\_\+calibration (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{file }\end{DoxyParamCaption})}

\begin{DoxyVerb}Loads in order
1 Camera matrix
2 Distortion Matrix
3 Rvecs
4 Tvecs
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01866\ \ \ \ \ \textcolor{keyword}{def\ }load\_calibration(self,\ file): }
\DoxyCodeLine{01867\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{} }}
\DoxyCodeLine{01868\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Loads\ in\ order }}
\DoxyCodeLine{01869\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1\ Camera\ matrix }}
\DoxyCodeLine{01870\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 2\ Distortion\ Matrix }}
\DoxyCodeLine{01871\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 3\ Rvecs }}
\DoxyCodeLine{01872\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 4\ Tvecs }}
\DoxyCodeLine{01873\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{01874\  }
\DoxyCodeLine{01875\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(file,\ \textcolor{stringliteral}{'rb'})\ \textcolor{keyword}{as}\ f: }
\DoxyCodeLine{01876\ \ \ \ \ \ \ \ \ \ \ \ \ mtx\ =\ pickle.load(f) }
\DoxyCodeLine{01877\ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =pickle.load(f) }
\DoxyCodeLine{01878\ \ \ \ \ \ \ \ \ \ \ \ \ rvecs\ =pickle.load(f) }
\DoxyCodeLine{01879\ \ \ \ \ \ \ \ \ \ \ \ \ tvecs\ =pickle.load(f) }
\DoxyCodeLine{01880\ \ \ \ \ \ \ \ \ \ \ \ \ error\_list\ =\ pickle.load(f) }
\DoxyCodeLine{01881\ \ \ \ \ \ \ \ \ \ \ \ \ calibration\_resolution\ =\ pickle.load(f) }
\DoxyCodeLine{01882\ \ \ \ \ \ \ \ \ \ \ \ \ f.close() }
\DoxyCodeLine{01883\  }
\DoxyCodeLine{01884\ \ \ \ \ \ \ \ \ print(mtx) }
\DoxyCodeLine{01885\ \ \ \ \ \ \ \ \ self.camera\_matrix\ =\ mtx }
\DoxyCodeLine{01886\ \ \ \ \ \ \ \ \ self.distioriton\_matrix\ =\ dist }
\DoxyCodeLine{01887\ \ \ \ \ \ \ \ \ self.rotation\_vector\ =\ rvecs }
\DoxyCodeLine{01888\ \ \ \ \ \ \ \ \ self.translation\_vector\ =\ tvecs }
\DoxyCodeLine{01889\ \ \ \ \ \ \ \ \ self.error\_list\ =\ error\_list }
\DoxyCodeLine{01890\ \ \ \ \ \ \ \ \ self.calibration\_resolution }
\DoxyCodeLine{01891\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mtx,\ dist,\ rvecs,\ tvecs,\ error\_list,\ calibration\_resolution }
\DoxyCodeLine{01892\  }

\end{DoxyCode}


References room\+\_\+estimation.\+calibration\+\_\+resolution, room\+\_\+estimation.\+camera\+\_\+matrix, room\+\_\+estimation.\+distioriton\+\_\+matrix, room\+\_\+estimation.\+error\+\_\+list, room\+\_\+estimation.\+rotation\+\_\+vector, and room\+\_\+estimation.\+translation\+\_\+vector.



Referenced by \mbox{\hyperlink{a00206_a2a5df656a4b4d07c05b290f8197c316f}{room\+\_\+estimation.\+save\+\_\+room()}}.

Here is the caller graph for this function\+:
% FIG 22
\Hypertarget{a00206_a7fea1337eef39488e7f6b170151cf628}\label{a00206_a7fea1337eef39488e7f6b170151cf628} 
\index{room\_estimation@{room\_estimation}!load\_room@{load\_room}}
\index{load\_room@{load\_room}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{load\_room()}{load\_room()}}
{\footnotesize\ttfamily load\+\_\+room (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{filename }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02459\ \ \ \ \ \textcolor{keyword}{def\ }load\_room(self,\ filename): }
\DoxyCodeLine{02460\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ filename\ : }
\DoxyCodeLine{02461\  }
\DoxyCodeLine{02462\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(filename,\ \textcolor{stringliteral}{'wb'})\ \textcolor{keyword}{as}\ f: }
\DoxyCodeLine{02463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_points\ =\ pickle.load(f) }
\DoxyCodeLine{02464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.corners\ =\ pickle.load(f) }
\DoxyCodeLine{02465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_width\ =\ pickle.load(f) }
\DoxyCodeLine{02466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_length\ =\ pickle.load(f) }
\DoxyCodeLine{02467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.room\_height\ =\ pickle.load(f) }
\DoxyCodeLine{02468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.mapped\ =\ pickle.load(f) }
\DoxyCodeLine{02469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.camera\_matrix\ =\ pickle.load(f) }
\DoxyCodeLine{02470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.distioriton\_matrix\ =\ pickle.load(f) }
\DoxyCodeLine{02471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.rotation\_vector\ =\ pickle.load(f) }
\DoxyCodeLine{02472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.translation\_vector\ =\ pickle.load(f) }
\DoxyCodeLine{02473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.calibration\_resolution\ =\ pickle.load(f) }
\DoxyCodeLine{02474\  }
\DoxyCodeLine{02475\  }
\DoxyCodeLine{02476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f.close() }
\DoxyCodeLine{02477\  }

\end{DoxyCode}
\Hypertarget{a00206_ae66e446204a8676a532acab744601f10}\label{a00206_ae66e446204a8676a532acab744601f10} 
\index{room\_estimation@{room\_estimation}!load\_room\_3d@{load\_room\_3d}}
\index{load\_room\_3d@{load\_room\_3d}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{load\_room\_3d()}{load\_room\_3d()}}
{\footnotesize\ttfamily load\+\_\+room\+\_\+3d (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{filename }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01040\ \ \ \ \ \textcolor{keyword}{def\ }load\_room\_3d(self,\ filename): }
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(filename,\ \textcolor{stringliteral}{'rb'})\ \textcolor{keyword}{as}\ f: }
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ \ \ \ \ mapped\ =\ pickle.load(f) }
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \ \ \ \ f.close() }
\DoxyCodeLine{01044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mapped }
\DoxyCodeLine{01045\  }

\end{DoxyCode}
\Hypertarget{a00206_a444510358faa06884318d1ebe94846ff}\label{a00206_a444510358faa06884318d1ebe94846ff} 
\index{room\_estimation@{room\_estimation}!load\_tracker@{load\_tracker}}
\index{load\_tracker@{load\_tracker}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{load\_tracker()}{load\_tracker()}}
{\footnotesize\ttfamily load\+\_\+tracker (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{csv\+\_\+file }\end{DoxyParamCaption})}

\begin{DoxyVerb}Loads the tracker data of a csv file
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02100\ \ \ \ \ \textcolor{keyword}{def\ }load\_tracker(self,\ csv\_file): }
\DoxyCodeLine{02101\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{02102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Loads\ the\ tracker\ data\ of\ a\ csv\ file }}
\DoxyCodeLine{02103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{02104\  }
\DoxyCodeLine{02105\ \ \ \ \ \ \ \ \ df\ =\ pd.read\_csv(csv\_file) }
\DoxyCodeLine{02106\ \ \ \ \ \ \ \ \ fps\ =\ int(round(df.iloc[0][\textcolor{stringliteral}{'FrameRate'}])) }
\DoxyCodeLine{02107\ \ \ \ \ \ \ \ \ self.invert\_y\ =\ int(df.iloc[1][\textcolor{stringliteral}{'Max\_Pixel\_y'}]) }
\DoxyCodeLine{02108\  }
\DoxyCodeLine{02109\ \ \ \ \ \ \ \ \ df\ =\ df[[\textcolor{stringliteral}{'Frame\_Num'},\textcolor{stringliteral}{'Pixel\_Loc\_x'},\textcolor{stringliteral}{'Pixel\_Loc\_y'},\ \textcolor{stringliteral}{'Name'},\ \textcolor{stringliteral}{'ID'},\textcolor{stringliteral}{'Max\_Pixel\_x'},\ \textcolor{stringliteral}{'Max\_Pixel\_y'},\ \textcolor{stringliteral}{'Width(px)'},\ \textcolor{stringliteral}{'Height(px)'}]] }
\DoxyCodeLine{02110\ \ \ \ \ \ \ \ \ df\ =\ self.correct\_tracker\_points(df) }
\DoxyCodeLine{02111\ \ \ \ \ \ \ \ \ print(df) }
\DoxyCodeLine{02112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ df }
\DoxyCodeLine{02113\  }
\DoxyCodeLine{02114\  }

\end{DoxyCode}


References \mbox{\hyperlink{a00206_ab870abde92556016846a09d5feb9e03c}{room\+\_\+estimation.\+correct\+\_\+tracker\+\_\+points()}}, tracker\+\_\+evaluation.\+invert\+\_\+y, and room\+\_\+estimation.\+invert\+\_\+y.



Referenced by \mbox{\hyperlink{a00206_a75031a34aadd8c7847c479a17524e00e}{room\+\_\+estimation.\+stitch\+\_\+trackers()}}.

Here is the call graph for this function\+:
% FIG 23
Here is the caller graph for this function\+:
% FIG 24
\Hypertarget{a00206_a54ccab8062e8ce67319dcd81d75b6d4a}\label{a00206_a54ccab8062e8ce67319dcd81d75b6d4a} 
\index{room\_estimation@{room\_estimation}!make\_interpolater@{make\_interpolater}}
\index{make\_interpolater@{make\_interpolater}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{make\_interpolater()}{make\_interpolater()}}
{\footnotesize\ttfamily make\+\_\+interpolater (\begin{DoxyParamCaption}\item[{}]{left\+\_\+min,  }\item[{}]{left\+\_\+max,  }\item[{}]{right\+\_\+min,  }\item[{}]{right\+\_\+max }\end{DoxyParamCaption})}

\begin{DoxyVerb}Depreciated.
Supposed to be used to divide a grid space given pixels.
Interpolates values in between min and max.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01506\ \ \ \ \ \textcolor{keyword}{def\ }make\_interpolater(left\_min,\ left\_max,\ right\_min,\ right\_max):\  }
\DoxyCodeLine{01507\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01508\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Depreciated. }}
\DoxyCodeLine{01509\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Supposed\ to\ be\ used\ to\ divide\ a\ grid\ space\ given\ pixels. }}
\DoxyCodeLine{01510\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Interpolates\ values\ in\ between\ min\ and\ max. }}
\DoxyCodeLine{01511\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Figure\ out\ how\ 'wide'\ each\ range\ is\ \  }}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ leftSpan\ =\ left\_max\ -\/\ left\_min\ \  }
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ rightSpan\ =\ right\_max\ -\/\ right\_min\ \  }
\DoxyCodeLine{01515\  }
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compute\ the\ scale\ factor\ between\ left\ and\ right\ values\  }}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ scaleFactor\ =\ float(rightSpan)\ /\ float(leftSpan)\  }
\DoxyCodeLine{01518\  }
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ create\ interpolation\ function\ using\ pre-\/calculated\ scaleFactor }}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }interp\_fn(value): }
\DoxyCodeLine{01521\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ right\_min\ +\ (value-\/left\_min)*scaleFactor }
\DoxyCodeLine{01522\  }
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ interp\_fn }
\DoxyCodeLine{01524\  }

\end{DoxyCode}
\Hypertarget{a00206_ab8bb923e853aeed05b8e25def792f5e4}\label{a00206_ab8bb923e853aeed05b8e25def792f5e4} 
\index{room\_estimation@{room\_estimation}!plot\_points@{plot\_points}}
\index{plot\_points@{plot\_points}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{plot\_points()}{plot\_points()}}
{\footnotesize\ttfamily plot\+\_\+points (\begin{DoxyParamCaption}\item[{}]{event,  }\item[{}]{x,  }\item[{}]{y,  }\item[{}]{flags,  }\item[{}]{params }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00638\ \ \ \ \ \textcolor{keyword}{def\ }plot\_points(event,x,y,flags,params): }
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \textcolor{keyword}{global}\ mouseX,mouseY }
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(params) }}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ mapped\_points\ =\ params }
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ p\_list\ =\ [] }
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ x\_list\ =\ [] }
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ y\_list\ =\ [] }
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ z\_list\ =\ [] }
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ event\ ==\ cv2.EVENT\_LBUTTONDBLCLK: }
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x,y)\ \textcolor{keywordflow}{in}\ mapped\_points.keys(): }
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p\_list\ =\ mapped\_points[(x,y)] }
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ p\ \textcolor{keywordflow}{in}\ p\_list: }
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(p) }
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_list.append(p[0]) }
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\_list.append(p[2]) }
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\_list.append(p[1]) }
\DoxyCodeLine{00656\  }
\DoxyCodeLine{00657\  }
\DoxyCodeLine{00658\  }
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fig\ =\ plt.figure(figsize=(4,4)) }
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ax\ =\ fig.add\_subplot(111,\ projection=\textcolor{stringliteral}{'3d'}) }
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ax.scatter(xs\ =\ x\_list,\ ys\ =\ y\_list,\ zs\ =\ z\_list) }
\DoxyCodeLine{00662\  }
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ax.set\_title(\textcolor{stringliteral}{"{}3D\ Point\ position\ in\ room"{}}) }
\DoxyCodeLine{00664\  }
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ax.set\_xlabel(\textcolor{stringliteral}{"{}X\ (Width"{}}) }
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ax.set\_ylabel(\textcolor{stringliteral}{"{}Y\ (Height)"{}}) }
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ax.set\_zlabel(\textcolor{stringliteral}{"{}Z\ (Depth"{}}) }
\DoxyCodeLine{00668\  }
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ plt.show() }
\DoxyCodeLine{00670\  }

\end{DoxyCode}
\Hypertarget{a00206_a9ddc57e65b6b90133dae37504451b764}\label{a00206_a9ddc57e65b6b90133dae37504451b764} 
\index{room\_estimation@{room\_estimation}!poly\_fit\_wall@{poly\_fit\_wall}}
\index{poly\_fit\_wall@{poly\_fit\_wall}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{poly\_fit\_wall()}{poly\_fit\_wall()}}
{\footnotesize\ttfamily poly\+\_\+fit\+\_\+wall (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{samples,  }\item[{}]{pixels\+\_\+past\+\_\+extent = {\ttfamily 100},  }\item[{}]{horizontal\+\_\+extent = {\ttfamily None},  }\item[{}]{degree = {\ttfamily 2} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Samples exist in format np.array([x,y,z], [x,y,z])

Used to find intersection points.

Utilized to define points in the grid.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01459\ \ \ \ \ \textcolor{keyword}{def\ }poly\_fit\_wall(self,\ samples,\ pixels\_past\_extent=100,horizontal\_extent=None,\ degree=2): }
\DoxyCodeLine{01460\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01461\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Samples\ exist\ in\ format\ np.array([x,y,z],\ [x,y,z]) }}
\DoxyCodeLine{01462\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01463\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Used\ to\ find\ intersection\ points. }}
\DoxyCodeLine{01464\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01465\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Utilized\ to\ define\ points\ in\ the\ grid. }}
\DoxyCodeLine{01466\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01467\  }
\DoxyCodeLine{01468\ \ \ \ \ \ \ \ \ samples\ =\ np.reshape(samples,\ (samples.shape[0],\ 2)) }
\DoxyCodeLine{01469\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ horizontal\_extent\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{01470\ \ \ \ \ \ \ \ \ \ \ \ \ min\ =\ np.amin(samples,\ 0)[0] }
\DoxyCodeLine{01471\ \ \ \ \ \ \ \ \ \ \ \ \ max\ =\ np.amax(samples,\ 0)[0] }
\DoxyCodeLine{01472\ \ \ \ \ \ \ \ \ \ \ \ \ horizontal\_extent\ =\ np.linspace(min\ \ -\/\ pixels\_past\_extent,\ max\ +\ pixels\_past\_extent) }
\DoxyCodeLine{01473\  }
\DoxyCodeLine{01474\  }
\DoxyCodeLine{01475\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Polyfit\ a\ model\ on\ the\ samples\ x,y\ then\ create\ a\ line\ with\ the\ exten\ of\ the\ horizontal\ extent\ we\ provide }}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \ \ fit\ =\ np.polyfit(samples[:,0],\ samples[:,1],\ degree) }
\DoxyCodeLine{01477\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ polynomial\_equation\ =\ np.poly1d(fit) }
\DoxyCodeLine{01479\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Equation"{}},\ polynomial\_equation) }
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01481\ \ \ \ \ \ \ \ \ pred\_line\ =\ polynomial\_equation(horizontal\_extent) }
\DoxyCodeLine{01482\ \ \ \ \ \ \ \ \ pred\_line\ =\ np.reshape(pred\_line,\ (len(pred\_line),1)) }
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ horizontal\_extent\ =\ np.reshape(horizontal\_extent,\ (len(horizontal\_extent),1)) }
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(pred\_line) }}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.hstack((horizontal\_extent,\ pred\_line)),\ polynomial\_equation }
\DoxyCodeLine{01486\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_ae4a382139afef48e3b930752120b4c35}{room\+\_\+estimation.\+define\+\_\+perspective\+\_\+grid()}}, and \mbox{\hyperlink{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}{room\+\_\+estimation.\+find\+\_\+wall\+\_\+intersection()}}.

Here is the caller graph for this function\+:
% FIG 25
\Hypertarget{a00206_a4446e4e6d7e24976a0eb63a6d7970209}\label{a00206_a4446e4e6d7e24976a0eb63a6d7970209} 
\index{room\_estimation@{room\_estimation}!project\_point@{project\_point}}
\index{project\_point@{project\_point}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{project\_point()}{project\_point()}}
{\footnotesize\ttfamily project\+\_\+point (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{event,  }\item[{}]{x,  }\item[{}]{y,  }\item[{}]{flags,  }\item[{}]{params }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01416\ \ \ \ \ \textcolor{keyword}{def\ }project\_point(self,\ event,x,y,flags,params): }
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass} }
\DoxyCodeLine{01418\ \ \ \ \  }

\end{DoxyCode}
\Hypertarget{a00206_a671eb2401939cdbb1c91570e58d4f7c3}\label{a00206_a671eb2401939cdbb1c91570e58d4f7c3} 
\index{room\_estimation@{room\_estimation}!project\_points@{project\_points}}
\index{project\_points@{project\_points}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{project\_points()}{project\_points()}}
{\footnotesize\ttfamily project\+\_\+points (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{points = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00632\ \ \ \ \ \textcolor{keyword}{def\ }project\_points(self,\ points=[]): }
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ points\_np\ =\ np.reshape(np.asfarray(points),\ (len(points),2,1)) }
\DoxyCodeLine{00634\  }
\DoxyCodeLine{00635\  }
\DoxyCodeLine{00636\  }

\end{DoxyCode}
\Hypertarget{a00206_ae36b88c1816fb4bd3fef0f9967aa3527}\label{a00206_ae36b88c1816fb4bd3fef0f9967aa3527} 
\index{room\_estimation@{room\_estimation}!save\_calibration@{save\_calibration}}
\index{save\_calibration@{save\_calibration}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{save\_calibration()}{save\_calibration()}}
{\footnotesize\ttfamily save\+\_\+calibration (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{file,  }\item[{}]{mtx,  }\item[{}]{distortion,  }\item[{}]{rvecs,  }\item[{}]{tvecs,  }\item[{}]{error\+\_\+list,  }\item[{}]{resolution }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01855\ \ \ \ \ \textcolor{keyword}{def\ }save\_calibration(self,\ file,\ mtx,\ distortion,\ rvecs,\ tvecs,\ error\_list,\ resolution): }
\DoxyCodeLine{01856\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ file\ : }
\DoxyCodeLine{01857\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(file,\ \textcolor{stringliteral}{'wb'})\ \textcolor{keyword}{as}\ f: }
\DoxyCodeLine{01858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(mtx,\ f) }
\DoxyCodeLine{01859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(distortion,\ f) }
\DoxyCodeLine{01860\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(rvecs,\ f) }
\DoxyCodeLine{01861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(tvecs,\ f) }
\DoxyCodeLine{01862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(error\_list,\ f) }
\DoxyCodeLine{01863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(resolution,\ f) }
\DoxyCodeLine{01864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f.close() }
\DoxyCodeLine{01865\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_af69d43ebb2e1d46a4e6313f41860c4fb}{room\+\_\+estimation.\+find\+\_\+wall\+\_\+intersection()}}.

Here is the caller graph for this function\+:
% FIG 26
\Hypertarget{a00206_a2a5df656a4b4d07c05b290f8197c316f}\label{a00206_a2a5df656a4b4d07c05b290f8197c316f} 
\index{room\_estimation@{room\_estimation}!save\_room@{save\_room}}
\index{save\_room@{save\_room}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{save\_room()}{save\_room()}}
{\footnotesize\ttfamily save\+\_\+room (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{filename }\end{DoxyParamCaption})}

\begin{DoxyVerb}Saves all values which define a room.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02428\ \ \ \ \ \textcolor{keyword}{def\ }save\_room(self,\ filename): }
\DoxyCodeLine{02429\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{02430\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Saves\ all\ values\ which\ define\ a\ room. }}
\DoxyCodeLine{02431\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02433\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ filename\ : }
\DoxyCodeLine{02434\  }
\DoxyCodeLine{02435\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(filename,\ \textcolor{stringliteral}{'wb'})\ \textcolor{keyword}{as}\ f: }
\DoxyCodeLine{02436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.room\_points,\ f) }
\DoxyCodeLine{02437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.corners,\ f) }
\DoxyCodeLine{02438\  }
\DoxyCodeLine{02439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Room\ Dimensions }}
\DoxyCodeLine{02440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.room\_width,\ f) }
\DoxyCodeLine{02441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.room\_length,\ f) }
\DoxyCodeLine{02442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.room\_height,\ f) }
\DoxyCodeLine{02443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Mapped\ coordinates\ from\ 2D\ to\ 3D.\ Useful\ for\ loading\ up\ tracker\ and\ getting\ 3D\ points }}
\DoxyCodeLine{02445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.mapped,\ f) }
\DoxyCodeLine{02446\  }
\DoxyCodeLine{02447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Save\ calibration. }}
\DoxyCodeLine{02448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.camera\_matrix,\ f) }
\DoxyCodeLine{02449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.distioriton\_matrix,\ f) }
\DoxyCodeLine{02450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.rotation\_vector,\ f) }
\DoxyCodeLine{02451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.translation\_vector,\ f) }
\DoxyCodeLine{02452\  }
\DoxyCodeLine{02453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(self.calibration\_resolution,\ f) }
\DoxyCodeLine{02454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f.close() }
\DoxyCodeLine{02455\  }
\DoxyCodeLine{02456\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Saves\ camera\ calibration }}
\DoxyCodeLine{02457\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.save\_calibration(filename) }}
\DoxyCodeLine{02458\  }

\end{DoxyCode}


References room\+\_\+estimation.\+calibration\+\_\+resolution, room\+\_\+estimation.\+camera\+\_\+matrix, \mbox{\hyperlink{a00142_adcab0c33567748a21cfc4a90e663c1d6}{Camera\+Position.\+collect\+\_\+frames()}}, \mbox{\hyperlink{a00206_a048722841bc8d71bae4a1e4a9eb9db00}{room\+\_\+estimation.\+collect\+\_\+frames()}}, room\+\_\+estimation.\+corners, room\+\_\+estimation.\+distioriton\+\_\+matrix, \mbox{\hyperlink{a00206_a14966b15146b30927e515a9b3c64328d}{room\+\_\+estimation.\+load\+\_\+calibration()}}, room\+\_\+estimation.\+mapped, room\+\_\+estimation.\+room\+\_\+height, room\+\_\+estimation.\+room\+\_\+length, room\+\_\+estimation.\+room\+\_\+points, room\+\_\+estimation.\+room\+\_\+width, room\+\_\+estimation.\+rotation\+\_\+vector, room\+\_\+estimation.\+translation\+\_\+vector, \mbox{\hyperlink{a00206_abd979a29c40c64a598514d7d165bb4a9}{room\+\_\+estimation.\+undistort\+\_\+room()}}, and \mbox{\hyperlink{a00206_a6c6c06bc8bbf8a0f9f7237a97ff9487e}{room\+\_\+estimation.\+visualize\+\_\+distortion()}}.

Here is the call graph for this function\+:
% FIG 27
\Hypertarget{a00206_acf8ba8f0370d5371ba8c5a28e3e3d587}\label{a00206_acf8ba8f0370d5371ba8c5a28e3e3d587} 
\index{room\_estimation@{room\_estimation}!save\_room\_3d@{save\_room\_3d}}
\index{save\_room\_3d@{save\_room\_3d}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{save\_room\_3d()}{save\_room\_3d()}}
{\footnotesize\ttfamily save\+\_\+room\+\_\+3d (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path,  }\item[{}]{filename,  }\item[{}]{mapped }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01032\ \ \ \ \ \textcolor{keyword}{def\ }save\_room\_3d(self,\ path,\ filename,\ mapped): }
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Saving\ mapped\ points..."{}}) }
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ path\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(filename,\ \textcolor{stringliteral}{'wb'})\ \textcolor{keyword}{as}\ f: }
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pickle.dump(mapped,\ f) }
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f.close() }
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Save\ Complete."{}}) }
\DoxyCodeLine{01039\ \ \ \ \  }

\end{DoxyCode}
\Hypertarget{a00206_a833c6efe94bd835b3ab82191c47f04fe}\label{a00206_a833c6efe94bd835b3ab82191c47f04fe} 
\index{room\_estimation@{room\_estimation}!set\_axis@{set\_axis}}
\index{set\_axis@{set\_axis}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{set\_axis()}{set\_axis()}}
{\footnotesize\ttfamily set\+\_\+axis (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{x,  }\item[{}]{y,  }\item[{}]{z }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keyword}{def\ }set\_axis(self,\ x,\ y,\ z): }
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ axis\ =\ np.float32([[0,0,0],\ [0,3000,0],\ [3000,3000,0],\ [3000,0,0], }}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ [0,0,3000],[0,3000,3000],[3000,3000,3000],[3000,0,3000]\ ]) }}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ self.axis\ =\ np.float32([[x,0,0],\ [0,z,0],\ [0,0,y]]).reshape(-\/1,3) }
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.axis }
\DoxyCodeLine{00231\  }

\end{DoxyCode}
\Hypertarget{a00206_acfa65bf2973032f8d2e0e33872634b06}\label{a00206_acfa65bf2973032f8d2e0e33872634b06} 
\index{room\_estimation@{room\_estimation}!set\_corners@{set\_corners}}
\index{set\_corners@{set\_corners}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{set\_corners()}{set\_corners()}}
{\footnotesize\ttfamily set\+\_\+corners (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{p1 = {\ttfamily None},  }\item[{}]{p2 = {\ttfamily None},  }\item[{}]{p3 = {\ttfamily None},  }\item[{}]{p4 = {\ttfamily None} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keyword}{def\ }set\_corners(self,\ p1=None,\ p2=None,\ p3=None,\ p4=None): }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ p1: }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ self.corner[0]\ =\ np.asarray([p1[0],p1[1]]).reshape(1,2,1) }
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ p2: }
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ self.corner[1]\ =\ np.asarray([p2[0],p2[1]]).reshape(1,2,1) }
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ p3: }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ self.corner[2]\ =\ np.asarray([p3[0],p3[1]]).reshape(1,2,1) }
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ p3: }
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ self.corner[3]\ =\ np.asarray([p4[0],p4[1]]).reshape(1,2,1) }
\DoxyCodeLine{00241\  }

\end{DoxyCode}
\Hypertarget{a00206_a5da847c11e206bbccbe29ec5e042462a}\label{a00206_a5da847c11e206bbccbe29ec5e042462a} 
\index{room\_estimation@{room\_estimation}!set\_image@{set\_image}}
\index{set\_image@{set\_image}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{set\_image()}{set\_image()}}
{\footnotesize\ttfamily set\+\_\+image (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keyword}{def\ }set\_image(self,\ image): }
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ self.image\ =\ image }
\DoxyCodeLine{00200\  }

\end{DoxyCode}
\Hypertarget{a00206_a0a327e18a9cf669bab61d714980d73b0}\label{a00206_a0a327e18a9cf669bab61d714980d73b0} 
\index{room\_estimation@{room\_estimation}!show\_tracker\_2D@{show\_tracker\_2D}}
\index{show\_tracker\_2D@{show\_tracker\_2D}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{show\_tracker\_2D()}{show\_tracker\_2D()}}
{\footnotesize\ttfamily show\+\_\+tracker\+\_\+2D (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{df,  }\item[{}]{image,  }\item[{}]{data\+\_\+columns = {\ttfamily \mbox{[}\textquotesingle{}Pixel\+\_\+Loc\+\_\+x\textquotesingle{},~\textquotesingle{}Pixel\+\_\+Loc\+\_\+y\textquotesingle{}\mbox{]}},  }\item[{}]{window = {\ttfamily "{}Tracker2D"{}},  }\item[{}]{colour = {\ttfamily (255,255,0)} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02253\ \ \ \ \ \textcolor{keyword}{def\ }show\_tracker\_2D(self,\ df,\ image,\ data\_columns\ =['Pixel\_Loc\_x',\ 'Pixel\_Loc\_y'],\ window="{}Tracker2D"{},\ colour\ =\ (255,255,0)): }
\DoxyCodeLine{02254\ \ \ \ \ \ \ \ \ x\ =\ df[data\_columns[0]].tolist() }
\DoxyCodeLine{02255\ \ \ \ \ \ \ \ \ y\ =\ df[data\_columns[1]].tolist() }
\DoxyCodeLine{02256\  }
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ range(len(x)): }
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ cv2.circle(image,\ (int(x[index]),\ int(y[index])),\ 2,\ colour,\ 2) }
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(window,\ image) }
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(1) }
\DoxyCodeLine{02261\  }
\DoxyCodeLine{02262\  }

\end{DoxyCode}
\Hypertarget{a00206_ab099905032ea6fd2a2e17e2414e58872}\label{a00206_ab099905032ea6fd2a2e17e2414e58872} 
\index{room\_estimation@{room\_estimation}!show\_tracker\_3D@{show\_tracker\_3D}}
\index{show\_tracker\_3D@{show\_tracker\_3D}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{show\_tracker\_3D()}{show\_tracker\_3D()}}
{\footnotesize\ttfamily show\+\_\+tracker\+\_\+3D (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{df,  }\item[{}]{mapped\+\_\+min,  }\item[{}]{mapped\+\_\+max }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02145\ \ \ \ \ \textcolor{keyword}{def\ }show\_tracker\_3D(self,\ df,\ mapped\_min,\ mapped\_max): }
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://stackoverflow.com/questions/38118598/3d-\/animation-\/using-\/matplotlib }}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Convert\ df\ points\ numpy\ array }}
\DoxyCodeLine{02148\ \ \ \ \ \ \ \ \ x\_df\ =\ df[\textcolor{stringliteral}{'Pixel\_Loc\_x'}] }
\DoxyCodeLine{02149\ \ \ \ \ \ \ \ \ y\_df\ =\ df[\textcolor{stringliteral}{'Pixel\_Loc\_y'}] }
\DoxyCodeLine{02150\  }
\DoxyCodeLine{02151\  }
\DoxyCodeLine{02152\  }
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ N\ =\ 100 }}
\DoxyCodeLine{02154\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ data\ =\ np.array(list(gen(N))).T }}
\DoxyCodeLine{02155\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ line,\ =\ ax.plot(data[0,\ 0:1],\ data[1,\ 0:1],\ data[2,\ 0:1]) }}
\DoxyCodeLine{02156\  }
\DoxyCodeLine{02157\  }
\DoxyCodeLine{02158\  }
\DoxyCodeLine{02159\ \ \ \ \ \ \ \ \ x\_list1\ =\ [] }
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ y\_list1\ =\ [] }
\DoxyCodeLine{02161\ \ \ \ \ \ \ \ \ z\_list1\ =\ [] }
\DoxyCodeLine{02162\  }
\DoxyCodeLine{02163\ \ \ \ \ \ \ \ \ x\_list2\ =\ [] }
\DoxyCodeLine{02164\ \ \ \ \ \ \ \ \ y\_list2\ =\ [] }
\DoxyCodeLine{02165\ \ \ \ \ \ \ \ \ z\_list2\ =\ [] }
\DoxyCodeLine{02166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ range(len(x\_df)): }
\DoxyCodeLine{02167\ \ \ \ \ \ \ \ \ \ \ \ \ point\ =\ (int(x\_df.loc[index+1]),\ int(y\_df.loc[index+1])) }
\DoxyCodeLine{02168\  }
\DoxyCodeLine{02169\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Interactive\ mode }}
\DoxyCodeLine{02170\  }
\DoxyCodeLine{02171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ point\ \textcolor{keywordflow}{in}\ mapped\_min.keys(): }
\DoxyCodeLine{02172\ \textcolor{comment}{\#\  }}
\DoxyCodeLine{02173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_point\ =\ mapped\_min[point] }
\DoxyCodeLine{02174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ p\ in\ min\_point: }}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x,y,z\ =\ p }}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x,z,y\ =\ min\_point[0] }
\DoxyCodeLine{02177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_list1.append(x) }
\DoxyCodeLine{02178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\_list1.append(y) }
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\_list1.append(z) }
\DoxyCodeLine{02180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ scatter\ =\ ax.scatter3D(x,\ y,z,\ cmap='Greens') }}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.front\_plt\ =\ ax.scatter3D(x,\ y,\ z) }}
\DoxyCodeLine{02182\  }
\DoxyCodeLine{02183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ point\ \textcolor{keywordflow}{in}\ mapped\_max.keys(): }
\DoxyCodeLine{02184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_point\ =\ mapped\_max[point] }
\DoxyCodeLine{02185\  }
\DoxyCodeLine{02186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ p\ in\ max\_point: }}
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x,z,y\ =\ max\_point[0] }
\DoxyCodeLine{02188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_list2.append(x) }
\DoxyCodeLine{02189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\_list2.append(y) }
\DoxyCodeLine{02190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\_list2.append(z) }
\DoxyCodeLine{02191\ \ \ \ \ \ \ \ \ plt.ion }
\DoxyCodeLine{02192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.fig\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ \ \ \ \ self.fig\ =\ plt.figure(1) }
\DoxyCodeLine{02194\ \ \ \ \ \ \ \ \ \ \ \ \ self.ax\ =\ plt.axes(projection=\textcolor{stringliteral}{'3d'}) }
\DoxyCodeLine{02195\  }
\DoxyCodeLine{02196\  }
\DoxyCodeLine{02197\ \ \ \ \ \ \ \ \ \ \ \ \ self.back\_plt\ =\ self.ax.scatter3D(x\_list1,\ y\_list1,\ z\_list1,\ cmap=\textcolor{stringliteral}{'Greens'}) }
\DoxyCodeLine{02198\ \ \ \ \ \ \ \ \ \ \ \ \ self.back\_plt\ =\ self.ax.scatter3D(x\_list2,\ y\_list2,\ z\_list2,\ cmap=\textcolor{stringliteral}{'Blues'}) }
\DoxyCodeLine{02199\  }
\DoxyCodeLine{02200\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.line\_plt\ =\ ax.plot3D([front\_point[0],back\_point[0]],\ [front\_point[1],back\_point[1]],\ [0,self.room\_length],\ color='teal') }}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02202\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ plt.quiver(*origin,\ V[:,0],\ V[:,1],\ color=['r','b','g'],\ scale=21) }}
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_xlim(-\/self.room\_width,self.room\_width) }
\DoxyCodeLine{02204\ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_ylim(-\/self.room\_height,self.room\_height) }
\DoxyCodeLine{02205\ \ \ \ \ \ \ \ \ \ \ \ \ self.ax.set\_zlim(-\/self.room\_length,self.room\_length) }
\DoxyCodeLine{02206\ \ \ \ \ \ \ \ \ \ \ \ \ self.fig.canvas.draw() }
\DoxyCodeLine{02207\ \ \ \ \ \ \ \ \ \ \ \ \ self.fig.canvas.flush\_events() }
\DoxyCodeLine{02208\ \ \ \ \ \ \ \ \ \ \ \ \ self.fig.show() }
\DoxyCodeLine{02209\  }
\DoxyCodeLine{02210\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ else: }}
\DoxyCodeLine{02211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.ax.cla() }}
\DoxyCodeLine{02212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ values: }}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ self.points\_plt\ =\ self.ax.scatter3D(x\_list,y\_list,z\_list,\ marker="{}D"{},\ color="{}red"{}) }}
\DoxyCodeLine{02214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \#\ plt.quiver((0,0,0),\ (0,1,0),\ ,\ color=['r','b','g'],\ scale=21) }}
\DoxyCodeLine{02215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.ax.set\_xlim(-\/self.room\_width,self.room\_width) }}
\DoxyCodeLine{02216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.ax.set\_ylim(-\/self.room\_height,self.room\_width) }}
\DoxyCodeLine{02217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.ax.set\_zlim(-\/self.room\_length,self.room\_width) }}
\DoxyCodeLine{02218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.ax.set\_xlabel("{}X"{}) }}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.ax.set\_ylabel("{}Y"{}) }}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.ax.set\_zlabel("{}Z"{}) }}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.float\_plt\ =\ self.ax.scatter3D(floater\_point[0],floater\_point[1],self.vector\_depth,\ marker="{}o"{},\ color="{}blue"{}) }}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.front\_plt\ =\ self.ax.scatter3D(front\_point[0],\ front\_point[1],\ 0,\ marker=("{}o"{}),\ color="{}cyan"{}) }}
\DoxyCodeLine{02224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.back\_plt\ =\ self.ax.scatter3D(back\_point[0],back\_point[1],\ self.room\_length,\ marker="{}x"{},\ color="{}cyan"{}) }}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.line\_plt\ =\ self.ax.plot3D([front\_point[0],back\_point[0]],\ [front\_point[1],back\_point[1]],\ [0,self.room\_length],\ color='teal') }}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.quiver\ =\ self.ax.quiver([0,0,0],\ [0,0,0],\ [0,0,0],\ [self.room\_width,0,0],\ [0,self.room\_height,0],\ [0,0,self.room\_length],\ length=0.1,\ normalize=False) }}
\DoxyCodeLine{02227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.fig.canvas.draw() }}
\DoxyCodeLine{02228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.fig.canvas.flush\_events() }}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ image\ =\ cv2.circle(image,\ point,\ 2,\ (255,255,0),\ 2) }}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.imshow("{}Tracker2D"{},\ image) }}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.waitKey(1) }}
\DoxyCodeLine{02232\  }
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ point\ in\ mapped\_min.keys(): }}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ min\_point\ =\ mapped\_min[point] }}
\DoxyCodeLine{02235\  }
\DoxyCodeLine{02236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ for\ p\ in\ min\_point: }}
\DoxyCodeLine{02237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ x,y,z\ =\ p }}
\DoxyCodeLine{02238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ scatter\ =\ ax.scatter3D(x,\ y,z,\ cmap='Greens') }}
\DoxyCodeLine{02239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \#\ ax.plot\_surface(x,\ y,\ z,\ color=('r')) }}
\DoxyCodeLine{02240\  }
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ point\ in\ mapped\_max.keys(): }}
\DoxyCodeLine{02242\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ max\_point\ =\ mapped\_max[point] }}
\DoxyCodeLine{02243\  }
\DoxyCodeLine{02244\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ for\ p\ in\ max\_point: }}
\DoxyCodeLine{02245\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ x,y,z\ =\ p }}
\DoxyCodeLine{02246\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ scatter\ =\ ax.scatter3D(x,\ y,z,\ cmap='Blues') }}
\DoxyCodeLine{02247\  }
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02249\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.show\_img }
\DoxyCodeLine{02251\  }
\DoxyCodeLine{02252\  }

\end{DoxyCode}
\Hypertarget{a00206_adbe2f98b84513775c3106191f2845ed3}\label{a00206_adbe2f98b84513775c3106191f2845ed3} 
\index{room\_estimation@{room\_estimation}!stitch\_rooms@{stitch\_rooms}}
\index{stitch\_rooms@{stitch\_rooms}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{stitch\_rooms()}{stitch\_rooms()}}
{\footnotesize\ttfamily stitch\+\_\+rooms (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{video\+\_\+list,  }\item[{}]{undistort = {\ttfamily True},  }\item[{}]{key\+\_\+index = {\ttfamily None},  }\item[{}]{show = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Stitches rooms with custom keypoints with SIFT descriptors

undistort uses current room undistortion parameters to undistort all the videos in video_list

key_index is the index for which video is the source that all others will use as alignment reference.

returns a stitched image that is overlapped by all videos and a list of homography transformation matrices for every video index
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02506\ \ \ \ \ \textcolor{keyword}{def\ }stitch\_rooms(self,\ video\_list,\ undistort=True,\ key\_index=None,\ show=False): }
\DoxyCodeLine{02507\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{02508\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Stitches\ rooms\ with\ custom\ keypoints\ with\ SIFT\ descriptors }}
\DoxyCodeLine{02509\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02510\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ undistort\ uses\ current\ room\ undistortion\ parameters\ to\ undistort\ all\ the\ videos\ in\ video\_list }}
\DoxyCodeLine{02511\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02512\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ key\_index\ is\ the\ index\ for\ which\ video\ is\ the\ source\ that\ all\ others\ will\ use\ as\ alignment\ reference. }}
\DoxyCodeLine{02513\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02514\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ returns\ a\ stitched\ image\ that\ is\ overlapped\ by\ all\ videos\ and\ a\ list\ of\ homography\ transformation\ matrices\ for\ every\ video\ index }}
\DoxyCodeLine{02515\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{02516\  }
\DoxyCodeLine{02517\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Undistort\ all\ the\ rooms }}
\DoxyCodeLine{02518\ \ \ \ \ \ \ \ \ room\_images\ =\ [] }
\DoxyCodeLine{02519\ \ \ \ \ \ \ \ \ room\_tracks\ =\ [] }
\DoxyCodeLine{02520\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ video\ \textcolor{keywordflow}{in}\ video\_list: }
\DoxyCodeLine{02521\ \ \ \ \ \ \ \ \ \ \ \ \ print(video) }
\DoxyCodeLine{02522\ \ \ \ \ \ \ \ \ \ \ \ \ frame\ =\ self.collect\_frames(video,1,1,2)[0] }
\DoxyCodeLine{02523\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ undistort: }
\DoxyCodeLine{02524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ frame\ =\ self.undistort\_room(frame) }
\DoxyCodeLine{02525\ \ \ \ \ \ \ \ \ \ \ \ \ room\_images.append(frame) }
\DoxyCodeLine{02526\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02527\ \ \ \ \ \ \ \ \ \textcolor{comment}{\# }}
\DoxyCodeLine{02528\ \ \ \ \ \ \ \ \ image\_dict\ =\ \{\} }
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ orb\ =\ cv2.ORB\_create() }
\DoxyCodeLine{02530\ \ \ \ \ \ \ \ \ sift\ =\ cv2.SIFT\_create() }
\DoxyCodeLine{02531\  }
\DoxyCodeLine{02532\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Self\ defined\ keypoints\ with\ corner\ detection.\  }}
\DoxyCodeLine{02533\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ img\ \textcolor{keywordflow}{in}\ enumerate(room\_images): }
\DoxyCodeLine{02534\ \ \ \ \ \ \ \ \ \ \ \ \ maxCorners\ =\ max(0,\ 200) }
\DoxyCodeLine{02535\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Parameters\ for\ Shi-\/Tomasi\ algorithm }}
\DoxyCodeLine{02536\ \ \ \ \ \ \ \ \ \ \ \ \ qualityLevel\ =\ 0.01 }
\DoxyCodeLine{02537\ \ \ \ \ \ \ \ \ \ \ \ \ minDistance\ =\ 10 }
\DoxyCodeLine{02538\ \ \ \ \ \ \ \ \ \ \ \ \ blockSize\ =\ 3 }
\DoxyCodeLine{02539\ \ \ \ \ \ \ \ \ \ \ \ \ gradientSize\ =\ 3 }
\DoxyCodeLine{02540\ \ \ \ \ \ \ \ \ \ \ \ \ useHarrisDetector\ =\ \textcolor{keyword}{False} }
\DoxyCodeLine{02541\ \ \ \ \ \ \ \ \ \ \ \ \ k\ =\ 0.03 }
\DoxyCodeLine{02542\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Copy\ the\ source\ image }}
\DoxyCodeLine{02543\ \ \ \ \ \ \ \ \ \ \ \ \ copy\ =\ np.copy(img) }
\DoxyCodeLine{02544\ \ \ \ \ \ \ \ \ \ \ \ \ gray\ =\ cv2.cvtColor(img,cv2.COLOR\_BGR2GRAY) }
\DoxyCodeLine{02545\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Apply\ corner\ detection }}
\DoxyCodeLine{02546\ \ \ \ \ \ \ \ \ \ \ \ \ corners\ =\ cv2.goodFeaturesToTrack(gray,\ maxCorners,\ qualityLevel,\ minDistance,\ \textcolor{keywordtype}{None},\ blockSize=blockSize,\ gradientSize=gradientSize,\ useHarrisDetector=useHarrisDetector,\ k=k) }
\DoxyCodeLine{02547\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Draw\ corners\ detected }}
\DoxyCodeLine{02548\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{'**\ Number\ of\ corners\ detected:'},\ corners.shape[0]) }
\DoxyCodeLine{02549\ \ \ \ \ \ \ \ \ \ \ \ \ radius\ =\ 4 }
\DoxyCodeLine{02550\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(corners.shape[0]): }
\DoxyCodeLine{02551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.circle(copy,\ (int(corners[i,0,0]),\ int(corners[i,0,1])),\ radius,\ (0,\ 255,\ 0),\ cv2.FILLED) }
\DoxyCodeLine{02552\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Show\ what\ you\ got }}
\DoxyCodeLine{02553\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ show: }
\DoxyCodeLine{02554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.namedWindow(\textcolor{stringliteral}{"{}source\_window"{}}) }
\DoxyCodeLine{02555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}source\_window"{}},\ copy) }
\DoxyCodeLine{02556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(600) }
\DoxyCodeLine{02557\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Set\ the\ needed\ parameters\ to\ find\ the\ refined\ corners }}
\DoxyCodeLine{02558\ \ \ \ \ \ \ \ \ \ \ \ \ winSize\ =\ (5,\ 5) }
\DoxyCodeLine{02559\ \ \ \ \ \ \ \ \ \ \ \ \ zeroZone\ =\ (-\/1,\ -\/1) }
\DoxyCodeLine{02560\ \ \ \ \ \ \ \ \ \ \ \ \ criteria\ =\ (cv2.TERM\_CRITERIA\_EPS\ +\ cv2.TermCriteria\_COUNT,\ 40,\ 0.001) }
\DoxyCodeLine{02561\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Calculate\ the\ refined\ corner\ locations }}
\DoxyCodeLine{02562\ \ \ \ \ \ \ \ \ \ \ \ \ corners\ =\ cv2.cornerSubPix(gray,\ corners,\ winSize,\ zeroZone,\ criteria) }
\DoxyCodeLine{02563\  }
\DoxyCodeLine{02564\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Convert\ subpixel\ corners\ to\ keypoints\ and\ create\ SIFT\ descriptors }}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \ \ \ \ \ \ kp\_corners\ =\ cv2.KeyPoint\_convert(corners) }
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \ \ \ \ kp\_corners,\ kp\_des\ =\ sift.compute(img,\ kp\_corners) }
\DoxyCodeLine{02567\ \ \ \ \ \ \ \ \ \ \ \ \ img=cv2.drawKeypoints(img,kp\_corners,img) }
\DoxyCodeLine{02568\  }
\DoxyCodeLine{02569\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Store\ for\ later\ use }}
\DoxyCodeLine{02570\ \ \ \ \ \ \ \ \ \ \ \ \ image\_dict[index]\ =\ (kp\_corners,\ kp\_des,\ img,\ corners) }
\DoxyCodeLine{02571\  }
\DoxyCodeLine{02572\  }
\DoxyCodeLine{02573\  }
\DoxyCodeLine{02574\ \ \ \ \ \ \ \ \ matcher\ =\ cv2.BFMatcher() }
\DoxyCodeLine{02575\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ matcher\ =\ cv2.DescriptorMatcher\_create(cv2.DESCRIPTOR\_MATCHER\_FLANNBASED) }}
\DoxyCodeLine{02576\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ matcher\ =\ flann.knnMatch(des1,des2,k=2) }}
\DoxyCodeLine{02577\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ FLANN\_INDEX\_KDTREE\ =\ 1 }}
\DoxyCodeLine{02578\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ index\_params\ =\ dict(algorithm\ =\ FLANN\_INDEX\_KDTREE,\ trees\ =\ 8) }}
\DoxyCodeLine{02579\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ search\_params\ =\ dict(checks\ =\ 100) }}
\DoxyCodeLine{02580\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ flann\ =\ cv2.FlannBasedMatcher(index\_params,\ search\_params) }}
\DoxyCodeLine{02581\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02582\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}MATCHING"{}}) }
\DoxyCodeLine{02583\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\_index\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{02584\ \ \ \ \ \ \ \ \ \ \ \ \ source\_images\ =\ image\_dict.keys() }
\DoxyCodeLine{02585\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{02586\ \ \ \ \ \ \ \ \ \ \ \ \ source\_images\ =\ [key\_index] }
\DoxyCodeLine{02587\  }
\DoxyCodeLine{02588\ \ \ \ \ \ \ \ \ accumulate\ =\ image\_dict[source\_images[0]][2] }
\DoxyCodeLine{02589\ \ \ \ \ \ \ \ \ homographies\ =\ [] }
\DoxyCodeLine{02590\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ img\_key\_1\ \textcolor{keywordflow}{in}\ source\_images: }
\DoxyCodeLine{02591\ \ \ \ \ \ \ \ \ \ \ \ \ accumulate\ =\ image\_dict[img\_key\_1][2] }
\DoxyCodeLine{02592\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ img\_key\_2\ \textcolor{keywordflow}{in}\ image\_dict.keys(): }
\DoxyCodeLine{02593\  }
\DoxyCodeLine{02594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ img\_key\_1\ ==\ img\_key\_2: }
\DoxyCodeLine{02595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue} }
\DoxyCodeLine{02596\  }
\DoxyCodeLine{02597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(image\_dict[img\_key\_1][3].shape) }
\DoxyCodeLine{02598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d1\ =\ image\_dict[img\_key\_1][1] }
\DoxyCodeLine{02599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d2\ =\ image\_dict[img\_key\_2][1] }
\DoxyCodeLine{02600\  }
\DoxyCodeLine{02601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kp1\ =\ image\_dict[img\_key\_1][0] }
\DoxyCodeLine{02602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kp2\ =\ image\_dict[img\_key\_2][0] }
\DoxyCodeLine{02603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ img\ =\ image\_dict[img\_key\_2][2] }
\DoxyCodeLine{02604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ matches\ =\ matcher.knnMatch(d1,d2,\ k=2) }
\DoxyCodeLine{02605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ matches\ =\ flann.knnMatch(d1,d2,\ k=2) }}
\DoxyCodeLine{02606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ m\ \textcolor{keywordflow}{in}\ matches: }
\DoxyCodeLine{02607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(m[0].distance) }
\DoxyCodeLine{02608\  }
\DoxyCodeLine{02609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ good\ =\ [] }
\DoxyCodeLine{02610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ m,n\ \textcolor{keywordflow}{in}\ matches: }
\DoxyCodeLine{02611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ m.distance\ <\ 0.4*n.distance: }
\DoxyCodeLine{02612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ good.append(m) }
\DoxyCodeLine{02613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02614\  }
\DoxyCodeLine{02615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dst\_pts\ =\ np.float32([\ kp1[m.queryIdx].pt\ \textcolor{keywordflow}{for}\ m\ \textcolor{keywordflow}{in}\ good\ ]).reshape(-\/1,1,2) }
\DoxyCodeLine{02616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ src\_pts\ =\ np.float32([\ kp2[m.trainIdx].pt\ \textcolor{keywordflow}{for}\ m\ \textcolor{keywordflow}{in}\ good\ ]).reshape(-\/1,1,2) }
\DoxyCodeLine{02617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Sort\ them\ in\ the\ order\ of\ their\ distance. }}
\DoxyCodeLine{02620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ matches\ =\ sorted(matches,\ key\ =\ \textcolor{keyword}{lambda}\ x:x[0].distance) }
\DoxyCodeLine{02621\  }
\DoxyCodeLine{02622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(matches) }}
\DoxyCodeLine{02623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ img3\ =\ cv2.drawMatchesKnn(image\_dict[img\_key\_1][2],\ image\_dict[img\_key\_1][0], }}
\DoxyCodeLine{02624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\_dict[img\_key\_2][2],\ image\_dict[img\_key\_2][0], }}
\DoxyCodeLine{02625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ matches[:10], }}
\DoxyCodeLine{02626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ None,flags=cv2.DrawMatchesFlags\_NOT\_DRAW\_SINGLE\_POINTS) }}
\DoxyCodeLine{02627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.imshow("{}homography"{},\ img3) }}
\DoxyCodeLine{02628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02629\  }
\DoxyCodeLine{02630\  }
\DoxyCodeLine{02631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ RHO\ =\ [Bazargani15].\ (weighted\ RANSAC\ modification,\ faster\ in\ the\ case\ of\ many\ outliers) }}
\DoxyCodeLine{02632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ M,\ mask\ =\ cv2.findHomography(src\_pts,\ dst\_pts,\ cv2.RHO,\ 10.0) }
\DoxyCodeLine{02633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ homographies.append((M,mask)) }
\DoxyCodeLine{02634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h,w,\ \_\ =\ img.shape }
\DoxyCodeLine{02635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ cv2.warpPerspective(image\_dict[img\_key\_2][2],\ M,(w,\ h)) }
\DoxyCodeLine{02636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(h) }
\DoxyCodeLine{02637\  }
\DoxyCodeLine{02638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ accumulate\ =\ cv2.addWeighted(accumulate,0.8,result,0.4,0) }
\DoxyCodeLine{02639\  }
\DoxyCodeLine{02640\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.imshow("{}warped"{},\ accumulate) }}
\DoxyCodeLine{02641\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.waitKey(0) }}
\DoxyCodeLine{02642\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ accumulate,\ homographies }
\DoxyCodeLine{02643\  }

\end{DoxyCode}


References \mbox{\hyperlink{a00142_adcab0c33567748a21cfc4a90e663c1d6}{Camera\+Position.\+collect\+\_\+frames()}}, \mbox{\hyperlink{a00206_a048722841bc8d71bae4a1e4a9eb9db00}{room\+\_\+estimation.\+collect\+\_\+frames()}}, and \mbox{\hyperlink{a00206_abd979a29c40c64a598514d7d165bb4a9}{room\+\_\+estimation.\+undistort\+\_\+room()}}.

Here is the call graph for this function\+:
% FIG 28
\Hypertarget{a00206_a75031a34aadd8c7847c479a17524e00e}\label{a00206_a75031a34aadd8c7847c479a17524e00e} 
\index{room\_estimation@{room\_estimation}!stitch\_trackers@{stitch\_trackers}}
\index{stitch\_trackers@{stitch\_trackers}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{stitch\_trackers()}{stitch\_trackers()}}
{\footnotesize\ttfamily stitch\+\_\+trackers (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{video\+\_\+list,  }\item[{}]{homography\+\_\+list,  }\item[{}]{use\+\_\+csv = {\ttfamily True},  }\item[{}]{offsets = {\ttfamily \mbox{[}0,0,0,0\mbox{]}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}returns a list of trackers
# offset = [top, left, bottom, right] in pixels

We correct offsets if top and left edges are extended
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02644\ \ \ \ \ \textcolor{keyword}{def\ }stitch\_trackers(self,\ video\_list,\ homography\_list,\ use\_csv=True,\ offsets=[0,0,0,0]): }
\DoxyCodeLine{02645\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{02646\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ returns\ a\ list\ of\ trackers }}
\DoxyCodeLine{02647\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \#\ offset\ =\ [top,\ left,\ bottom,\ right]\ in\ pixels }}
\DoxyCodeLine{02648\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02649\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ We\ correct\ offsets\ if\ top\ and\ left\ edges\ are\ extended }}
\DoxyCodeLine{02650\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{02651\  }
\DoxyCodeLine{02652\ \ \ \ \ \ \ \ \ dataframe\_list\ =\ [] }
\DoxyCodeLine{02653\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ video\ \textcolor{keywordflow}{in}\ enumerate(video\_list): }
\DoxyCodeLine{02654\ \ \ \ \ \ \ \ \ \ \ \ \ data\_path\ =\ str(video[:-\/3]\ +\ \textcolor{stringliteral}{'csv'}) }
\DoxyCodeLine{02655\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ self.collect\_frames(video,1,1,2)[0] }
\DoxyCodeLine{02656\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Load\ data }}
\DoxyCodeLine{02657\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}: }
\DoxyCodeLine{02658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ self.load\_tracker(data\_path) }
\DoxyCodeLine{02659\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e: }
\DoxyCodeLine{02660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(e) }
\DoxyCodeLine{02661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Skipping\ Data"{}}) }
\DoxyCodeLine{02662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue} }
\DoxyCodeLine{02663\  }
\DoxyCodeLine{02664\ \ \ \ \ \ \ \ \ \ \ \ \ offset\_top\ =\ offsets[0] }
\DoxyCodeLine{02665\ \ \ \ \ \ \ \ \ \ \ \ \ offset\_left\ =\ offsets[1] }
\DoxyCodeLine{02666\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02667\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Undistort\ data }}
\DoxyCodeLine{02668\ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ self.undistort\_tracker\_data(data,\ image) }
\DoxyCodeLine{02669\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ data[\textcolor{stringliteral}{'undistorted\_x'}].to\_numpy()\ +\ offset\_left }
\DoxyCodeLine{02670\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ data[\textcolor{stringliteral}{'undistorted\_y'}].to\_numpy()\ +\ offset\_top }
\DoxyCodeLine{02671\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ [1]\ *\ len(x) }
\DoxyCodeLine{02672\ \ \ \ \ \ \ \ \ \ \ \ \ points\ =\ np.vstack((x,\ y)).T }
\DoxyCodeLine{02673\ \ \ \ \ \ \ \ \ \ \ \ \ points\ =\ points.reshape((-\/1,\ 1,\ 2)) }
\DoxyCodeLine{02674\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ points\ =\ points.reshape((1,3,\ len(x))) }}
\DoxyCodeLine{02675\  }
\DoxyCodeLine{02676\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ No\ transformation\ if\ we\ have\ the\ same\ image }}
\DoxyCodeLine{02677\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ index\ ==\ 0: }
\DoxyCodeLine{02678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}NO\ DISTORTION"{}}) }
\DoxyCodeLine{02679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Matrix\ =\ np.identity(3) }
\DoxyCodeLine{02680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Maks\ =\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{02681\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{02682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Matrix,\ Mask\ =\ homography\_list[index-\/1] }
\DoxyCodeLine{02683\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ a\_transformed\ =\ np.dot(Matrix,\ points) }}
\DoxyCodeLine{02684\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(a\_transformed) }}
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Note\ homography\_lost[index]\ =\ (TransformationMatrix,\ Mask) }}
\DoxyCodeLine{02686\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Project\ points\ with\ stitched\ homographies }}
\DoxyCodeLine{02687\ \ \ \ \ \ \ \ \ \ \ \ \ projected\_points\ =\ cv2.perspectiveTransform(points,\ Matrix).T }
\DoxyCodeLine{02688\  }
\DoxyCodeLine{02689\  }
\DoxyCodeLine{02690\ \ \ \ \ \ \ \ \ \ \ \ \ new\_x\ =\ projected\_points[0][0] }
\DoxyCodeLine{02691\ \ \ \ \ \ \ \ \ \ \ \ \ new\_y\ =\ projected\_points[1][0] }
\DoxyCodeLine{02692\  }
\DoxyCodeLine{02693\ \ \ \ \ \ \ \ \ \ \ \ \ data[\textcolor{stringliteral}{'stitched\_x'}]\ =\ new\_x }
\DoxyCodeLine{02694\ \ \ \ \ \ \ \ \ \ \ \ \ data[\textcolor{stringliteral}{'stitched\_y'}]\ =\ new\_y }
\DoxyCodeLine{02695\  }
\DoxyCodeLine{02696\ \ \ \ \ \ \ \ \ \ \ \ \ print(data) }
\DoxyCodeLine{02697\  }
\DoxyCodeLine{02698\ \ \ \ \ \ \ \ \ \ \ \ \ dataframe\_list.append(data) }
\DoxyCodeLine{02699\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02700\  }
\DoxyCodeLine{02701\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dataframe\_list }
\DoxyCodeLine{02702\  }
\DoxyCodeLine{02703\  }

\end{DoxyCode}


References \mbox{\hyperlink{a00142_adcab0c33567748a21cfc4a90e663c1d6}{Camera\+Position.\+collect\+\_\+frames()}}, \mbox{\hyperlink{a00206_a048722841bc8d71bae4a1e4a9eb9db00}{room\+\_\+estimation.\+collect\+\_\+frames()}}, \mbox{\hyperlink{a00206_a444510358faa06884318d1ebe94846ff}{room\+\_\+estimation.\+load\+\_\+tracker()}}, and room\+\_\+estimation.\+undistort\+\_\+tracker\+\_\+data().

Here is the call graph for this function\+:
% FIG 29
\Hypertarget{a00206_abeac4cbae89aef891cee148cbbbc6232}\label{a00206_abeac4cbae89aef891cee148cbbbc6232} 
\index{room\_estimation@{room\_estimation}!superimpose\_checker@{superimpose\_checker}}
\index{superimpose\_checker@{superimpose\_checker}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{superimpose\_checker()}{superimpose\_checker()}}
{\footnotesize\ttfamily superimpose\+\_\+checker (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{size = {\ttfamily 21} }\end{DoxyParamCaption})}

\begin{DoxyVerb}This draws the grid from "define_perspective_grid" onto an image. 

This grid is given a "size" that is the number of lines present. 
This function utilizes draw_grid which is a 1080x1080 resolution image with cv2.lines drawn on it.

This grid image is then registered onto defined points from "define_perspective_grid" given the homograpy.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01529\ \ \ \ \ \textcolor{keyword}{def\ }superimpose\_checker(self,\ size=21): }
\DoxyCodeLine{01530\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01531\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ draws\ the\ grid\ from\ "{}define\_perspective\_grid"{}\ onto\ an\ image.\  }}
\DoxyCodeLine{01532\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01533\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ grid\ is\ given\ a\ "{}size"{}\ that\ is\ the\ number\ of\ lines\ present.\  }}
\DoxyCodeLine{01534\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ function\ utilizes\ draw\_grid\ which\ is\ a\ 1080x1080\ resolution\ image\ with\ cv2.lines\ drawn\ on\ it. }}
\DoxyCodeLine{01535\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01536\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ grid\ image\ is\ then\ registered\ onto\ defined\ points\ from\ "{}define\_perspective\_grid"{}\ given\ the\ homograpy. }}
\DoxyCodeLine{01537\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01539\ \ \ \ \ \ \ \ \ temp\ =\ deepcopy(self.image) }
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ grid\ =\ cv2.imread("{}K:/Github/PeopleTracker/Grid.jpg"{}) }}
\DoxyCodeLine{01541\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}\(\backslash\)n\ \(\backslash\)n\ Creating\ Grid..."{}}) }
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ corners\ =\ self.get\_room\_corners() }
\DoxyCodeLine{01543\  }
\DoxyCodeLine{01544\ \ \ \ \ \ \ \ \ grid\ =\ self.draw\_grid() }
\DoxyCodeLine{01545\ \ \ \ \ \ \ \ \ h,\ w,\ \_\ =\ grid.shape }
\DoxyCodeLine{01546\ \ \ \ \ \ \ \ \ src\ =\ np.array(((0,0),\ (w-\/1,0),\ (w-\/1,h-\/1),\ (0,h-\/1))) }
\DoxyCodeLine{01547\  }
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ h,\ status\ =\ cv2.findHomography(src,\ corners) }
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ self.clear\_corners() }
\DoxyCodeLine{01550\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}+/-\/\ to\ change\ grid,\ Q\ to\ quit."{}}) }
\DoxyCodeLine{01551\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}: }
\DoxyCodeLine{01552\ \ \ \ \ \ \ \ \ \ \ \ \ grid\ =\ self.draw\_grid(grid\_shape=(size,size)) }
\DoxyCodeLine{01553\ \ \ \ \ \ \ \ \ \ \ \ \ registered\ =\ cv2.warpPerspective(grid,\ h,\ (temp.shape[1],\ temp.shape[0])) }
\DoxyCodeLine{01554\ \ \ \ \ \ \ \ \ \ \ \ \ registered\ =\ cv2.addWeighted(temp,1,registered,0.3,0) }
\DoxyCodeLine{01555\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}Registered"{}},\ registered) }
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ \ \ \ \ k\ =\ cv2.waitKey(1) }
\DoxyCodeLine{01557\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ k\ ==\ ord(\textcolor{stringliteral}{"{}="{}}): }
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size\ +=\ 1 }
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ k\ ==\ ord(\textcolor{stringliteral}{'-\/'}): }
\DoxyCodeLine{01560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size\ -\/=\ 1 }
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ k\ ==\ ord(\textcolor{stringliteral}{'q'}): }
\DoxyCodeLine{01562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{01563\  }
\DoxyCodeLine{01564\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01565\  }
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ registered }
\DoxyCodeLine{01567\  }

\end{DoxyCode}


References room\+\_\+estimation.\+clear\+\_\+corners(), room\+\_\+estimation.\+draw\+\_\+grid(), \mbox{\hyperlink{a00206_a1cc866ee6a78b68a77485eb1eb0f00ba}{room\+\_\+estimation.\+get\+\_\+room\+\_\+corners()}}, App.\+image, room\+\_\+estimation.\+image, and person\+\_\+tab.\+image.

Here is the call graph for this function\+:
% FIG 30
\Hypertarget{a00206_abd979a29c40c64a598514d7d165bb4a9}\label{a00206_abd979a29c40c64a598514d7d165bb4a9} 
\index{room\_estimation@{room\_estimation}!undistort\_room@{undistort\_room}}
\index{undistort\_room@{undistort\_room}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{undistort\_room()}{undistort\_room()}}
{\footnotesize\ttfamily undistort\+\_\+room (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image = {\ttfamily None},  }\item[{}]{points\+\_\+data = {\ttfamily None},  }\item[{}]{camera\+\_\+matrix = {\ttfamily None},  }\item[{}]{distortion = {\ttfamily None},  }\item[{}]{show = {\ttfamily False},  }\item[{}]{fisheye = {\ttfamily False},  }\item[{}]{calibration\+\_\+resolution = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{01953\ \ \ \ \ \textcolor{keyword}{def\ }undistort\_room(self,\ image=None,\ points\_data=None,\ camera\_matrix=None,\ distortion=None,\ show=False,\ fisheye=False,\ calibration\_resolution=None): }
\DoxyCodeLine{01954\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01955\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01956\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ camera\_matrix\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{01957\ \ \ \ \ \ \ \ \ \ \ \ \ camera\_matrix\ =\ self.camera\_matrix }
\DoxyCodeLine{01958\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ distortion\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{01959\ \ \ \ \ \ \ \ \ \ \ \ \ distortion\ =\ self.distioriton\_matrix }
\DoxyCodeLine{01960\  }
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ image\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:\  }
\DoxyCodeLine{01962\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ self.image }
\DoxyCodeLine{01963\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01964\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ calibration\_resolution\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{01965\ \ \ \ \ \ \ \ \ \ \ \ \ calibration\_resolution\ =\ self.calibration\_resolution }
\DoxyCodeLine{01966\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01967\ \ \ \ \ \ \ \ \ width\ =\ image.shape[1] }
\DoxyCodeLine{01968\ \ \ \ \ \ \ \ \ height\ =\ image.shape[0] }
\DoxyCodeLine{01969\  }
\DoxyCodeLine{01970\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01971\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ fisheye: }
\DoxyCodeLine{01972\ \ \ \ \ \ \ \ \ \ \ \ \ img\_dim\ =\ image.shape[:2][::-\/1]\ \  }
\DoxyCodeLine{01973\ \ \ \ \ \ \ \ \ \ \ \ \ scaled\_K\ =\ camera\_matrix\ *\ img\_dim[0]\ /\ width }
\DoxyCodeLine{01974\ \ \ \ \ \ \ \ \ \ \ \ \ scaled\_K[2][2]\ =\ 1.0\ \  }
\DoxyCodeLine{01975\  }
\DoxyCodeLine{01976\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01977\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ new\_K\ =\ cv2.fisheye.estimateNewCameraMatrixForUndistortRectify(scaled\_K,\ distortion, }}
\DoxyCodeLine{01978\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ img\_dim,\ np.eye(3),\ balance=0,\ fov\_scale=1) }}
\DoxyCodeLine{01979\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{01980\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ map1,\ map2\ =\ cv2.fisheye.initUndistortRectifyMap(scaled\_K,\ distortion,\ np.eye(3), }}
\DoxyCodeLine{01981\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_K,\ img\_dim,\ cv2.CV\_16SC2) }}
\DoxyCodeLine{01982\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ undistorted\_image\ =\ cv2.remap(image,\ map1,\ map2,\ interpolation=cv2.INTER\_LINEAR,\ borderMode=cv2.BORDER\_CONSTANT) }}
\DoxyCodeLine{01983\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{01984\  }
\DoxyCodeLine{01985\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{01986\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \#\ New\ Camera\ matrix\ is\  }}
\DoxyCodeLine{01987\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ newcameramatrix\ =\ cv2.fisheye.estimateNewCameraMatrixForUndistortRectify(camera\_matrix,\ distortion,\ img\_dim,\ np.eye(3),\ balance=0,\ fov\_scale=1) }}
\DoxyCodeLine{01988\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ undistorted\_image\ =\ cv2.fisheye.undistortImage(image,\ camera\_matrix,\ distortion,\ None,\ newcameramatrix)\ \ \ \ \ \ \ \ \  }}
\DoxyCodeLine{01989\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ '''}\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{01990\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ''' }}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ \ \ \ \ map1,\ map2\ =\ cv2.fisheye.initUndistortRectifyMap(camera\_matrix,\ distortion,\ np.eye(3),\ camera\_matrix,\ (width,height),\ cv2.CV\_16SC2) }
\DoxyCodeLine{01992\ \ \ \ \ \ \ \ \ \ \ \ \ undistorted\_image\ =\ cv2.remap(image,\ map1,\ map2,\ interpolation=cv2.INTER\_LINEAR,\ borderMode=cv2.BORDER\_CONSTANT) }
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ''' }}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{01995\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.image.shape[1] }}
\DoxyCodeLine{01996\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ h1,\ w1,\ \_\ =\ image.shape }}
\DoxyCodeLine{01997\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \#Account\ for\ resolution\ differences\ between\ calibration\ and\ image\ input }}
\DoxyCodeLine{01998\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ w\_ratio,\ h\_ratio\ =\ self.get\_calibration\_ratio((w1,h1),\ calibration\_resolution) }}
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(w\_ratio,\ h\_ratio) }}
\DoxyCodeLine{02000\  }
\DoxyCodeLine{02001\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ camera\_matrix[0][0]\ =\ camera\_matrix[0][0]\ *\ w\_ratio }}
\DoxyCodeLine{02002\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ camera\_matrix[1][1]\ =\ camera\_matrix[1][1]\ *\ h\_ratio }}
\DoxyCodeLine{02003\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ camera\_matrix[0][2]\ =\ camera\_matrix[0][2]\ *\ w\_ratio }}
\DoxyCodeLine{02004\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ camera\_matrix[1][2]\ =\ camera\_matrix[1][2]\ *\ h\_ratio }}
\DoxyCodeLine{02005\  }
\DoxyCodeLine{02006\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ index,\ d\ in\ enumerate(distortion[0]): }}
\DoxyCodeLine{02007\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ distortion[0][index]\ =\ [0][index]\ *\ w\_ratio }}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02009\ \ \ \ \ \ \ \ \ \ \ \ \ newcameramatrix,\ \_\ =\ cv2.getOptimalNewCameraMatrix(camera\_matrix,\ distortion,\ (width,\ height),\ 1,\ (width,\ height)) }
\DoxyCodeLine{02010\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ points\_data\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{02011\  }
\DoxyCodeLine{02012\  }
\DoxyCodeLine{02013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#NOTE\ Solution\ to\ this\ being\ wrong,\ we\ should\ just\ calibrate\ the\ camera\ in\ the\ same\ resolution\ as\ our\ videos }}
\DoxyCodeLine{02014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ data[\textcolor{stringliteral}{'Pixel\_Loc\_x'}].to\_numpy() }
\DoxyCodeLine{02015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ data[\textcolor{stringliteral}{'Pixel\_Loc\_y'}].to\_numpy() }
\DoxyCodeLine{02016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ points\ =\ np.vstack((y,\ x)).T }
\DoxyCodeLine{02017\  }
\DoxyCodeLine{02018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ d2\ =\ distortion }}
\DoxyCodeLine{02019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ index,\ d\ in\ enumerate(distortion[0]): }}
\DoxyCodeLine{02020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ d2\ =\ distortion[0]\ *\ w\_ratio }}
\DoxyCodeLine{02021\  }
\DoxyCodeLine{02022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pts\_r\_norm\ =\ cv2.undistortPoints(points,\ camera\_matrix,\ distortion,\ \textcolor{keywordtype}{None},\ newcameramatrix) }
\DoxyCodeLine{02023\  }
\DoxyCodeLine{02024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_x\ =\ pts\_r\_norm.T[1] }
\DoxyCodeLine{02025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_y\ =\ pts\_r\_norm.T[0] }
\DoxyCodeLine{02026\  }
\DoxyCodeLine{02027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data[\textcolor{stringliteral}{'undistorted\_x'}]\ =\ new\_x[0].tolist() }
\DoxyCodeLine{02028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data[\textcolor{stringliteral}{'undistorted\_y'}]\ =\ new\_y[0].tolist() }
\DoxyCodeLine{02029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.points\_data\ =\ data }
\DoxyCodeLine{02030\ \ \ \ \ \ \ \ \ \ \ \ \ undistorted\_image\ =\ cv2.undistort(image,\ camera\_matrix,\ distortion,\ \textcolor{keywordtype}{None},\ newcameramatrix) }
\DoxyCodeLine{02031\  }
\DoxyCodeLine{02032\  }
\DoxyCodeLine{02033\  }
\DoxyCodeLine{02034\  }
\DoxyCodeLine{02035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ show: }}
\DoxyCodeLine{02036\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.imshow("{}undistorted"{},\ undistorted\_image) }}
\DoxyCodeLine{02037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.waitKey(0) }}
\DoxyCodeLine{02038\  }
\DoxyCodeLine{02039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ show: }
\DoxyCodeLine{02040\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.imshow(\textcolor{stringliteral}{"{}undistorted"{}},\ undistorted\_image) }
\DoxyCodeLine{02041\ \ \ \ \ \ \ \ \ \ \ \ \ cv2.waitKey(0) }
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ undistorted\_image }
\DoxyCodeLine{02043\  }

\end{DoxyCode}


References room\+\_\+estimation.\+calibration\+\_\+resolution, room\+\_\+estimation.\+camera\+\_\+matrix, room\+\_\+estimation.\+distioriton\+\_\+matrix, App.\+image, room\+\_\+estimation.\+image, person\+\_\+tab.\+image, and room\+\_\+estimation.\+points\+\_\+data.



Referenced by \mbox{\hyperlink{a00206_a2a5df656a4b4d07c05b290f8197c316f}{room\+\_\+estimation.\+save\+\_\+room()}}, and \mbox{\hyperlink{a00206_adbe2f98b84513775c3106191f2845ed3}{room\+\_\+estimation.\+stitch\+\_\+rooms()}}.

Here is the caller graph for this function\+:
% FIG 31
\Hypertarget{a00206_a66fa5cbb4e0e7ce0bfa08b4b5e14482f}\label{a00206_a66fa5cbb4e0e7ce0bfa08b4b5e14482f} 
\index{room\_estimation@{room\_estimation}!undistort\_tracker\_data@{undistort\_tracker\_data}}
\index{undistort\_tracker\_data@{undistort\_tracker\_data}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{undistort\_tracker\_data()}{undistort\_tracker\_data()}}
{\footnotesize\ttfamily undistort\+\_\+tracker\+\_\+data (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{data,  }\item[{}]{image = {\ttfamily None},  }\item[{}]{camera\+\_\+matrix = {\ttfamily None},  }\item[{}]{distortion = {\ttfamily None} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02044\ \ \ \ \ \textcolor{keyword}{def\ }undistort\_tracker\_data(self,data,\ image=None,\ camera\_matrix=None,\ distortion=None): }
\DoxyCodeLine{02045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ camera\_matrix\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{02046\ \ \ \ \ \ \ \ \ \ \ \ \ camera\_matrix\ =\ self.camera\_matrix }
\DoxyCodeLine{02047\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ distortion\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{02048\ \ \ \ \ \ \ \ \ \ \ \ \ distortion\ =\ self.distioriton\_matrix }
\DoxyCodeLine{02049\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ image\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{02051\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ self.image }
\DoxyCodeLine{02052\  }
\DoxyCodeLine{02053\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#Image\ dimensions }}
\DoxyCodeLine{02054\ \ \ \ \ \ \ \ \ width\ =\ image.shape[1] }
\DoxyCodeLine{02055\ \ \ \ \ \ \ \ \ height\ =\ image.shape[0] }
\DoxyCodeLine{02056\  }
\DoxyCodeLine{02057\  }
\DoxyCodeLine{02058\ \ \ \ \ \ \ \ \ x\ =\ data[\textcolor{stringliteral}{'Pixel\_Loc\_x'}].to\_numpy() }
\DoxyCodeLine{02059\ \ \ \ \ \ \ \ \ y\ =\ data[\textcolor{stringliteral}{'Pixel\_Loc\_y'}].to\_numpy() }
\DoxyCodeLine{02060\  }
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ print((width,\ height),\ self.calibration\_resolution) }
\DoxyCodeLine{02062\  }
\DoxyCodeLine{02063\  }
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ points\ =\ np.vstack((y,\ x)).T }
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02066\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ h1,\ w1,\ \_\ =\ image.shape }}
\DoxyCodeLine{02067\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \#\ Account\ for\ resolution\ differences\ between\ calibration\ and\ image\ input }}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ w\_ratio,\ h\_ratio\ =\ self.get\_calibration\_ratio((w1,h1),\ self.calibration\_resolution) }}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(w\_ratio,\ h\_ratio) }}
\DoxyCodeLine{02070\  }
\DoxyCodeLine{02071\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ camera\_matrix[0][0]\ =\ camera\_matrix[0][0]\ *\ w\_ratio }}
\DoxyCodeLine{02072\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ camera\_matrix[1][1]\ =\ camera\_matrix[1][1]\ *\ h\_ratio }}
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ camera\_matrix[0][2]\ =\ camera\_matrix[0][2]\ *\ w\_ratio }}
\DoxyCodeLine{02074\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ camera\_matrix[1][2]\ =\ camera\_matrix[1][2]\ *\ h\_ratio }}
\DoxyCodeLine{02075\  }
\DoxyCodeLine{02076\ \ \ \ \ \ \ \ \ newcameramatrix,\ \_\ =\ cv2.getOptimalNewCameraMatrix(camera\_matrix,\ distortion,\ (width,\ height),\ 1,\ (width,\ height)) }
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ numpy\_points\ =\ np.reshape(np.asfarray(points),\ (len(points),2,1)) }}
\DoxyCodeLine{02078\  }
\DoxyCodeLine{02079\  }
\DoxyCodeLine{02080\  }
\DoxyCodeLine{02081\ \ \ \ \ \ \ \ \ pts\_r\_norm\ =\ cv2.undistortPoints(points,\ camera\_matrix,\ distortion,\ \textcolor{keywordtype}{None},\ newcameramatrix) }
\DoxyCodeLine{02082\  }
\DoxyCodeLine{02083\ \ \ \ \ \ \ \ \ new\_x\ =\ pts\_r\_norm.T[1] }
\DoxyCodeLine{02084\ \ \ \ \ \ \ \ \ new\_y\ =\ pts\_r\_norm.T[0] }
\DoxyCodeLine{02085\  }
\DoxyCodeLine{02086\  }
\DoxyCodeLine{02087\ \ \ \ \ \ \ \ \ data[\textcolor{stringliteral}{'undistorted\_x'}]\ =\ new\_x[0].tolist() }
\DoxyCodeLine{02088\ \ \ \ \ \ \ \ \ data[\textcolor{stringliteral}{'undistorted\_y'}]\ =\ new\_y[0].tolist() }
\DoxyCodeLine{02089\  }
\DoxyCodeLine{02090\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ i\ in\ range(new\_x.shape[0]): }}
\DoxyCodeLine{02091\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \#\ print('showing') }}
\DoxyCodeLine{02092\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ p\ =\ (int(new\_x[0][i]),int(new\_y[0][i])) }}
\DoxyCodeLine{02093\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ cv2.circle(self.show\_img,p,1,color=(0,255,255),\ thickness=4) }}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.imshow("{}Projected"{},\ self.show\_img) }}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cv2.waitKey(0) }}
\DoxyCodeLine{02096\  }
\DoxyCodeLine{02097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ data }
\DoxyCodeLine{02098\  }
\DoxyCodeLine{02099\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a75031a34aadd8c7847c479a17524e00e}{room\+\_\+estimation.\+stitch\+\_\+trackers()}}.

Here is the caller graph for this function\+:
% FIG 32
\Hypertarget{a00206_a0bd7f71bd75e917a01563ad8dce62565}\label{a00206_a0bd7f71bd75e917a01563ad8dce62565} 
\index{room\_estimation@{room\_estimation}!update\_tracker\_3D@{update\_tracker\_3D}}
\index{update\_tracker\_3D@{update\_tracker\_3D}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{update\_tracker\_3D()}{update\_tracker\_3D()}}
{\footnotesize\ttfamily update\+\_\+tracker\+\_\+3D (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{index,  }\item[{}]{df,  }\item[{}]{mapped\+\_\+min,  }\item[{}]{mapped\+\_\+max }\end{DoxyParamCaption})}

\begin{DoxyVerb}Updates the already created plot with new data
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02140\ \ \ \ \ \textcolor{keyword}{def\ }update\_tracker\_3D(self,index,\ df,\ mapped\_min,\ mapped\_max): }
\DoxyCodeLine{02141\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{02142\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Updates\ the\ already\ created\ plot\ with\ new\ data }}
\DoxyCodeLine{02143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{02144\  }

\end{DoxyCode}
\Hypertarget{a00206_a6c6c06bc8bbf8a0f9f7237a97ff9487e}\label{a00206_a6c6c06bc8bbf8a0f9f7237a97ff9487e} 
\index{room\_estimation@{room\_estimation}!visualize\_distortion@{visualize\_distortion}}
\index{visualize\_distortion@{visualize\_distortion}!room\_estimation@{room\_estimation}}
\doxysubsubsection{\texorpdfstring{visualize\_distortion()}{visualize\_distortion()}}
{\footnotesize\ttfamily visualize\+\_\+distortion (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{camera\+\_\+matrix,  }\item[{}]{distiortion,  }\item[{}]{image = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}https://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#void%20projectPoints(InputArray%20objectPoints,%20InputArray%20rvec,%20InputArray%20tvec,%20InputArray%20cameraMatrix,%20InputArray%20distCoeffs,%20OutputArray%20imagePoints,%20OutputArray%20jacobian,%20double%20aspectRatio)

opencv 3 here: 
https://docs.opencv.org/4.x/dc/dbb/tutorial_py_calibration.html

[x] =  [X]
[y] = R[Y] + t
[z] =  [Z]

x' = x/z
y' = y/z

NOTE: k1-6 are radial distortion coefficients, p1 and p2 are tangential distortion
        if any 

x'' = x' (1 + k1 * r^2+k2 + k3*r^4 + k3*r^6)/ + 2*p1*x'*y' + p2(r^2 + (2x')^2)
         (1 + k4 * r^2+k5 + k3*r^4 + k6*r^6)

y'' = y' (1 + k1 * r^2+k2 + k3*r^4 + k3*r^6)/ + p1(r^2 + (2y')^2) + 2*p2 * x' * y'
         (1 + k4 * r^2+k5 + k3*r^4 + k6*r^6)

r^2 = x'^2 + y'^2
u = fx * x'' + cx
v = fy * y'' + cy
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{02327\ \ \ \ \ \textcolor{keyword}{def\ }visualize\_distortion(self,\ camera\_matrix,\ distiortion,\ image=None): }
\DoxyCodeLine{02328\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{''' }}
\DoxyCodeLine{02329\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ https://docs.opencv.org/2.4/modules/calib3d/doc/camera\_calibration\_and\_3d\_reconstruction.html\#void\%20projectPoints(InputArray\%20objectPoints,\%20InputArray\%20rvec,\%20InputArray\%20tvec,\%20InputArray\%20cameraMatrix,\%20InputArray\%20distCoeffs,\%20OutputArray\%20imagePoints,\%20OutputArray\%20jacobian,\%20double\%20aspectRatio) }}
\DoxyCodeLine{02330\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02331\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ opencv\ 3\ here:\  }}
\DoxyCodeLine{02332\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ https://docs.opencv.org/4.x/dc/dbb/tutorial\_py\_calibration.html }}
\DoxyCodeLine{02333\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02334\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [x]\ =\ \ [X] }}
\DoxyCodeLine{02335\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [y]\ =\ R[Y]\ +\ t }}
\DoxyCodeLine{02336\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [z]\ =\ \ [Z] }}
\DoxyCodeLine{02337\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02338\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x'\ =\ x/z }}
\DoxyCodeLine{02339\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ y'\ =\ y/z }}
\DoxyCodeLine{02340\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02341\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ NOTE:\ k1-\/6\ are\ radial\ distortion\ coefficients,\ p1\ and\ p2\ are\ tangential\ distortion }}
\DoxyCodeLine{02342\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ any\  }}
\DoxyCodeLine{02343\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02344\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x''\ =\ x'\ (1\ +\ k1\ *\ r\string^2+k2\ +\ k3*r\string^4\ +\ k3*r\string^6)/\ +\ 2*p1*x'*y'\ +\ p2(r\string^2\ +\ (2x')\string^2) }}
\DoxyCodeLine{02345\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1\ +\ k4\ *\ r\string^2+k5\ +\ k3*r\string^4\ +\ k6*r\string^6) }}
\DoxyCodeLine{02346\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02347\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ y''\ =\ y'\ (1\ +\ k1\ *\ r\string^2+k2\ +\ k3*r\string^4\ +\ k3*r\string^6)/\ +\ p1(r\string^2\ +\ (2y')\string^2)\ +\ 2*p2\ *\ x'\ *\ y' }}
\DoxyCodeLine{02348\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1\ +\ k4\ *\ r\string^2+k5\ +\ k3*r\string^4\ +\ k6*r\string^6) }}
\DoxyCodeLine{02349\ \textcolor{stringliteral}{ }}
\DoxyCodeLine{02350\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ r\string^2\ =\ x'\string^2\ +\ y'\string^2 }}
\DoxyCodeLine{02351\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ u\ =\ fx\ *\ x''\ +\ cx }}
\DoxyCodeLine{02352\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ v\ =\ fy\ *\ y''\ +\ cy }}
\DoxyCodeLine{02353\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''} }
\DoxyCodeLine{02354\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ image\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{02355\ \ \ \ \ \ \ \ \ \ \ \ \ image\ =\ self.image }
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ height,\ width,\ \_\ =\ image.shape }
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ nstep\ =\ 20 }
\DoxyCodeLine{02359\ \ \ \ \ \ \ \ \ d\ =\ list(distiortion[0]) }
\DoxyCodeLine{02360\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(d) }}
\DoxyCodeLine{02361\ \ \ \ \ \ \ \ \ k1,\ k2,\ p1,\ p2,\ k3,\ k4,\ k5,\ k6,\ s1,\ s2,\ s3,\ s4,\ taux,\ tauy\ =\ list(distiortion[0]) }
\DoxyCodeLine{02362\ \ \ \ \ \ \ \ \ fx\ =\ camera\_matrix[0,0] }
\DoxyCodeLine{02363\ \ \ \ \ \ \ \ \ fy\ =\ camera\_matrix[1,1] }
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ cx\ =\ camera\_matrix[0,2] }
\DoxyCodeLine{02365\ \ \ \ \ \ \ \ \ cy\ =\ camera\_matrix[1,2] }
\DoxyCodeLine{02366\  }
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Create\ a\ grid\ from\ the\ size\ of\ the\ image }}
\DoxyCodeLine{02368\ \ \ \ \ \ \ \ \ uv\ =\ np.meshgrid(np.linspace(-\/width,width-\/1,nstep),\ np.linspace(-\/height,height-\/1,nstep)) }
\DoxyCodeLine{02369\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(uv) }}
\DoxyCodeLine{02370\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ NOTE:\ p\ stands\ for\ prime\ (') }}
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ u\ =\ uv[0] }
\DoxyCodeLine{02372\ \ \ \ \ \ \ \ \ v\ =\ uv[1] }
\DoxyCodeLine{02373\ \ \ \ \ \ \ \ \ z\ =\ np.ones(u.shape) }
\DoxyCodeLine{02374\ \ \ \ \ \ \ \ \ xp\ =\ u\ /\ z\ \textcolor{comment}{\#\ z=1 }}
\DoxyCodeLine{02375\ \ \ \ \ \ \ \ \ yp\ =\ v\ /\ z\ \textcolor{comment}{\#\ z=1 }}
\DoxyCodeLine{02376\  }
\DoxyCodeLine{02377\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(xp,\ yp) }}
\DoxyCodeLine{02378\  }
\DoxyCodeLine{02379\ \ \ \ \ \ \ \ \ r2\ =\ xp\ **\ 2\ +\ yp\ **\ 2 }
\DoxyCodeLine{02380\ \ \ \ \ \ \ \ \ r4\ =\ r2\ **\ 2\  }
\DoxyCodeLine{02381\ \ \ \ \ \ \ \ \ r6\ =\ r2\ **\ 3 }
\DoxyCodeLine{02382\ \ \ \ \ \ \ \ \ coef\ =\ (1\ +\ k1*r2\ +\ k2*r4\ +\ k3*r6)/(1\ +\ k4*r2\ +\ k5*r4\ +\ k6*r6) }
\DoxyCodeLine{02383\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{02384\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(coef) }}
\DoxyCodeLine{02385\  }
\DoxyCodeLine{02386\ \ \ \ \ \ \ \ \ xpp\ =\ xp\ *\ coef\ +\ 2*p1*(xp*yp)\ +\ p2*(r2\ +\ 2*xp**2)\ +\ s1*r2\ +\ s2*r4 }
\DoxyCodeLine{02387\ \ \ \ \ \ \ \ \ ypp\ =\ yp\ *\ coef\ +\ p1*(r2\ +\ 2*yp**2)\ +\ 2\ *\ p2\ *\ (xp\ *\ yp)\ +\ s1*r2\ +\ s2*r4 }
\DoxyCodeLine{02388\  }
\DoxyCodeLine{02389\ \ \ \ \ \ \ \ \ x\_radial\_distortion\ =\ xp\ *\ (1\ +\ k1*r2\ +\ k2*r4\ +\ k3*r6)\ \textcolor{comment}{\#\ xp }}
\DoxyCodeLine{02390\ \ \ \ \ \ \ \ \ y\_radial\_distortion\ =\ yp\ *\ (1\ +\ k1*r2\ +\ k2*r4\ +\ k3*r6)\ \textcolor{comment}{\#\ yp }}
\DoxyCodeLine{02391\  }
\DoxyCodeLine{02392\ \ \ \ \ \ \ \ \ x\_tangential\_distortion\ =\ xp\ +\ (2*p1*xp*yp\ +p2*(r2\ +\ 2*xp**2))\ \textcolor{comment}{\#\ xpp }}
\DoxyCodeLine{02393\ \ \ \ \ \ \ \ \ y\_tangential\_distortion\ =\ yp\ +\ (p1*(r2\ +\ 2*yp**2)\ +\ 2\ *\ p2\ *\ xp\ *\ yp)\ \textcolor{comment}{\#\ ypp }}
\DoxyCodeLine{02394\  }
\DoxyCodeLine{02395\  }
\DoxyCodeLine{02396\ \ \ \ \ \ \ \ \ u2\ =\ fx\ *\ xpp\ +\ cx }
\DoxyCodeLine{02397\ \ \ \ \ \ \ \ \ v2\ =\ fy\ *\ ypp\ +\ cy }
\DoxyCodeLine{02398\  }
\DoxyCodeLine{02399\ \ \ \ \ \ \ \ \ difference\_u\ =\ u2[:]\ -\/\ u[:] }
\DoxyCodeLine{02400\ \ \ \ \ \ \ \ \ difference\_v\ =\ v2[:]\ -\/\ v[:] }
\DoxyCodeLine{02401\  }
\DoxyCodeLine{02402\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ du,\ dv\ =\ np.meshgrid(difference\_u,\ difference\_v) }}
\DoxyCodeLine{02403\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ dr\ =\ np.reshape(np.hypot(difference\_u,difference\_v),\ xp.shape) }}
\DoxyCodeLine{02404\ \ \ \ \ \ \ \ \ dr\ =\ np.reshape(np.hypot(difference\_u,difference\_v),\ u.shape) }
\DoxyCodeLine{02405\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(dr) }}
\DoxyCodeLine{02406\ \ \ \ \ \ \ \ \ center\ =\ (width/2,\ height/2) }
\DoxyCodeLine{02407\ \ \ \ \ \ \ \ \ principal\_point\ =\ (cx,\ cy) }
\DoxyCodeLine{02408\  }
\DoxyCodeLine{02409\ \ \ \ \ \ \ \ \ fix,\ ax\ =\ plt.subplots() }
\DoxyCodeLine{02410\ \ \ \ \ \ \ \ \ ax.scatter(center[0],\ center[1],\ marker=\textcolor{stringliteral}{"{}o"{}}) }
\DoxyCodeLine{02411\ \ \ \ \ \ \ \ \ ax.scatter(principal\_point[0],\ principal\_point[1],\ marker=\textcolor{stringliteral}{"{}X"{}}) }
\DoxyCodeLine{02412\ \ \ \ \ \ \ \ \ CS\ =\ ax.contour(u[1,:]+1,\ v[:,1]+1,\ dr) }
\DoxyCodeLine{02413\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ax.quiver(u[:]+1,\ v[:]+1,\ du,\ dv) }}
\DoxyCodeLine{02414\ \ \ \ \ \ \ \ \ ax.clabel(CS,\ fontsize=9,\ inline=\textcolor{keyword}{True}) }
\DoxyCodeLine{02415\ \ \ \ \ \ \ \ \ plt.show() }
\DoxyCodeLine{02416\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ dr\ =\ reshape(hypot(du,dv),\ size(u)); }}
\DoxyCodeLine{02417\  }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{a00206_a2a5df656a4b4d07c05b290f8197c316f}{room\+\_\+estimation.\+save\+\_\+room()}}.

Here is the caller graph for this function\+:
% FIG 33


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
K\+:/\+Github/\+People\+Tracker/src/room\+\_\+estimation.\+py\end{DoxyCompactItemize}
